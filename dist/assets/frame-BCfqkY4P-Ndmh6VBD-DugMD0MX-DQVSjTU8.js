import{L as _,w as W,t as ye,E as V,Y as e,J as t,s as l,z as H,D as M,V as xe,r as be,a as i,b as C,d,F as ke,M as s,R as Ve,B as Ce,$ as J,e as Y,T as B,p as Ae,f as De,H as F,c as $e,Q as ze,n as T,x as Z,W as Ie,K as Te,k as G,g as Ue,h as Le,i as Ee,j as x,l as Oe,m as Se,O as We,o as Be,q as Fe,U as Re,u as je,v as qe,y as Ke,A as Ne,C as A,G as R}from"./index-Csie3Ubd.js";import{h as j}from"./http-C-_XONwZ-BI6Pfl8z-m3MqG1D0-qGmbdpo1.js";import{s as Pe}from"./_plugin-vue_export-helper-DlAUqK2U-lGy7RumW-DNI5evPq-9uN0dvLo.js";import"./axios-DWwaMX5J-DXTQ3iZI-BeByrt0G-Daa4mr-n.js";const Qe=(w,f)=>j.post("/auth/login",{email:w,password:f}),He=(w,f,c)=>j.post("/auth/resetpwd",{oldpwd:w,pwd1:f,pwd2:c}),Me={login:Qe,resetPwd:He},Je=w=>j.post("/chat/",{message:w}),X={chatWithAI:Je},Ye={class:"left-header"},Ze={class:"right-header"},Ge={class:"el-dropdown-link"},Xe={style:{"margin-left":"10px"}},ea={class:"dialog-footer"},aa={class:"chat-container"},ta={class:"chat-sidebar"},la={class:"sidebar-menu"},na={class:"chat-main"},sa={key:0,class:"message user-message"},ua={class:"message-content"},da={class:"message-text"},ia={class:"message-time"},oa={class:"message-avatar"},ra={key:1,class:"message ai-message"},ma={class:"message-avatar"},ca={class:"message-content"},pa={class:"message-text"},_a={class:"message-time"},fa={class:"chat-input-area"},ga={class:"input-container"},va={class:"input-actions"},wa=xe({name:"frame"}),ha=Object.assign(wa,{setup(w){let f="140px",c=_(!1),m=W({oldpwd:"",pwd1:"",pwd2:""}),q=_(),ee=W({oldpwd:[{required:!0,message:"旧密码",trigger:"blur"},{min:6,max:20,message:"Length should be 6 to 20",trigger:"blur"}],pwd1:[{required:!0,message:"新密码",trigger:"blur"},{min:6,max:20,message:"Length should be 6 to 20",trigger:"blur"}],pwd2:[{required:!0,message:"确认密码",trigger:"blur"},{min:6,max:20,message:"Length should be 6 to 20",trigger:"blur"}]});const U=ye(),ae=be(),D=_(!1),g=_(""),$=_(!1),z=_(null),te=_(""),v=W([{type:"ai",content:"您好！我是AI智能助手，有什么可以帮助您的吗？",timestamp:new Date}]),le=()=>{D.value=!0,A(()=>{b()})},ne=()=>{D.value=!1,g.value=""},K=async()=>{if(!g.value.trim()||$.value)return;const r=g.value.trim();v.push({type:"user",content:r,timestamp:new Date}),g.value="",$.value=!0,await A(),b();try{const a=await X.chatWithAI(r);v.push({type:"ai",content:a.reply,timestamp:new Date})}catch(a){console.error("AI接口调用失败:",a),v.push({type:"ai",content:"抱歉，AI服务暂时不可用，请稍后再试。",timestamp:new Date})}finally{$.value=!1,A(()=>{b()})}},b=()=>{z.value&&(z.value.scrollTop=z.value.scrollHeight)},N=r=>{const a=new Date(r),p=new Date,n=p-a;return n<6e4?"刚刚":n<36e5?`${Math.floor(n/6e4)}分钟前`:a.toDateString()===p.toDateString()?a.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}):a.toLocaleDateString("zh-CN")+" "+a.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"})},h=async r=>{const a={policy:"政策库",enterprise:"企业库",regulation:"法规库",standard:"标准库",case:"案例库",help:"帮助中心"}[r]||"未知功能",p=`我想查看${a}`;v.push({type:"user",content:p,timestamp:new Date}),A(()=>{b()});try{const n=await X.chatWithAI(p);v.push({type:"ai",content:n.reply,timestamp:new Date})}catch(n){console.error("AI接口调用失败:",n),v.push({type:"ai",content:`好的，我来为您打开${a}。这里是${a}的相关信息，您可以根据需要进行查询和浏览。`,timestamp:new Date})}A(()=>{b()})},se=()=>{U.clearUserToken(),ae.push({name:"login"})},ue=()=>{m.oldpwd="",m.pwd1="",m.pwd2="",c.value=!0},de=()=>{q.value.validate(async(r,a)=>{if(r)try{await Me.resetPwd(m.oldpwd,m.pwd1,m.pwd2),R.success("密码修改成功"),c.value=!1}catch(p){R.error(p)}else R.info("字段校验失败!"),console.log("字段校验失败!");console.log(a)}),c.value=!1},ie=(r,a)=>{console.log(r,a)},oe=(r,a)=>{console.log(r,a)},L=_(!1),re=()=>{L.value=!L.value};return(r,a)=>{const p=i("router-link"),n=i("el-icon"),o=i("el-menu-item"),k=i("el-sub-menu"),me=i("el-menu"),ce=i("el-aside"),y=i("el-button"),E=i("el-avatar"),O=i("el-dropdown-item"),pe=i("el-dropdown-menu"),_e=i("el-dropdown"),fe=i("el-header"),ge=i("RouterView"),ve=i("el-main"),P=i("el-container"),I=i("el-input"),S=i("el-form-item"),we=i("el-form"),Q=i("el-dialog");return C(),V(M,null,[e(P,{class:"container"},{default:t(()=>[e(ce,{class:"aside",width:"250px"},{default:t(()=>[e(p,{to:"/",class:"brand"},{default:t(()=>a[13]||(a[13]=[d("益客管理系统")])),_:1,__:[13]}),e(me,{router:!0,"default-active":r.$route.name,class:"el-menu-vertical-demo",onOpen:ie,onClose:oe},{default:t(()=>[e(o,{index:"home",route:{name:"home"}},{title:t(()=>[e(n,null,{default:t(()=>[e(l(ke))]),_:1}),a[14]||(a[14]=s("span",null,"首页",-1))]),_:1}),e(k,{index:"2"},{title:t(()=>[e(n,null,{default:t(()=>[e(l(Ve))]),_:1}),a[15]||(a[15]=s("span",null,"考勤管理",-1))]),default:t(()=>[e(o,{index:"myabsent",route:{name:"myabsent"}},{default:t(()=>[e(n,null,{default:t(()=>[e(l(Ce))]),_:1}),a[16]||(a[16]=d("个人管理"))]),_:1,__:[16]}),e(o,{index:"subabsent",route:{name:"subabsent"}},{default:t(()=>[e(n,null,{default:t(()=>[e(l(J))]),_:1}),a[17]||(a[17]=d("下属考勤"))]),_:1,__:[17]}),e(o,{index:"expense-rd",route:{name:"expense-rd"}},{default:t(()=>[e(n,null,{default:t(()=>[e(l(Y))]),_:1}),a[18]||(a[18]=d("研发费用管理"))]),_:1,__:[18]})]),_:1}),e(k,{index:"3"},{title:t(()=>[e(n,null,{default:t(()=>[e(l(B))]),_:1}),a[19]||(a[19]=s("span",null,"通知管理",-1))]),default:t(()=>[e(o,{index:"notification",route:{name:"notification"}},{default:t(()=>[e(n,null,{default:t(()=>[e(l(Ae))]),_:1}),a[20]||(a[20]=d("发布通的知"))]),_:1,__:[20]}),e(o,{index:"video-monitor",route:{name:"video-monitor"}},{default:t(()=>[e(n,null,{default:t(()=>[e(l(De))]),_:1}),a[21]||(a[21]=d("通知列的表"))]),_:1,__:[21]}),e(o,{index:"expense-rd2",route:{name:"expense-rd2"}},{default:t(()=>[e(n,null,{default:t(()=>[e(l(Y))]),_:1}),a[22]||(a[22]=d("研发费用管理2"))]),_:1,__:[22]})]),_:1}),e(k,{index:"5"},{title:t(()=>[e(n,null,{default:t(()=>[e(l(F))]),_:1}),a[23]||(a[23]=s("span",null,"员工管理",-1))]),default:t(()=>[e(o,{index:"exam",route:{name:"exam"}},{default:t(()=>[e(n,null,{default:t(()=>[e(l($e))]),_:1}),a[24]||(a[24]=d("员工通的知"))]),_:1,__:[24]}),e(o,{index:"employee",route:{name:"employee"}},{default:t(()=>[e(n,null,{default:t(()=>[e(l(ze))]),_:1}),a[25]||(a[25]=d("员工列的表"))]),_:1,__:[25]}),e(o,{index:"filemanage",route:{name:"filemanage"}},{default:t(()=>[e(n,null,{default:t(()=>[e(l(B))]),_:1}),a[26]||(a[26]=d("员工管的理"))]),_:1,__:[26]})]),_:1}),e(k,{index:"6"},{title:t(()=>[e(n,null,{default:t(()=>[e(l(F))]),_:1}),a[27]||(a[27]=s("span",null,"智慧农业",-1))]),default:t(()=>[e(o,{index:"agriculture",route:{name:"agriculture"}},{default:t(()=>[e(n,null,{default:t(()=>[e(l(T))]),_:1}),a[28]||(a[28]=d("农业管理"))]),_:1,__:[28]}),e(o,{index:"building",route:{name:"building"}},{default:t(()=>[e(n,null,{default:t(()=>[e(l(T))]),_:1}),a[29]||(a[29]=d("建筑管理"))]),_:1,__:[29]}),e(o,{index:"language",route:{name:"language"}},{default:t(()=>[e(n,null,{default:t(()=>[e(l(T))]),_:1}),a[30]||(a[30]=d("语言管理"))]),_:1,__:[30]}),e(o,{index:"district",route:{name:"district"}},{default:t(()=>[e(n,null,{default:t(()=>[e(l(Z))]),_:1}),a[31]||(a[31]=d("区县管理"))]),_:1,__:[31]}),e(o,{index:"traffic",route:{name:"traffic"}},{default:t(()=>[e(n,null,{default:t(()=>[e(l(Z))]),_:1}),a[32]||(a[32]=d("交通管理"))]),_:1,__:[32]})]),_:1}),e(k,{index:"16"},{title:t(()=>[e(n,null,{default:t(()=>[e(l(F))]),_:1}),a[33]||(a[33]=s("span",null,"智慧工信",-1))]),default:t(()=>[e(o,{index:"industry",route:{name:"industry"}},{default:t(()=>[e(n,null,{default:t(()=>[e(l(T))]),_:1}),a[34]||(a[34]=d("工信管理"))]),_:1,__:[34]}),e(o,{index:"education",route:{name:"education"}},{default:t(()=>[e(n,null,{default:t(()=>[e(l(Ie))]),_:1}),a[35]||(a[35]=d("教育管理"))]),_:1,__:[35]}),e(o,{index:"enterprise",route:{name:"enterprise"}},{default:t(()=>[e(n,null,{default:t(()=>[e(l(Te))]),_:1}),a[36]||(a[36]=d("企业管理"))]),_:1,__:[36]})]),_:1})]),_:1},8,["default-active"])]),_:1}),e(P,null,{default:t(()=>[e(fe,{class:"header"},{default:t(()=>[s("div",Ye,[e(y,null,{default:t(()=>[e(n,null,{default:t(()=>[e(l(G))]),_:1})]),_:1})]),Ue(e(y,{icon:l(G),onClick:re},null,8,["icon"]),[[Le,L.value]]),s("div",Ze,[e(y,{class:"ai-button",type:"primary",size:"small",onClick:le,style:{"margin-right":"15px"}},{default:t(()=>[e(n,null,{default:t(()=>[e(l(Ee))]),_:1}),a[37]||(a[37]=d(" AI助手 "))]),_:1,__:[37]}),e(_e,null,{dropdown:t(()=>[e(pe,null,{default:t(()=>[e(O,{onClick:ue},{default:t(()=>a[38]||(a[38]=[d("修改密码")])),_:1,__:[38]}),e(O,null,{default:t(()=>a[39]||(a[39]=[d("个人中心")])),_:1,__:[39]}),e(O,{divided:"",onClick:se},{default:t(()=>a[40]||(a[40]=[d("退出登录")])),_:1,__:[40]})]),_:1})]),default:t(()=>[s("span",Ge,[e(E,{size:30,icon:"UserFilled"}),s("span",Xe,"("+x(l(U).user.department.name)+")"+x(l(U).user.realname),1),e(n,{class:"el-icon--right"},{default:t(()=>[e(l(Oe))]),_:1})])]),_:1})])]),_:1}),e(ve,{class:"main"},{default:t(()=>[e(ge)]),_:1})]),_:1})]),_:1}),e(Q,{modelValue:l(c),"onUpdate:modelValue":a[4]||(a[4]=u=>H(c)?c.value=u:c=u),title:"修改密码",width:"500"},{footer:t(()=>[s("div",ea,[e(y,{onClick:a[3]||(a[3]=u=>H(c)?c.value=!1:c=!1)},{default:t(()=>a[41]||(a[41]=[d("取消")])),_:1,__:[41]}),e(y,{type:"primary",onClick:de},{default:t(()=>a[42]||(a[42]=[d(" 确认 ")])),_:1,__:[42]})])]),default:t(()=>[e(we,{model:l(m),rules:l(ee),ref_key:"formTag",ref:q},{default:t(()=>[e(S,{label:"旧密码","label-width":l(f),prop:"oldpwd"},{default:t(()=>[e(I,{modelValue:l(m).oldpwd,"onUpdate:modelValue":a[0]||(a[0]=u=>l(m).oldpwd=u),autocomplete:"off",type:"password"},null,8,["modelValue"])]),_:1},8,["label-width"]),e(S,{label:"新密码","label-width":l(f),prop:"pwd1"},{default:t(()=>[e(I,{modelValue:l(m).pwd1,"onUpdate:modelValue":a[1]||(a[1]=u=>l(m).pwd1=u),autocomplete:"off",type:"password"},null,8,["modelValue"])]),_:1},8,["label-width"]),e(S,{label:"确认密码","label-width":l(f),prop:"pwd2"},{default:t(()=>[e(I,{modelValue:l(m).pwd2,"onUpdate:modelValue":a[2]||(a[2]=u=>l(m).pwd2=u),autocomplete:"off",type:"password"},null,8,["modelValue"])]),_:1},8,["label-width"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),e(Q,{modelValue:D.value,"onUpdate:modelValue":a[12]||(a[12]=u=>D.value=u),title:"AI智能助手",width:"800px","before-close":ne,class:"ai-chat-dialog",draggable:""},{default:t(()=>[s("div",aa,[s("div",ta,[s("div",la,[s("div",{class:"menu-item",onClick:a[5]||(a[5]=u=>h("policy"))},[e(n,null,{default:t(()=>[e(l(Se))]),_:1}),a[43]||(a[43]=s("span",null,"政策库",-1))]),s("div",{class:"menu-item",onClick:a[6]||(a[6]=u=>h("enterprise"))},[e(n,null,{default:t(()=>[e(l(We))]),_:1}),a[44]||(a[44]=s("span",null,"企业库",-1))]),s("div",{class:"menu-item",onClick:a[7]||(a[7]=u=>h("regulation"))},[e(n,null,{default:t(()=>[e(l(Be))]),_:1}),a[45]||(a[45]=s("span",null,"法规库",-1))]),s("div",{class:"menu-item",onClick:a[8]||(a[8]=u=>h("standard"))},[e(n,null,{default:t(()=>[e(l(Fe))]),_:1}),a[46]||(a[46]=s("span",null,"标准库",-1))]),s("div",{class:"menu-item",onClick:a[9]||(a[9]=u=>h("case"))},[e(n,null,{default:t(()=>[e(l(B))]),_:1}),a[47]||(a[47]=s("span",null,"案例库",-1))]),s("div",{class:"menu-item",onClick:a[10]||(a[10]=u=>h("help"))},[e(n,null,{default:t(()=>[e(l(Re))]),_:1}),a[48]||(a[48]=s("span",null,"帮助中心",-1))])])]),s("div",na,[s("div",{class:"chat-messages",ref_key:"messagesContainer",ref:z},[(C(!0),V(M,null,je(v,(u,he)=>(C(),V("div",{key:he,class:qe(["message-item",u.type])},[u.type==="user"?(C(),V("div",sa,[s("div",ua,[s("div",da,x(u.content),1),s("div",ia,x(N(u.timestamp)),1)]),s("div",oa,[e(E,{size:40,src:te.value},{default:t(()=>[e(n,null,{default:t(()=>[e(l(J))]),_:1})]),_:1},8,["src"])])])):(C(),V("div",ra,[s("div",ma,[e(E,{size:40,class:"ai-avatar"},{default:t(()=>[e(n,null,{default:t(()=>[e(l(Ke))]),_:1})]),_:1})]),s("div",ca,[s("div",pa,x(u.content),1),s("div",_a,x(N(u.timestamp)),1)])]))],2))),128))],512),s("div",fa,[s("div",ga,[e(I,{modelValue:g.value,"onUpdate:modelValue":a[11]||(a[11]=u=>g.value=u),type:"textarea",rows:3,placeholder:"请输入您的问题...",onKeydown:Ne(K,["enter"]),resize:"none"},null,8,["modelValue"]),s("div",va,[a[50]||(a[50]=s("span",{class:"input-tip"},"Enter 发送",-1)),e(y,{type:"primary",onClick:K,loading:$.value,disabled:!g.value.trim()},{default:t(()=>a[49]||(a[49]=[d(" 发送 ")])),_:1,__:[49]},8,["loading","disabled"])])])])])])]),_:1},8,["modelValue"])],64)}}}),Va=Pe(ha,[["__scopeId","data-v-35e213e1"]]);export{Va as default};
