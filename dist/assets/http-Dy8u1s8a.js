import{a as e}from"./axios-DjXdQO6G.js";import{u as s,R as t}from"./index-BOpLbFaH.js";import{ElMessage as a}from"element-plus";const r=new class{constructor(){this.instance=e.create({baseURL:"192.168.1.48/api",timeout:6e4}),this.instance.interceptors.request.use((e=>{const t=s().token;return t&&(e.headers.Authorization="JWT "+t),e})),this.instance.interceptors.response.use((e=>e),(e=>{var r;if(403===(null==(r=e.response)?void 0:r.status)){const e=s();a.error("登录已过期，请重新登录"),e.clearUserToken(),t.push("/login")}return Promise.reject(e)}))}post(e,s){return new Promise((async(t,a)=>{try{t((await this.instance.post(e,s)).data)}catch(r){a(r.response&&r.response.data&&r.response.data.detail?r.response.data.detail:r.message||"未知错误")}}))}get(e,s){return new Promise((async(t,a)=>{try{t((await this.instance.get(e,s)).data)}catch(r){a(r.response&&r.response.data&&r.response.data.detail?r.response.data.detail:r.message||"未知错误")}}))}};export{r as h};
