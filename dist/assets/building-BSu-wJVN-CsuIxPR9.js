import{d as e,S as a,r as l,m as t,Z as d,s as o,t as i,z as u,I as n,P as r,j as s,c as p,O as c,v as m,q as f,i as _,k as g,x as v,N as b,X as y,$ as h,b as w,U as V,Q as x}from"./index-BEF7uh_8.js";const C={class:"building-container"},k={class:"page-header"},U={class:"search-section"},S={class:"building-list"},z={class:"pagination-container"},D={class:"dialog-footer"},T={key:0,class:"building-detail"},B={class:"dialog-footer"},M={key:0,style:{"margin-top":"16px"}},O={key:1,style:{"margin-top":"24px"}},q=e({__name:"building",setup(e){const q=a(!1),I=a(!1),P=a(!1),j=a(!1),Z=a(),$=a(null),L=a(!1),N=l({start:"",end:""}),A=a(""),J=a([]),F=l({name:"",status:"",type:""}),R=l({currentPage:1,pageSize:10,total:0}),W=l({id:null,name:"",type:"",address:"",floors:1,area:0,status:"normal",buildDate:"",description:""}),E={name:[{required:!0,message:"请输入建筑名称",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"}],type:[{required:!0,message:"请选择建筑类型",trigger:"change"}],address:[{required:!0,message:"请输入建筑地址",trigger:"blur"}],floors:[{required:!0,message:"请输入楼层数",trigger:"blur"}],area:[{required:!0,message:"请输入建筑面积",trigger:"blur"}],status:[{required:!0,message:"请选择建筑状态",trigger:"change"}],buildDate:[{required:!0,message:"请选择建成日期",trigger:"change"}]},G=a([{id:1,name:"益客大厦A座",type:"office",address:"北京市朝阳区建国路88号",floors:25,area:15000.5,status:"normal",buildDate:"2020-06-15",description:"现代化办公大楼，配套设施完善",createTime:"2020-01-01 10:00:00"},{id:2,name:"益客住宅小区",type:"residential",address:"北京市海淀区中关村大街100号",floors:18,area:25e3,status:"normal",buildDate:"2019-12-01",description:"高品质住宅小区，环境优美",createTime:"2019-06-01 10:00:00"},{id:3,name:"益客商业中心",type:"commercial",address:"北京市西城区西单大街200号",floors:12,area:18e3,status:"maintenance",buildDate:"2018-08-20",description:"综合性商业中心，交通便利",createTime:"2018-03-01 10:00:00"}]),K=t((()=>W.id?"编辑建筑":"添加建筑")),Q=e=>({office:"办公楼",residential:"住宅楼",commercial:"商业楼",industrial:"工业建筑"}[e]||"未知"),H=e=>({office:"primary",residential:"success",commercial:"warning",industrial:"info"}[e]||""),X=e=>({normal:"正常",maintenance:"维护中",disabled:"停用"}[e]||"未知"),Y=e=>({normal:"success",maintenance:"warning",disabled:"danger"}[e]||""),ee=()=>{W.id=null,P.value=!0},ae=async()=>{if(Z.value)try{if(await Z.value.validate(),I.value=!0,await new Promise((e=>setTimeout(e,1e3))),W.id){const e=G.value.findIndex((e=>e.id===W.id));e>-1&&(G.value[e]={...W}),w.success("编辑成功")}else{const e={...W,id:Date.now(),createTime:(new Date).toLocaleString()};G.value.unshift(e),w.success("添加成功")}P.value=!1,le()}catch(e){}finally{I.value=!1}},le=()=>{Z.value&&Z.value.resetFields(),Object.assign(W,{id:null,name:"",type:"",address:"",floors:1,area:0,status:"normal",buildDate:"",description:""})},te=()=>{R.currentPage=1},de=()=>{Object.assign(F,{name:"",status:"",type:""}),te()},oe=e=>{R.pageSize=e},ie=e=>{R.currentPage=e};function ue(){var e;N.start="",N.end=(null==(e=$.value)?void 0:e.address)||"",A.value="",L.value=!0,x((()=>{!function(){const e=new window.BMap.Map("baiduMapContainer");e.centerAndZoom(N.end||"北京",12),e.enableScrollWheelZoom(!0),e.clearOverlays(),e.addEventListener("click",(function(e){const a=e.point;(new window.BMap.Geocoder).getLocation(a,(function(e){const a=e.address;h({title:"地图点选",message:`将【${a}】设为起点还是终点？`,showCancelButton:!0,confirmButtonText:"起点",cancelButtonText:"终点"}).then((()=>{N.start=a})).catch((()=>{N.end=a}))}))}))}()})),re()}function ne(){if(!N.start||!N.end)return void(A.value="请填写起点和终点");const e=new window.BMap.Map("baiduMapContainer");e.centerAndZoom(N.end,14),e.enableScrollWheelZoom(!0),new window.BMap.DrivingRoute(e,{renderOptions:{map:e,autoViewport:!0}}).search(N.start,N.end),A.value=`已为您规划从【${N.start}】到【${N.end}】的路径`,function(e){const a="building_route_history";let l=JSON.parse(localStorage.getItem(a)||"[]");l.unshift(e),l.length>10&&(l=l.slice(0,10)),localStorage.setItem(a,JSON.stringify(l))}({start:N.start,end:N.end,time:(new Date).toLocaleString()}),re()}function re(){J.value=JSON.parse(localStorage.getItem("building_route_history")||"[]")}return d((()=>{R.total=G.value.length})),(e,a)=>{const l=o("el-icon"),t=o("el-button"),d=o("el-input"),x=o("el-col"),re=o("el-option"),se=o("el-select"),pe=o("el-row"),ce=o("el-table-column"),me=o("el-tag"),fe=o("el-table"),_e=o("el-pagination"),ge=o("el-form-item"),ve=o("el-input-number"),be=o("el-date-picker"),ye=o("el-form"),he=o("el-dialog"),we=o("el-descriptions-item"),Ve=o("el-descriptions"),xe=o("el-alert"),Ce=i("loading");return u(),n("div",C,[r("div",k,[a[21]||(a[21]=r("h2",null,"建筑管理系统",-1)),s(t,{type:"primary",onClick:ee},{default:p((()=>[s(l,null,{default:p((()=>[s(c(m))])),_:1}),a[20]||(a[20]=f(" 添加建筑 "))])),_:1,__:[20]})]),r("div",U,[s(pe,{gutter:20},{default:p((()=>[s(x,{span:6},{default:p((()=>[s(d,{modelValue:F.name,"onUpdate:modelValue":a[0]||(a[0]=e=>F.name=e),placeholder:"建筑名称",clearable:"",onClear:te,onKeyup:_(te,["enter"])},{prefix:p((()=>[s(l,null,{default:p((()=>[s(c(g))])),_:1})])),_:1},8,["modelValue"])])),_:1}),s(x,{span:6},{default:p((()=>[s(se,{modelValue:F.status,"onUpdate:modelValue":a[1]||(a[1]=e=>F.status=e),placeholder:"建筑状态",clearable:"",onChange:te},{default:p((()=>[s(re,{label:"正常",value:"normal"}),s(re,{label:"维护中",value:"maintenance"}),s(re,{label:"停用",value:"disabled"})])),_:1},8,["modelValue"])])),_:1}),s(x,{span:6},{default:p((()=>[s(se,{modelValue:F.type,"onUpdate:modelValue":a[2]||(a[2]=e=>F.type=e),placeholder:"建筑类型",clearable:"",onChange:te},{default:p((()=>[s(re,{label:"办公楼",value:"office"}),s(re,{label:"住宅楼",value:"residential"}),s(re,{label:"商业楼",value:"commercial"}),s(re,{label:"工业建筑",value:"industrial"})])),_:1},8,["modelValue"])])),_:1}),s(x,{span:6},{default:p((()=>[s(t,{type:"primary",onClick:te},{default:p((()=>[s(l,null,{default:p((()=>[s(c(g))])),_:1}),a[22]||(a[22]=f(" 搜索 "))])),_:1,__:[22]}),s(t,{onClick:de},{default:p((()=>a[23]||(a[23]=[f("重置")]))),_:1,__:[23]})])),_:1})])),_:1})]),r("div",S,[v((u(),b(fe,{data:G.value,stripe:""},{default:p((()=>[s(ce,{prop:"id",label:"ID",width:"80"}),s(ce,{prop:"name",label:"建筑名称"}),s(ce,{prop:"type",label:"建筑类型"},{default:p((e=>[s(me,{type:H(e.row.type)},{default:p((()=>[f(y(Q(e.row.type)),1)])),_:2},1032,["type"])])),_:1}),s(ce,{prop:"address",label:"地址"}),s(ce,{prop:"floors",label:"楼层数",width:"100"}),s(ce,{prop:"area",label:"建筑面积(m²)",width:"120"}),s(ce,{prop:"status",label:"状态",width:"100"},{default:p((e=>[s(me,{type:Y(e.row.status)},{default:p((()=>[f(y(X(e.row.status)),1)])),_:2},1032,["type"])])),_:1}),s(ce,{prop:"buildDate",label:"建成日期",width:"120"}),s(ce,{label:"操作",width:"200",fixed:"right"},{default:p((e=>[s(t,{size:"small",onClick:a=>{return l=e.row,$.value=l,void(j.value=!0);var l}},{default:p((()=>a[24]||(a[24]=[f("查看")]))),_:2,__:[24]},1032,["onClick"]),s(t,{size:"small",type:"primary",onClick:a=>{return l=e.row,Object.assign(W,l),void(P.value=!0);var l}},{default:p((()=>a[25]||(a[25]=[f("编辑")]))),_:2,__:[25]},1032,["onClick"]),s(t,{size:"small",type:"danger",onClick:a=>(async e=>{try{await h.confirm(`确定要删除建筑"${e.name}"吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const a=G.value.findIndex((a=>a.id===e.id));a>-1&&(G.value.splice(a,1),w.success("删除成功"))}catch(a){}})(e.row)},{default:p((()=>a[26]||(a[26]=[f("删除")]))),_:2,__:[26]},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[Ce,q.value]]),r("div",z,[s(_e,{"current-page":R.currentPage,"onUpdate:currentPage":a[3]||(a[3]=e=>R.currentPage=e),"page-size":R.pageSize,"onUpdate:pageSize":a[4]||(a[4]=e=>R.pageSize=e),"page-sizes":[10,20,50,100],total:R.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:oe,onCurrentChange:ie},null,8,["current-page","page-size","total"])])]),s(he,{modelValue:P.value,"onUpdate:modelValue":a[14]||(a[14]=e=>P.value=e),title:K.value,width:"600px",onClose:le},{footer:p((()=>[r("div",D,[s(t,{onClick:a[13]||(a[13]=e=>P.value=!1)},{default:p((()=>a[28]||(a[28]=[f("取消")]))),_:1,__:[28]}),s(t,{type:"primary",onClick:ae,loading:I.value},{default:p((()=>a[29]||(a[29]=[f("确定")]))),_:1,__:[29]},8,["loading"])])])),default:p((()=>[s(ye,{model:W,rules:E,ref_key:"buildingFormRef",ref:Z,"label-width":"100px"},{default:p((()=>[s(ge,{label:"建筑名称",prop:"name"},{default:p((()=>[s(d,{modelValue:W.name,"onUpdate:modelValue":a[5]||(a[5]=e=>W.name=e),placeholder:"请输入建筑名称"},null,8,["modelValue"])])),_:1}),s(ge,{label:"建筑类型",prop:"type"},{default:p((()=>[s(se,{modelValue:W.type,"onUpdate:modelValue":a[6]||(a[6]=e=>W.type=e),placeholder:"请选择建筑类型",style:{width:"100%"}},{default:p((()=>[s(re,{label:"办公楼",value:"office"}),s(re,{label:"住宅楼",value:"residential"}),s(re,{label:"商业楼",value:"commercial"}),s(re,{label:"工业建筑",value:"industrial"})])),_:1},8,["modelValue"])])),_:1}),s(ge,{label:"地址",prop:"address"},{default:p((()=>[s(d,{modelValue:W.address,"onUpdate:modelValue":a[7]||(a[7]=e=>W.address=e),placeholder:"请输入建筑地址"},null,8,["modelValue"])])),_:1}),s(ge,{label:"楼层数",prop:"floors"},{default:p((()=>[s(ve,{modelValue:W.floors,"onUpdate:modelValue":a[8]||(a[8]=e=>W.floors=e),min:1,max:200,style:{width:"100%"}},null,8,["modelValue"])])),_:1}),s(ge,{label:"建筑面积",prop:"area"},{default:p((()=>[s(ve,{modelValue:W.area,"onUpdate:modelValue":a[9]||(a[9]=e=>W.area=e),min:1,precision:2,style:{width:"100%"}},null,8,["modelValue"]),a[27]||(a[27]=r("span",{style:{"margin-left":"10px",color:"#666"}},"m²",-1))])),_:1,__:[27]}),s(ge,{label:"建筑状态",prop:"status"},{default:p((()=>[s(se,{modelValue:W.status,"onUpdate:modelValue":a[10]||(a[10]=e=>W.status=e),placeholder:"请选择建筑状态",style:{width:"100%"}},{default:p((()=>[s(re,{label:"正常",value:"normal"}),s(re,{label:"维护中",value:"maintenance"}),s(re,{label:"停用",value:"disabled"})])),_:1},8,["modelValue"])])),_:1}),s(ge,{label:"建成日期",prop:"buildDate"},{default:p((()=>[s(be,{modelValue:W.buildDate,"onUpdate:modelValue":a[11]||(a[11]=e=>W.buildDate=e),type:"date",placeholder:"选择建成日期",style:{width:"100%"}},null,8,["modelValue"])])),_:1}),s(ge,{label:"描述",prop:"description"},{default:p((()=>[s(d,{modelValue:W.description,"onUpdate:modelValue":a[12]||(a[12]=e=>W.description=e),type:"textarea",rows:3,placeholder:"请输入建筑描述"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","title"]),s(he,{modelValue:j.value,"onUpdate:modelValue":a[16]||(a[16]=e=>j.value=e),title:"建筑详情",width:"800px"},{footer:p((()=>[r("div",B,[s(t,{onClick:a[15]||(a[15]=e=>j.value=!1)},{default:p((()=>a[30]||(a[30]=[f("关闭")]))),_:1,__:[30]}),s(t,{type:"primary",onClick:ue},{default:p((()=>a[31]||(a[31]=[f("路径规划")]))),_:1,__:[31]})])])),default:p((()=>[$.value?(u(),n("div",T,[s(Ve,{column:2,border:""},{default:p((()=>[s(we,{label:"建筑名称"},{default:p((()=>[f(y($.value.name),1)])),_:1}),s(we,{label:"建筑类型"},{default:p((()=>[s(me,{type:H($.value.type)},{default:p((()=>[f(y(Q($.value.type)),1)])),_:1},8,["type"])])),_:1}),s(we,{label:"地址"},{default:p((()=>[f(y($.value.address),1)])),_:1}),s(we,{label:"楼层数"},{default:p((()=>[f(y($.value.floors)+"层",1)])),_:1}),s(we,{label:"建筑面积"},{default:p((()=>[f(y($.value.area)+" m²",1)])),_:1}),s(we,{label:"建筑状态"},{default:p((()=>[s(me,{type:Y($.value.status)},{default:p((()=>[f(y(X($.value.status)),1)])),_:1},8,["type"])])),_:1}),s(we,{label:"建成日期"},{default:p((()=>[f(y($.value.buildDate),1)])),_:1}),s(we,{label:"创建时间"},{default:p((()=>[f(y($.value.createTime),1)])),_:1}),s(we,{label:"描述",span:2},{default:p((()=>[f(y($.value.description||"暂无描述"),1)])),_:1})])),_:1})])):V("",!0)])),_:1},8,["modelValue"]),s(he,{modelValue:L.value,"onUpdate:modelValue":a[19]||(a[19]=e=>L.value=e),title:"路径规划",width:"800px"},{default:p((()=>[r("div",null,[s(ye,{model:N,"label-width":"80px",inline:""},{default:p((()=>[s(ge,{label:"起点"},{default:p((()=>[s(d,{modelValue:N.start,"onUpdate:modelValue":a[17]||(a[17]=e=>N.start=e),placeholder:"请输入起点",style:{width:"200px"}},null,8,["modelValue"])])),_:1}),s(ge,{label:"终点"},{default:p((()=>[s(d,{modelValue:N.end,"onUpdate:modelValue":a[18]||(a[18]=e=>N.end=e),placeholder:"请输入终点",style:{width:"200px"}},null,8,["modelValue"])])),_:1}),s(ge,null,{default:p((()=>[s(t,{type:"primary",onClick:ne},{default:p((()=>a[32]||(a[32]=[f("规划路径")]))),_:1,__:[32]})])),_:1})])),_:1},8,["model"]),a[35]||(a[35]=r("div",{id:"baiduMapContainer",style:{width:"100%",height:"400px","margin-top":"16px"}},null,-1)),A.value?(u(),n("div",M,[s(xe,{title:A.value,type:"success","show-icon":""},null,8,["title"])])):V("",!0),J.value.length?(u(),n("div",O,[a[34]||(a[34]=r("h4",null,"历史路径规划",-1)),s(fe,{data:J.value,size:"small",style:{width:"100%"}},{default:p((()=>[s(ce,{prop:"start",label:"起点"}),s(ce,{prop:"end",label:"终点"}),s(ce,{prop:"time",label:"时间",width:"180"}),s(ce,{label:"操作",width:"80"},{default:p((e=>[s(t,{size:"small",onClick:a=>{return l=e.row,N.start=l.start,N.end=l.end,void ne();var l}},{default:p((()=>a[33]||(a[33]=[f("回显")]))),_:2,__:[33]},1032,["onClick"])])),_:1})])),_:1},8,["data"])])):V("",!0)])])),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-aa77908f"]]);export{q as default};
