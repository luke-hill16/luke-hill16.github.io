import{A as fe,V as k,x as A,S as me,o as ge,B as s,y as ve,b as j,M as E,k as d,c as e,W as l,g as w,E as _e,e as u,C as be,H as ye,a as r,P as he,U as Ve,I as we,m as ke,p as F,D as Ce,i as Ue,f as De,Y as xe,J as P}from"./index-Cu5WJHTx.js";const ze={class:"traffic-container"},Me={class:"page-header"},Se={class:"header-actions"},$e={class:"overview-section"},Ae={class:"card-content"},Pe={class:"card-icon primary"},Te={class:"card-info"},Ie={class:"card-value"},Re={class:"card-content"},je={class:"card-icon success"},qe={class:"card-info"},Be={class:"card-value"},Ke={class:"card-content"},Oe={class:"card-icon warning"},Je={class:"card-info"},Le={class:"card-value"},We={class:"card-content"},Ye={class:"card-icon info"},Ee={class:"card-info"},Fe={class:"card-value"},He={class:"search-section"},Ne={class:"traffic-list"},Ge={class:"pagination-container"},Xe={class:"dialog-footer"},Ze={key:0,class:"traffic-detail"},Qe={__name:"traffic",setup(el){const H=k(!1),T=k(!1),C=k(!1),I=k(!1),x=k(),p=k(null),h=A({name:"",type:"",status:""}),m=A({currentPage:1,pageSize:10,total:0}),i=A({id:null,name:"",type:"",location:"",length:0,capacity:"",status:"normal",buildDate:"",lastMaintenance:"",description:""}),N={name:[{required:!0,message:"请输入设施名称",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"}],type:[{required:!0,message:"请选择设施类型",trigger:"change"}],location:[{required:!0,message:"请输入设施位置",trigger:"blur"}],length:[{required:!0,message:"请输入设施长度",trigger:"blur"}],capacity:[{required:!0,message:"请输入通行能力",trigger:"blur"}]},V=A({totalRoads:0,totalVehicles:0,totalAccidents:0,totalSignals:0}),g=k([{id:1,name:"长安街",type:"road",location:"北京市中心",length:3.8,capacity:"双向八车道",status:"normal",buildDate:"1950-01-01",lastMaintenance:"2024-01-15",description:"北京市最重要的东西向主干道，连接天安门广场",createTime:"2020-01-01 10:00:00"},{id:2,name:"二环路",type:"road",location:"北京市二环",length:32.7,capacity:"双向六车道",status:"normal",buildDate:"1980-01-01",lastMaintenance:"2024-02-01",description:"北京市重要的环形主干道",createTime:"2020-01-01 10:00:00"},{id:3,name:"长安街信号灯系统",type:"signal",location:"长安街沿线",length:0,capacity:"智能控制",status:"normal",buildDate:"2010-01-01",lastMaintenance:"2024-01-20",description:"智能交通信号灯系统，实现绿波带控制",createTime:"2020-01-01 10:00:00"},{id:4,name:"西直门立交桥",type:"bridge",location:"西直门地区",length:1.2,capacity:"双向四车道",status:"maintenance",buildDate:"1995-01-01",lastMaintenance:"2024-03-01",description:"重要的交通枢纽立交桥",createTime:"2020-01-01 10:00:00"},{id:5,name:"王府井停车场",type:"parking",location:"王府井商业区",length:0,capacity:"500个车位",status:"normal",buildDate:"2005-01-01",lastMaintenance:"2024-01-10",description:"王府井商业区地下停车场",createTime:"2020-01-01 10:00:00"}]),G=me(()=>i.id?"编辑交通设施":"添加交通设施"),q=n=>({road:"道路",bridge:"桥梁",tunnel:"隧道",signal:"信号灯",parking:"停车场"})[n]||"未知",B=n=>({road:"primary",bridge:"success",tunnel:"warning",signal:"info",parking:"danger"})[n]||"",K=n=>({normal:"正常",maintenance:"维护中",fault:"故障",construction:"建设中"})[n]||"未知",O=n=>({normal:"success",maintenance:"warning",fault:"danger",construction:"info"})[n]||"",X=n=>n.toLocaleString(),Z=()=>{i.id=null,C.value=!0},Q=n=>{Object.assign(i,n),C.value=!0},ee=n=>{p.value=n,I.value=!0},le=async n=>{try{await xe.confirm(`确定要删除交通设施"${n.name}"吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const a=g.value.findIndex(f=>f.id===n.id);a>-1&&(g.value.splice(a,1),R(),P.success("删除成功"))}catch{}},ae=async()=>{if(x.value)try{if(await x.value.validate(),T.value=!0,await new Promise(n=>setTimeout(n,1e3)),i.id){const n=g.value.findIndex(a=>a.id===i.id);n>-1&&(g.value[n]={...i}),P.success("编辑成功")}else{const n={...i,id:Date.now(),createTime:new Date().toLocaleString()};g.value.unshift(n),P.success("添加成功")}R(),C.value=!1,J()}catch(n){console.error("表单验证失败:",n)}finally{T.value=!1}},J=()=>{x.value&&x.value.resetFields(),Object.assign(i,{id:null,name:"",type:"",location:"",length:0,capacity:"",status:"normal",buildDate:"",lastMaintenance:"",description:""})},U=()=>{m.currentPage=1,console.log("搜索条件:",h)},te=()=>{Object.assign(h,{name:"",type:"",status:""}),U()},ne=n=>{m.pageSize=n},de=n=>{m.currentPage=n},ie=()=>{P.success("交通设施数据导出成功")},R=()=>{V.totalRoads=g.value.filter(n=>n.type==="road").length,V.totalVehicles=15e5,V.totalAccidents=25,V.totalSignals=g.value.filter(n=>n.type==="signal").length};return ge(()=>{R(),m.total=g.value.length}),(n,a)=>{const f=s("el-icon"),v=s("el-button"),M=s("el-card"),c=s("el-col"),D=s("el-row"),z=s("el-input"),o=s("el-option"),S=s("el-select"),_=s("el-table-column"),$=s("el-tag"),ue=s("el-table"),se=s("el-pagination"),b=s("el-form-item"),oe=s("el-input-number"),L=s("el-date-picker"),ce=s("el-form"),W=s("el-dialog"),y=s("el-descriptions-item"),re=s("el-descriptions"),pe=ve("loading");return j(),E("div",ze,[d("div",Me,[a[19]||(a[19]=d("h2",null,"交通管理系统",-1)),d("div",Se,[e(v,{type:"success",onClick:ie},{default:l(()=>[e(f,null,{default:l(()=>[e(w(_e))]),_:1}),a[17]||(a[17]=u(" 导出数据 "))]),_:1,__:[17]}),e(v,{type:"primary",onClick:Z},{default:l(()=>[e(f,null,{default:l(()=>[e(w(be))]),_:1}),a[18]||(a[18]=u(" 添加设施 "))]),_:1,__:[18]})])]),d("div",$e,[e(D,{gutter:20},{default:l(()=>[e(c,{span:6},{default:l(()=>[e(M,{class:"overview-card"},{default:l(()=>[d("div",Ae,[d("div",Pe,[e(f,null,{default:l(()=>[e(w(ye))]),_:1})]),d("div",Te,[a[20]||(a[20]=d("div",{class:"card-title"},"道路总数",-1)),d("div",Ie,r(V.totalRoads),1)])])]),_:1})]),_:1}),e(c,{span:6},{default:l(()=>[e(M,{class:"overview-card"},{default:l(()=>[d("div",Re,[d("div",je,[e(f,null,{default:l(()=>[e(w(he))]),_:1})]),d("div",qe,[a[21]||(a[21]=d("div",{class:"card-title"},"车辆流量",-1)),d("div",Be,r(X(V.totalVehicles)),1)])])]),_:1})]),_:1}),e(c,{span:6},{default:l(()=>[e(M,{class:"overview-card"},{default:l(()=>[d("div",Ke,[d("div",Oe,[e(f,null,{default:l(()=>[e(w(Ve))]),_:1})]),d("div",Je,[a[22]||(a[22]=d("div",{class:"card-title"},"事故数量",-1)),d("div",Le,r(V.totalAccidents),1)])])]),_:1})]),_:1}),e(c,{span:6},{default:l(()=>[e(M,{class:"overview-card"},{default:l(()=>[d("div",We,[d("div",Ye,[e(f,null,{default:l(()=>[e(w(we))]),_:1})]),d("div",Ee,[a[23]||(a[23]=d("div",{class:"card-title"},"信号灯",-1)),d("div",Fe,r(V.totalSignals),1)])])]),_:1})]),_:1})]),_:1})]),d("div",He,[e(D,{gutter:20},{default:l(()=>[e(c,{span:6},{default:l(()=>[e(z,{modelValue:h.name,"onUpdate:modelValue":a[0]||(a[0]=t=>h.name=t),placeholder:"设施名称",clearable:"",onClear:U,onKeyup:ke(U,["enter"])},{prefix:l(()=>[e(f,null,{default:l(()=>[e(w(F))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(c,{span:6},{default:l(()=>[e(S,{modelValue:h.type,"onUpdate:modelValue":a[1]||(a[1]=t=>h.type=t),placeholder:"设施类型",clearable:"",onChange:U},{default:l(()=>[e(o,{label:"道路",value:"road"}),e(o,{label:"桥梁",value:"bridge"}),e(o,{label:"隧道",value:"tunnel"}),e(o,{label:"信号灯",value:"signal"}),e(o,{label:"停车场",value:"parking"})]),_:1},8,["modelValue"])]),_:1}),e(c,{span:6},{default:l(()=>[e(S,{modelValue:h.status,"onUpdate:modelValue":a[2]||(a[2]=t=>h.status=t),placeholder:"设施状态",clearable:"",onChange:U},{default:l(()=>[e(o,{label:"正常",value:"normal"}),e(o,{label:"维护中",value:"maintenance"}),e(o,{label:"故障",value:"fault"}),e(o,{label:"建设中",value:"construction"})]),_:1},8,["modelValue"])]),_:1}),e(c,{span:6},{default:l(()=>[e(v,{type:"primary",onClick:U},{default:l(()=>[e(f,null,{default:l(()=>[e(w(F))]),_:1}),a[24]||(a[24]=u(" 搜索 "))]),_:1,__:[24]}),e(v,{onClick:te},{default:l(()=>a[25]||(a[25]=[u("重置")])),_:1,__:[25]})]),_:1})]),_:1})]),d("div",Ne,[Ce((j(),Ue(ue,{data:g.value,stripe:""},{default:l(()=>[e(_,{prop:"id",label:"ID",width:"80"}),e(_,{prop:"name",label:"设施名称"}),e(_,{prop:"type",label:"设施类型",width:"100"},{default:l(t=>[e($,{type:B(t.row.type)},{default:l(()=>[u(r(q(t.row.type)),1)]),_:2},1032,["type"])]),_:1}),e(_,{prop:"location",label:"位置"}),e(_,{prop:"length",label:"长度(km)",width:"100"}),e(_,{prop:"capacity",label:"通行能力",width:"120"}),e(_,{prop:"status",label:"状态",width:"100"},{default:l(t=>[e($,{type:O(t.row.status)},{default:l(()=>[u(r(K(t.row.status)),1)]),_:2},1032,["type"])]),_:1}),e(_,{prop:"lastMaintenance",label:"最后维护",width:"120"}),e(_,{label:"操作",width:"200",fixed:"right"},{default:l(t=>[e(v,{size:"small",onClick:Y=>ee(t.row)},{default:l(()=>a[26]||(a[26]=[u("查看")])),_:2,__:[26]},1032,["onClick"]),e(v,{size:"small",type:"primary",onClick:Y=>Q(t.row)},{default:l(()=>a[27]||(a[27]=[u("编辑")])),_:2,__:[27]},1032,["onClick"]),e(v,{size:"small",type:"danger",onClick:Y=>le(t.row)},{default:l(()=>a[28]||(a[28]=[u("删除")])),_:2,__:[28]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[pe,H.value]]),d("div",Ge,[e(se,{"current-page":m.currentPage,"onUpdate:currentPage":a[3]||(a[3]=t=>m.currentPage=t),"page-size":m.pageSize,"onUpdate:pageSize":a[4]||(a[4]=t=>m.pageSize=t),"page-sizes":[10,20,50,100],total:m.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:ne,onCurrentChange:de},null,8,["current-page","page-size","total"])])]),e(W,{modelValue:C.value,"onUpdate:modelValue":a[15]||(a[15]=t=>C.value=t),title:G.value,width:"700px",onClose:J},{footer:l(()=>[d("div",Xe,[e(v,{onClick:a[14]||(a[14]=t=>C.value=!1)},{default:l(()=>a[29]||(a[29]=[u("取消")])),_:1,__:[29]}),e(v,{type:"primary",onClick:ae,loading:T.value},{default:l(()=>a[30]||(a[30]=[u("确定")])),_:1,__:[30]},8,["loading"])])]),default:l(()=>[e(ce,{model:i,rules:N,ref_key:"trafficFormRef",ref:x,"label-width":"120px"},{default:l(()=>[e(D,{gutter:20},{default:l(()=>[e(c,{span:12},{default:l(()=>[e(b,{label:"设施名称",prop:"name"},{default:l(()=>[e(z,{modelValue:i.name,"onUpdate:modelValue":a[5]||(a[5]=t=>i.name=t),placeholder:"请输入设施名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{span:12},{default:l(()=>[e(b,{label:"设施类型",prop:"type"},{default:l(()=>[e(S,{modelValue:i.type,"onUpdate:modelValue":a[6]||(a[6]=t=>i.type=t),placeholder:"请选择设施类型",style:{width:"100%"}},{default:l(()=>[e(o,{label:"道路",value:"road"}),e(o,{label:"桥梁",value:"bridge"}),e(o,{label:"隧道",value:"tunnel"}),e(o,{label:"信号灯",value:"signal"}),e(o,{label:"停车场",value:"parking"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(D,{gutter:20},{default:l(()=>[e(c,{span:12},{default:l(()=>[e(b,{label:"位置",prop:"location"},{default:l(()=>[e(z,{modelValue:i.location,"onUpdate:modelValue":a[7]||(a[7]=t=>i.location=t),placeholder:"请输入设施位置"},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{span:12},{default:l(()=>[e(b,{label:"长度(km)",prop:"length"},{default:l(()=>[e(oe,{modelValue:i.length,"onUpdate:modelValue":a[8]||(a[8]=t=>i.length=t),min:0,precision:2,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(D,{gutter:20},{default:l(()=>[e(c,{span:12},{default:l(()=>[e(b,{label:"通行能力",prop:"capacity"},{default:l(()=>[e(z,{modelValue:i.capacity,"onUpdate:modelValue":a[9]||(a[9]=t=>i.capacity=t),placeholder:"如：双向四车道"},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{span:12},{default:l(()=>[e(b,{label:"设施状态",prop:"status"},{default:l(()=>[e(S,{modelValue:i.status,"onUpdate:modelValue":a[10]||(a[10]=t=>i.status=t),placeholder:"请选择设施状态",style:{width:"100%"}},{default:l(()=>[e(o,{label:"正常",value:"normal"}),e(o,{label:"维护中",value:"maintenance"}),e(o,{label:"故障",value:"fault"}),e(o,{label:"建设中",value:"construction"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(D,{gutter:20},{default:l(()=>[e(c,{span:12},{default:l(()=>[e(b,{label:"建设时间",prop:"buildDate"},{default:l(()=>[e(L,{modelValue:i.buildDate,"onUpdate:modelValue":a[11]||(a[11]=t=>i.buildDate=t),type:"date",placeholder:"选择建设时间",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{span:12},{default:l(()=>[e(b,{label:"最后维护",prop:"lastMaintenance"},{default:l(()=>[e(L,{modelValue:i.lastMaintenance,"onUpdate:modelValue":a[12]||(a[12]=t=>i.lastMaintenance=t),type:"date",placeholder:"选择最后维护时间",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(b,{label:"设施描述",prop:"description"},{default:l(()=>[e(z,{modelValue:i.description,"onUpdate:modelValue":a[13]||(a[13]=t=>i.description=t),type:"textarea",rows:3,placeholder:"请输入设施描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),e(W,{modelValue:I.value,"onUpdate:modelValue":a[16]||(a[16]=t=>I.value=t),title:"交通设施详情",width:"800px"},{default:l(()=>[p.value?(j(),E("div",Ze,[e(re,{column:2,border:""},{default:l(()=>[e(y,{label:"设施名称"},{default:l(()=>[u(r(p.value.name),1)]),_:1}),e(y,{label:"设施类型"},{default:l(()=>[e($,{type:B(p.value.type)},{default:l(()=>[u(r(q(p.value.type)),1)]),_:1},8,["type"])]),_:1}),e(y,{label:"位置"},{default:l(()=>[u(r(p.value.location),1)]),_:1}),e(y,{label:"长度"},{default:l(()=>[u(r(p.value.length)+" km",1)]),_:1}),e(y,{label:"通行能力"},{default:l(()=>[u(r(p.value.capacity),1)]),_:1}),e(y,{label:"设施状态"},{default:l(()=>[e($,{type:O(p.value.status)},{default:l(()=>[u(r(K(p.value.status)),1)]),_:1},8,["type"])]),_:1}),e(y,{label:"建设时间"},{default:l(()=>[u(r(p.value.buildDate),1)]),_:1}),e(y,{label:"最后维护"},{default:l(()=>[u(r(p.value.lastMaintenance),1)]),_:1}),e(y,{label:"设施描述",span:2},{default:l(()=>[u(r(p.value.description||"暂无描述"),1)]),_:1})]),_:1})])):De("",!0)]),_:1},8,["modelValue"])])}}},al=fe(Qe,[["__scopeId","data-v-6fb2a1f1"]]);export{al as default};
