import{B as J}from"./OAPageHeader-ByDRAfLF-h9RNHkdk-CyZvuLMw.js";import{m as v}from"./http-C-_XONwZ-BI6Pfl8z-m3MqG1D0.js";import{L as y,w as z,R as X,E as K,C as A,$ as q,Y as l,J as a,s as r,z as L,M as h,D as Y,T as N,r as d,b as _,a as i,t as j,O as f,l as Q}from"./index-q8LaeBoo.js";import"./axios-DWwaMX5J-DXTQ3iZI-BeByrt0G.js";const Z=()=>v.get("/absent/type"),ee=()=>v.get("/absent/responder"),le=V=>v.post("/absent/absent",V),te=V=>v.get("/absent/absent?who=my"),w={getAbhsentTypes:Z,getResponder:ee,applyAbsent:le,getMyAbsents:te},ae={style:{"text-align":"right"}},ne={class:"dialog-footer"},oe={class:"demo-pagination-block",style:{display:"flex","align-items":"right","justify-content":"right"}},de=N({name:"my_abhosentt"}),pe=Object.assign(de,{setup(V){let u=y(!1),C=y([]),g=z({email:"",realname:""}),k=y([]),M=X(()=>g.email?"["+g.email+"]"+g.realname:"无"),o=z({title:"",absent_type_id:null,date_range:[],request_content:""});const O=()=>{o.title="",o.absent_type_id=null,o.date_range=[],o.request_content="",u.value=!0};let R=z({title:[{required:!0,message:"请输入标题！",trigger:"blur"}],absent_type_id:[{required:!0,message:"请选择请假类型！",trigger:"change"}],date_range:[{required:!0,message:"请选择请假时间！",trigger:"blur"}],request_content:[{required:!0,message:"请输入请假理由！",trigger:"blur"}]}),D=y();const S=()=>{D.value.validate(async(n,e)=>{if(n){let p={title:o.title,absent_type_id:o.absent_type_id,start_date:o.date_range[0],end_date:o.date_range[1],request_content:o.request_content};try{let b=await w.applyAbsent(p);console.log(b),u.value=!1}catch(b){A.error(b)}}})};return K(async()=>{try{let n=await w.getAbhsentTypes();C.value=n;let e=await w.getResponder();Object.assign(g,e);let p=await w.getMyAbsents();k.value=p,console.log(k.value)}catch(n){A.error(n)}}),(n,e)=>{const p=d("el-input"),b=d("el-option"),U=d("el-select"),m=d("el-button"),W=d("Plus"),P=d("el-icon"),$=d("el-card"),E=d("el-space"),c=d("el-form-item"),F=d("el-date-picker"),T=d("el-form"),B=d("el-dialog"),s=d("el-table-column"),x=d("el-tag"),H=d("el-table"),G=d("el-pagination");return _(),q(Y,null,[l(E,{direction:"vertical",fill:"",size:20,style:{width:"100%"}},{default:a(()=>[l(J,{content:"个人考勤"}),l($,{style:{"border-bottom":"1px solid#fff"},shadow:"none"},{default:a(()=>[e[12]||(e[12]=i(" 邮箱")),l(p,{modelValue:n.input,"onUpdate:modelValue":e[0]||(e[0]=t=>n.input=t),style:{width:"240px","text-align":"left",margin:"20px"},placeholder:"Please input"},null,8,["modelValue"]),e[13]||(e[13]=i(" 姓名")),l(p,{modelValue:n.input,"onUpdate:modelValue":e[1]||(e[1]=t=>n.input=t),style:{width:"240px","text-align":"left",margin:"20px"},placeholder:"Please input"},null,8,["modelValue"]),e[14]||(e[14]=i(" 地址")),l(U,{modelValue:n.value,"onUpdate:modelValue":e[2]||(e[2]=t=>n.value=t),placeholder:"Select",size:"middle",style:{width:"240px",margin:"20px"}},{default:a(()=>[(_(!0),q(Y,null,j(n.options,t=>(_(),f(b,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),l(m,{type:"primary"},{default:a(()=>e[9]||(e[9]=[i("编辑")])),_:1,__:[9]}),l(m,null,{default:a(()=>e[10]||(e[10]=[i("重置")])),_:1,__:[10]}),h("div",ae,[l(m,{type:"primary",onClick:O},{default:a(()=>[l(P,null,{default:a(()=>[l(W)]),_:1}),e[11]||(e[11]=i("发起考勤"))]),_:1,__:[11]})])]),_:1,__:[12,13,14]})]),_:1}),l(B,{modelValue:r(u),"onUpdate:modelValue":e[8]||(e[8]=t=>L(u)?u.value=t:u=t),title:"发起考勤",width:"600"},{footer:a(()=>[h("div",ne,[l(m,{onClick:e[7]||(e[7]=t=>L(u)?u.value=!1:u=!1)},{default:a(()=>e[15]||(e[15]=[i("取消")])),_:1,__:[15]}),l(m,{type:"primary",onClick:S},{default:a(()=>e[16]||(e[16]=[i(" 确定 ")])),_:1,__:[16]})])]),default:a(()=>[l(T,{model:r(o),rules:r(R),ref_key:"absentFormRef",ref:D},{default:a(()=>[l(c,{label:"标题","label-width":n.formLabelWidth,prop:"title"},{default:a(()=>[l(p,{modelValue:r(o).title,"onUpdate:modelValue":e[3]||(e[3]=t=>r(o).title=t),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(c,{label:"请假类型","label-width":n.formLabelWidth,prop:"absent_type_id"},{default:a(()=>[l(U,{modelValue:r(o).absent_type_id,"onUpdate:modelValue":e[4]||(e[4]=t=>r(o).absent_type_id=t),placeholder:"请选择请假类型"},{default:a(()=>[(_(!0),q(Y,null,j(r(C),t=>(_(),f(b,{label:t.name,value:t.id,key:t.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label-width"]),l(c,{label:"起止日期","label-width":n.formLabelWidth,prop:"date_range"},{default:a(()=>[l(F,{modelValue:r(o).date_range,"onUpdate:modelValue":e[5]||(e[5]=t=>r(o).date_range=t),type:"daterange","range-separator":"到","start-placeholder":"起始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(c,{label:"审批人","label-width":n.formLabelWidth},{default:a(()=>[l(p,{value:r(M),readonly:"",disabled:"",autocomplete:"off"},null,8,["value"])]),_:1},8,["label-width"]),l(c,{label:"请假理由","label-width":n.formLabelWidth,prop:"request_content"},{default:a(()=>[l(p,{type:"textarea",modelValue:r(o).request_content,"onUpdate:modelValue":e[6]||(e[6]=t=>r(o).request_content=t),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),l($,null,{default:a(()=>[l(H,{data:r(k),stripe:"",style:{width:"100%"},"default-sort":{prop:"date",order:"descending"},fit:"False"},{default:a(()=>[l(s,{type:"selection",selectable:n.selectable,width:"55"},null,8,["selectable"]),l(s,{type:"index",width:"50"}),l(s,{prop:"title",label:"标题",sortable:""}),l(s,{prop:"absent_type.name",label:"类型"}),l(s,{prop:"request_content",label:"原因"}),l(s,{prop:"start_date",label:"开始时间",sortable:""}),l(s,{prop:"end_date",label:"结束时间"}),l(s,{prop:"create_time.format('YYYY-MM-DD')",label:"发起它的时间"}),l(s,{label:"审核领导"},{default:a(()=>[i(Q(r(M)),1)]),_:1}),l(s,{prop:"response_content",label:"反馈意见"}),l(s,{label:"审核状态"},{default:a(t=>[t.row.status==1?(_(),f(x,{key:0,type:"info"},{default:a(()=>e[17]||(e[17]=[i("审核中")])),_:1,__:[17]})):t.row.status==2?(_(),f(x,{key:1,type:"success"},{default:a(()=>e[18]||(e[18]=[i("已通过")])),_:1,__:[18]})):(_(),f(x,{key:2,type:"danger"},{default:a(()=>e[19]||(e[19]=[i("已拒绝")])),_:1,__:[19]}))]),_:1}),l(s,{label:"Operations"},{default:a(t=>[l(m,{size:"small",type:"primary",onClick:I=>n.handleEdit(t.$index,t.row)},{default:a(()=>e[20]||(e[20]=[i(" 编辑 ")])),_:2,__:[20]},1032,["onClick"]),l(m,{size:"small",type:"primary",onClick:I=>n.handleDelete(t.$index,t.row)},{default:a(()=>e[21]||(e[21]=[i(" 删除 ")])),_:2,__:[21]},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),h("div",oe,[e[22]||(e[22]=h("div",{class:"demonstration"},null,-1)),l(G,{"page-sizes":[100,200,300,400],size:n.size,disabled:n.disabled,background:n.background,layout:"total, sizes, prev, pager, next, jumper",total:400,onSizeChange:n.handleSizeChange},null,8,["size","disabled","background","onSizeChange"])])],64)}}});export{pe as default};
