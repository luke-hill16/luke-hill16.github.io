import{C as e,V as l,u as a,S as t,o as d,B as o,v as i,b as u,M as n,k as r,c as s,W as p,h as c,w as m,e as f,l as _,m as g,x as b,i as v,a as y,f as h,g as w,J as V,K as C}from"./index-DyjvvSaJ.js";const x={class:"building-container"},k={class:"page-header"},U={class:"search-section"},D={class:"building-list"},S={class:"pagination-container"},z={class:"dialog-footer"},B={key:0,class:"building-detail"},T={class:"dialog-footer"},M={key:0,style:{"margin-top":"16px"}},O={key:1,style:{"margin-top":"24px"}},q=e({__name:"building",setup(e){const q=l(!1),I=l(!1),P=l(!1),j=l(!1),J=l(),L=l(null),Z=l(!1),$=a({start:"",end:""}),A=l(""),N=l([]),F=a({name:"",status:"",type:""}),K=a({currentPage:1,pageSize:10,total:0}),R=a({id:null,name:"",type:"",address:"",floors:1,area:0,status:"normal",buildDate:"",description:""}),W={name:[{required:!0,message:"请输入建筑名称",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"}],type:[{required:!0,message:"请选择建筑类型",trigger:"change"}],address:[{required:!0,message:"请输入建筑地址",trigger:"blur"}],floors:[{required:!0,message:"请输入楼层数",trigger:"blur"}],area:[{required:!0,message:"请输入建筑面积",trigger:"blur"}],status:[{required:!0,message:"请选择建筑状态",trigger:"change"}],buildDate:[{required:!0,message:"请选择建成日期",trigger:"change"}]},E=l([{id:1,name:"益客大厦A座",type:"office",address:"北京市朝阳区建国路88号",floors:25,area:15000.5,status:"normal",buildDate:"2020-06-15",description:"现代化办公大楼，配套设施完善",createTime:"2020-01-01 10:00:00"},{id:2,name:"益客住宅小区",type:"residential",address:"北京市海淀区中关村大街100号",floors:18,area:25e3,status:"normal",buildDate:"2019-12-01",description:"高品质住宅小区，环境优美",createTime:"2019-06-01 10:00:00"},{id:3,name:"益客商业中心",type:"commercial",address:"北京市西城区西单大街200号",floors:12,area:18e3,status:"maintenance",buildDate:"2018-08-20",description:"综合性商业中心，交通便利",createTime:"2018-03-01 10:00:00"}]),G=t((()=>R.id?"编辑建筑":"添加建筑")),H=e=>({office:"办公楼",residential:"住宅楼",commercial:"商业楼",industrial:"工业建筑"}[e]||"未知"),Q=e=>({office:"primary",residential:"success",commercial:"warning",industrial:"info"}[e]||""),X=e=>({normal:"正常",maintenance:"维护中",disabled:"停用"}[e]||"未知"),Y=e=>({normal:"success",maintenance:"warning",disabled:"danger"}[e]||""),ee=()=>{R.id=null,P.value=!0},le=async()=>{if(J.value)try{if(await J.value.validate(),I.value=!0,await new Promise((e=>setTimeout(e,1e3))),R.id){const e=E.value.findIndex((e=>e.id===R.id));e>-1&&(E.value[e]={...R}),V.success("编辑成功")}else{const e={...R,id:Date.now(),createTime:(new Date).toLocaleString()};E.value.unshift(e),V.success("添加成功")}P.value=!1,ae()}catch(e){}finally{I.value=!1}},ae=()=>{J.value&&J.value.resetFields(),Object.assign(R,{id:null,name:"",type:"",address:"",floors:1,area:0,status:"normal",buildDate:"",description:""})},te=()=>{K.currentPage=1},de=()=>{Object.assign(F,{name:"",status:"",type:""}),te()},oe=e=>{K.pageSize=e},ie=e=>{K.currentPage=e};function ue(){var e;$.start="",$.end=(null==(e=L.value)?void 0:e.address)||"",A.value="",Z.value=!0,C((()=>{!function(){const e=new window.BMap.Map("baiduMapContainer");e.centerAndZoom($.end||"北京",12),e.enableScrollWheelZoom(!0),e.clearOverlays(),e.addEventListener("click",(function(e){const l=e.point;(new window.BMap.Geocoder).getLocation(l,(function(e){const l=e.address;w({title:"地图点选",message:`将【${l}】设为起点还是终点？`,showCancelButton:!0,confirmButtonText:"起点",cancelButtonText:"终点"}).then((()=>{$.start=l})).catch((()=>{$.end=l}))}))}))}()})),re()}function ne(){if(!$.start||!$.end)return void(A.value="请填写起点和终点");const e=new window.BMap.Map("baiduMapContainer");e.centerAndZoom($.end,14),e.enableScrollWheelZoom(!0),new window.BMap.DrivingRoute(e,{renderOptions:{map:e,autoViewport:!0}}).search($.start,$.end),A.value=`已为您规划从【${$.start}】到【${$.end}】的路径`,function(e){const l="building_route_history";let a=JSON.parse(localStorage.getItem(l)||"[]");a.unshift(e),a.length>10&&(a=a.slice(0,10)),localStorage.setItem(l,JSON.stringify(a))}({start:$.start,end:$.end,time:(new Date).toLocaleString()}),re()}function re(){N.value=JSON.parse(localStorage.getItem("building_route_history")||"[]")}return d((()=>{K.total=E.value.length})),(e,l)=>{const a=o("el-icon"),t=o("el-button"),d=o("el-input"),C=o("el-col"),re=o("el-option"),se=o("el-select"),pe=o("el-row"),ce=o("el-table-column"),me=o("el-tag"),fe=o("el-table"),_e=o("el-pagination"),ge=o("el-form-item"),be=o("el-input-number"),ve=o("el-date-picker"),ye=o("el-form"),he=o("el-dialog"),we=o("el-descriptions-item"),Ve=o("el-descriptions"),Ce=o("el-alert"),xe=i("loading");return u(),n("div",x,[r("div",k,[l[21]||(l[21]=r("h2",null,"建筑管理系统",-1)),s(t,{type:"primary",onClick:ee},{default:p((()=>[s(a,null,{default:p((()=>[s(c(m))])),_:1}),l[20]||(l[20]=f(" 添加建筑 "))])),_:1,__:[20]})]),r("div",U,[s(pe,{gutter:20},{default:p((()=>[s(C,{span:6},{default:p((()=>[s(d,{modelValue:F.name,"onUpdate:modelValue":l[0]||(l[0]=e=>F.name=e),placeholder:"建筑名称",clearable:"",onClear:te,onKeyup:_(te,["enter"])},{prefix:p((()=>[s(a,null,{default:p((()=>[s(c(g))])),_:1})])),_:1},8,["modelValue"])])),_:1}),s(C,{span:6},{default:p((()=>[s(se,{modelValue:F.status,"onUpdate:modelValue":l[1]||(l[1]=e=>F.status=e),placeholder:"建筑状态",clearable:"",onChange:te},{default:p((()=>[s(re,{label:"正常",value:"normal"}),s(re,{label:"维护中",value:"maintenance"}),s(re,{label:"停用",value:"disabled"})])),_:1},8,["modelValue"])])),_:1}),s(C,{span:6},{default:p((()=>[s(se,{modelValue:F.type,"onUpdate:modelValue":l[2]||(l[2]=e=>F.type=e),placeholder:"建筑类型",clearable:"",onChange:te},{default:p((()=>[s(re,{label:"办公楼",value:"office"}),s(re,{label:"住宅楼",value:"residential"}),s(re,{label:"商业楼",value:"commercial"}),s(re,{label:"工业建筑",value:"industrial"})])),_:1},8,["modelValue"])])),_:1}),s(C,{span:6},{default:p((()=>[s(t,{type:"primary",onClick:te},{default:p((()=>[s(a,null,{default:p((()=>[s(c(g))])),_:1}),l[22]||(l[22]=f(" 搜索 "))])),_:1,__:[22]}),s(t,{onClick:de},{default:p((()=>l[23]||(l[23]=[f("重置")]))),_:1,__:[23]})])),_:1})])),_:1})]),r("div",D,[b((u(),v(fe,{data:E.value,stripe:""},{default:p((()=>[s(ce,{prop:"id",label:"ID",width:"80"}),s(ce,{prop:"name",label:"建筑名称"}),s(ce,{prop:"type",label:"建筑类型"},{default:p((e=>[s(me,{type:Q(e.row.type)},{default:p((()=>[f(y(H(e.row.type)),1)])),_:2},1032,["type"])])),_:1}),s(ce,{prop:"address",label:"地址"}),s(ce,{prop:"floors",label:"楼层数",width:"100"}),s(ce,{prop:"area",label:"建筑面积(m²)",width:"120"}),s(ce,{prop:"status",label:"状态",width:"100"},{default:p((e=>[s(me,{type:Y(e.row.status)},{default:p((()=>[f(y(X(e.row.status)),1)])),_:2},1032,["type"])])),_:1}),s(ce,{prop:"buildDate",label:"建成日期",width:"120"}),s(ce,{label:"操作",width:"200",fixed:"right"},{default:p((e=>[s(t,{size:"small",onClick:l=>(e=>{L.value=e,j.value=!0})(e.row)},{default:p((()=>l[24]||(l[24]=[f("查看")]))),_:2,__:[24]},1032,["onClick"]),s(t,{size:"small",type:"primary",onClick:l=>(e=>{Object.assign(R,e),P.value=!0})(e.row)},{default:p((()=>l[25]||(l[25]=[f("编辑")]))),_:2,__:[25]},1032,["onClick"]),s(t,{size:"small",type:"danger",onClick:l=>(async e=>{try{await w.confirm(`确定要删除建筑"${e.name}"吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const l=E.value.findIndex((l=>l.id===e.id));l>-1&&(E.value.splice(l,1),V.success("删除成功"))}catch{}})(e.row)},{default:p((()=>l[26]||(l[26]=[f("删除")]))),_:2,__:[26]},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[xe,q.value]]),r("div",S,[s(_e,{"current-page":K.currentPage,"onUpdate:currentPage":l[3]||(l[3]=e=>K.currentPage=e),"page-size":K.pageSize,"onUpdate:pageSize":l[4]||(l[4]=e=>K.pageSize=e),"page-sizes":[10,20,50,100],total:K.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:oe,onCurrentChange:ie},null,8,["current-page","page-size","total"])])]),s(he,{modelValue:P.value,"onUpdate:modelValue":l[14]||(l[14]=e=>P.value=e),title:G.value,width:"600px",onClose:ae},{footer:p((()=>[r("div",z,[s(t,{onClick:l[13]||(l[13]=e=>P.value=!1)},{default:p((()=>l[28]||(l[28]=[f("取消")]))),_:1,__:[28]}),s(t,{type:"primary",onClick:le,loading:I.value},{default:p((()=>l[29]||(l[29]=[f("确定")]))),_:1,__:[29]},8,["loading"])])])),default:p((()=>[s(ye,{model:R,rules:W,ref_key:"buildingFormRef",ref:J,"label-width":"100px"},{default:p((()=>[s(ge,{label:"建筑名称",prop:"name"},{default:p((()=>[s(d,{modelValue:R.name,"onUpdate:modelValue":l[5]||(l[5]=e=>R.name=e),placeholder:"请输入建筑名称"},null,8,["modelValue"])])),_:1}),s(ge,{label:"建筑类型",prop:"type"},{default:p((()=>[s(se,{modelValue:R.type,"onUpdate:modelValue":l[6]||(l[6]=e=>R.type=e),placeholder:"请选择建筑类型",style:{width:"100%"}},{default:p((()=>[s(re,{label:"办公楼",value:"office"}),s(re,{label:"住宅楼",value:"residential"}),s(re,{label:"商业楼",value:"commercial"}),s(re,{label:"工业建筑",value:"industrial"})])),_:1},8,["modelValue"])])),_:1}),s(ge,{label:"地址",prop:"address"},{default:p((()=>[s(d,{modelValue:R.address,"onUpdate:modelValue":l[7]||(l[7]=e=>R.address=e),placeholder:"请输入建筑地址"},null,8,["modelValue"])])),_:1}),s(ge,{label:"楼层数",prop:"floors"},{default:p((()=>[s(be,{modelValue:R.floors,"onUpdate:modelValue":l[8]||(l[8]=e=>R.floors=e),min:1,max:200,style:{width:"100%"}},null,8,["modelValue"])])),_:1}),s(ge,{label:"建筑面积",prop:"area"},{default:p((()=>[s(be,{modelValue:R.area,"onUpdate:modelValue":l[9]||(l[9]=e=>R.area=e),min:1,precision:2,style:{width:"100%"}},null,8,["modelValue"]),l[27]||(l[27]=r("span",{style:{"margin-left":"10px",color:"#666"}},"m²",-1))])),_:1,__:[27]}),s(ge,{label:"建筑状态",prop:"status"},{default:p((()=>[s(se,{modelValue:R.status,"onUpdate:modelValue":l[10]||(l[10]=e=>R.status=e),placeholder:"请选择建筑状态",style:{width:"100%"}},{default:p((()=>[s(re,{label:"正常",value:"normal"}),s(re,{label:"维护中",value:"maintenance"}),s(re,{label:"停用",value:"disabled"})])),_:1},8,["modelValue"])])),_:1}),s(ge,{label:"建成日期",prop:"buildDate"},{default:p((()=>[s(ve,{modelValue:R.buildDate,"onUpdate:modelValue":l[11]||(l[11]=e=>R.buildDate=e),type:"date",placeholder:"选择建成日期",style:{width:"100%"}},null,8,["modelValue"])])),_:1}),s(ge,{label:"描述",prop:"description"},{default:p((()=>[s(d,{modelValue:R.description,"onUpdate:modelValue":l[12]||(l[12]=e=>R.description=e),type:"textarea",rows:3,placeholder:"请输入建筑描述"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","title"]),s(he,{modelValue:j.value,"onUpdate:modelValue":l[16]||(l[16]=e=>j.value=e),title:"建筑详情",width:"800px"},{footer:p((()=>[r("div",T,[s(t,{onClick:l[15]||(l[15]=e=>j.value=!1)},{default:p((()=>l[30]||(l[30]=[f("关闭")]))),_:1,__:[30]}),s(t,{type:"primary",onClick:ue},{default:p((()=>l[31]||(l[31]=[f("路径规划")]))),_:1,__:[31]})])])),default:p((()=>[L.value?(u(),n("div",B,[s(Ve,{column:2,border:""},{default:p((()=>[s(we,{label:"建筑名称"},{default:p((()=>[f(y(L.value.name),1)])),_:1}),s(we,{label:"建筑类型"},{default:p((()=>[s(me,{type:Q(L.value.type)},{default:p((()=>[f(y(H(L.value.type)),1)])),_:1},8,["type"])])),_:1}),s(we,{label:"地址"},{default:p((()=>[f(y(L.value.address),1)])),_:1}),s(we,{label:"楼层数"},{default:p((()=>[f(y(L.value.floors)+"层",1)])),_:1}),s(we,{label:"建筑面积"},{default:p((()=>[f(y(L.value.area)+" m²",1)])),_:1}),s(we,{label:"建筑状态"},{default:p((()=>[s(me,{type:Y(L.value.status)},{default:p((()=>[f(y(X(L.value.status)),1)])),_:1},8,["type"])])),_:1}),s(we,{label:"建成日期"},{default:p((()=>[f(y(L.value.buildDate),1)])),_:1}),s(we,{label:"创建时间"},{default:p((()=>[f(y(L.value.createTime),1)])),_:1}),s(we,{label:"描述",span:2},{default:p((()=>[f(y(L.value.description||"暂无描述"),1)])),_:1})])),_:1})])):h("",!0)])),_:1},8,["modelValue"]),s(he,{modelValue:Z.value,"onUpdate:modelValue":l[19]||(l[19]=e=>Z.value=e),title:"路径规划",width:"800px"},{default:p((()=>[r("div",null,[s(ye,{model:$,"label-width":"80px",inline:""},{default:p((()=>[s(ge,{label:"起点"},{default:p((()=>[s(d,{modelValue:$.start,"onUpdate:modelValue":l[17]||(l[17]=e=>$.start=e),placeholder:"请输入起点",style:{width:"200px"}},null,8,["modelValue"])])),_:1}),s(ge,{label:"终点"},{default:p((()=>[s(d,{modelValue:$.end,"onUpdate:modelValue":l[18]||(l[18]=e=>$.end=e),placeholder:"请输入终点",style:{width:"200px"}},null,8,["modelValue"])])),_:1}),s(ge,null,{default:p((()=>[s(t,{type:"primary",onClick:ne},{default:p((()=>l[32]||(l[32]=[f("规划路径")]))),_:1,__:[32]})])),_:1})])),_:1},8,["model"]),l[35]||(l[35]=r("div",{id:"baiduMapContainer",style:{width:"100%",height:"400px","margin-top":"16px"}},null,-1)),A.value?(u(),n("div",M,[s(Ce,{title:A.value,type:"success","show-icon":""},null,8,["title"])])):h("",!0),N.value.length?(u(),n("div",O,[l[34]||(l[34]=r("h4",null,"历史路径规划",-1)),s(fe,{data:N.value,size:"small",style:{width:"100%"}},{default:p((()=>[s(ce,{prop:"start",label:"起点"}),s(ce,{prop:"end",label:"终点"}),s(ce,{prop:"time",label:"时间",width:"180"}),s(ce,{label:"操作",width:"80"},{default:p((e=>[s(t,{size:"small",onClick:l=>function(e){$.start=e.start,$.end=e.end,ne()}(e.row)},{default:p((()=>l[33]||(l[33]=[f("回显")]))),_:2,__:[33]},1032,["onClick"])])),_:1})])),_:1},8,["data"])])):h("",!0)])])),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-aa77908f"]]);export{q as default};
