import{S as i}from"./axios-DWwaMX5J-DXTQ3iZI.js";import{V as n,J as c,ak as p}from"./index-DNlctori.js";class l{constructor(){this.instance=i.create({baseURL:"192.168.1.48/api",timeout:6e4}),this.instance.interceptors.request.use(s=>{const t=n().token;return t&&(s.headers.Authorization="JWT "+t),s}),this.instance.interceptors.response.use(s=>s,s=>{var t;if(((t=s.response)==null?void 0:t.status)===403){const a=n();c.error("登录已过期，请重新登录"),a.clearUserToken(),p.push("/login")}return Promise.reject(s)})}post(s,t){return new Promise(async(a,o)=>{try{let e=await this.instance.post(s,t);console.log(e),a(e.data)}catch(e){console.log("请求出错:",e);let r=e.response&&e.response.data&&e.response.data.detail?e.response.data.detail:e.message||"未知错误";o(r)}})}get(s,t){return new Promise(async(a,o)=>{try{let e=await this.instance.get(s,t);a(e.data)}catch(e){console.log("请求出错:",e);let r=e.response&&e.response.data&&e.response.data.detail?e.response.data.detail:e.message||"未知错误";o(r)}})}}const m=new l;export{m as g};
