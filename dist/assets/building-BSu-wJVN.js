import{_ as e,r as a,J as l,l as t,o as d,c as o,a as i,b as u,w as n,K as r,i as s,d as p,L as c,e as m,u as f,M as _,g,y as b,z as v,t as y,j as h,k as w,E as V,N as C}from"./index-C3v4GxiK.js";const x={class:"building-container"},k={class:"page-header"},U={class:"search-section"},z={class:"building-list"},D={class:"pagination-container"},S={class:"dialog-footer"},M={key:0,class:"building-detail"},T={class:"dialog-footer"},B={key:0,style:{"margin-top":"16px"}},O={key:1,style:{"margin-top":"24px"}},q=e({__name:"building",setup(e){const q=a(!1),I=a(!1),P=a(!1),j=a(!1),L=a(),J=a(null),N=a(!1),Z=l({start:"",end:""}),$=a(""),A=a([]),E=l({name:"",status:"",type:""}),F=l({currentPage:1,pageSize:10,total:0}),K=l({id:null,name:"",type:"",address:"",floors:1,area:0,status:"normal",buildDate:"",description:""}),R={name:[{required:!0,message:"请输入建筑名称",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"}],type:[{required:!0,message:"请选择建筑类型",trigger:"change"}],address:[{required:!0,message:"请输入建筑地址",trigger:"blur"}],floors:[{required:!0,message:"请输入楼层数",trigger:"blur"}],area:[{required:!0,message:"请输入建筑面积",trigger:"blur"}],status:[{required:!0,message:"请选择建筑状态",trigger:"change"}],buildDate:[{required:!0,message:"请选择建成日期",trigger:"change"}]},W=a([{id:1,name:"益客大厦A座",type:"office",address:"北京市朝阳区建国路88号",floors:25,area:15000.5,status:"normal",buildDate:"2020-06-15",description:"现代化办公大楼，配套设施完善",createTime:"2020-01-01 10:00:00"},{id:2,name:"益客住宅小区",type:"residential",address:"北京市海淀区中关村大街100号",floors:18,area:25e3,status:"normal",buildDate:"2019-12-01",description:"高品质住宅小区，环境优美",createTime:"2019-06-01 10:00:00"},{id:3,name:"益客商业中心",type:"commercial",address:"北京市西城区西单大街200号",floors:12,area:18e3,status:"maintenance",buildDate:"2018-08-20",description:"综合性商业中心，交通便利",createTime:"2018-03-01 10:00:00"}]),G=t((()=>K.id?"编辑建筑":"添加建筑")),H=e=>({office:"办公楼",residential:"住宅楼",commercial:"商业楼",industrial:"工业建筑"}[e]||"未知"),Q=e=>({office:"primary",residential:"success",commercial:"warning",industrial:"info"}[e]||""),X=e=>({normal:"正常",maintenance:"维护中",disabled:"停用"}[e]||"未知"),Y=e=>({normal:"success",maintenance:"warning",disabled:"danger"}[e]||""),ee=()=>{K.id=null,P.value=!0},ae=async()=>{if(L.value)try{if(await L.value.validate(),I.value=!0,await new Promise((e=>setTimeout(e,1e3))),K.id){const e=W.value.findIndex((e=>e.id===K.id));e>-1&&(W.value[e]={...K}),V.success("编辑成功")}else{const e={...K,id:Date.now(),createTime:(new Date).toLocaleString()};W.value.unshift(e),V.success("添加成功")}P.value=!1,le()}catch(e){}finally{I.value=!1}},le=()=>{L.value&&L.value.resetFields(),Object.assign(K,{id:null,name:"",type:"",address:"",floors:1,area:0,status:"normal",buildDate:"",description:""})},te=()=>{F.currentPage=1},de=()=>{Object.assign(E,{name:"",status:"",type:""}),te()},oe=e=>{F.pageSize=e},ie=e=>{F.currentPage=e};function ue(){var e;Z.start="",Z.end=(null==(e=J.value)?void 0:e.address)||"",$.value="",N.value=!0,C((()=>{!function(){const e=new window.BMap.Map("baiduMapContainer");e.centerAndZoom(Z.end||"北京",12),e.enableScrollWheelZoom(!0),e.clearOverlays(),e.addEventListener("click",(function(e){const a=e.point;(new window.BMap.Geocoder).getLocation(a,(function(e){const a=e.address;w({title:"地图点选",message:`将【${a}】设为起点还是终点？`,showCancelButton:!0,confirmButtonText:"起点",cancelButtonText:"终点"}).then((()=>{Z.start=a})).catch((()=>{Z.end=a}))}))}))}()})),re()}function ne(){if(!Z.start||!Z.end)return void($.value="请填写起点和终点");const e=new window.BMap.Map("baiduMapContainer");e.centerAndZoom(Z.end,14),e.enableScrollWheelZoom(!0);new window.BMap.DrivingRoute(e,{renderOptions:{map:e,autoViewport:!0}}).search(Z.start,Z.end),$.value=`已为您规划从【${Z.start}】到【${Z.end}】的路径`,function(e){const a="building_route_history";let l=JSON.parse(localStorage.getItem(a)||"[]");l.unshift(e),l.length>10&&(l=l.slice(0,10));localStorage.setItem(a,JSON.stringify(l))}({start:Z.start,end:Z.end,time:(new Date).toLocaleString()}),re()}function re(){A.value=JSON.parse(localStorage.getItem("building_route_history")||"[]")}return d((()=>{F.total=W.value.length})),(e,a)=>{const l=p("el-icon"),t=p("el-button"),d=p("el-input"),C=p("el-col"),re=p("el-option"),se=p("el-select"),pe=p("el-row"),ce=p("el-table-column"),me=p("el-tag"),fe=p("el-table"),_e=p("el-pagination"),ge=p("el-form-item"),be=p("el-input-number"),ve=p("el-date-picker"),ye=p("el-form"),he=p("el-dialog"),we=p("el-descriptions-item"),Ve=p("el-descriptions"),Ce=p("el-alert"),xe=c("loading");return m(),o("div",x,[i("div",k,[a[21]||(a[21]=i("h2",null,"建筑管理系统",-1)),u(t,{type:"primary",onClick:ee},{default:n((()=>[u(l,null,{default:n((()=>[u(f(_))])),_:1}),a[20]||(a[20]=g(" 添加建筑 "))])),_:1,__:[20]})]),i("div",U,[u(pe,{gutter:20},{default:n((()=>[u(C,{span:6},{default:n((()=>[u(d,{modelValue:E.name,"onUpdate:modelValue":a[0]||(a[0]=e=>E.name=e),placeholder:"建筑名称",clearable:"",onClear:te,onKeyup:b(te,["enter"])},{prefix:n((()=>[u(l,null,{default:n((()=>[u(f(v))])),_:1})])),_:1},8,["modelValue"])])),_:1}),u(C,{span:6},{default:n((()=>[u(se,{modelValue:E.status,"onUpdate:modelValue":a[1]||(a[1]=e=>E.status=e),placeholder:"建筑状态",clearable:"",onChange:te},{default:n((()=>[u(re,{label:"正常",value:"normal"}),u(re,{label:"维护中",value:"maintenance"}),u(re,{label:"停用",value:"disabled"})])),_:1},8,["modelValue"])])),_:1}),u(C,{span:6},{default:n((()=>[u(se,{modelValue:E.type,"onUpdate:modelValue":a[2]||(a[2]=e=>E.type=e),placeholder:"建筑类型",clearable:"",onChange:te},{default:n((()=>[u(re,{label:"办公楼",value:"office"}),u(re,{label:"住宅楼",value:"residential"}),u(re,{label:"商业楼",value:"commercial"}),u(re,{label:"工业建筑",value:"industrial"})])),_:1},8,["modelValue"])])),_:1}),u(C,{span:6},{default:n((()=>[u(t,{type:"primary",onClick:te},{default:n((()=>[u(l,null,{default:n((()=>[u(f(v))])),_:1}),a[22]||(a[22]=g(" 搜索 "))])),_:1,__:[22]}),u(t,{onClick:de},{default:n((()=>a[23]||(a[23]=[g("重置")]))),_:1,__:[23]})])),_:1})])),_:1})]),i("div",z,[r((m(),s(fe,{data:W.value,stripe:""},{default:n((()=>[u(ce,{prop:"id",label:"ID",width:"80"}),u(ce,{prop:"name",label:"建筑名称"}),u(ce,{prop:"type",label:"建筑类型"},{default:n((e=>[u(me,{type:Q(e.row.type)},{default:n((()=>[g(y(H(e.row.type)),1)])),_:2},1032,["type"])])),_:1}),u(ce,{prop:"address",label:"地址"}),u(ce,{prop:"floors",label:"楼层数",width:"100"}),u(ce,{prop:"area",label:"建筑面积(m²)",width:"120"}),u(ce,{prop:"status",label:"状态",width:"100"},{default:n((e=>[u(me,{type:Y(e.row.status)},{default:n((()=>[g(y(X(e.row.status)),1)])),_:2},1032,["type"])])),_:1}),u(ce,{prop:"buildDate",label:"建成日期",width:"120"}),u(ce,{label:"操作",width:"200",fixed:"right"},{default:n((e=>[u(t,{size:"small",onClick:a=>{return l=e.row,J.value=l,void(j.value=!0);var l}},{default:n((()=>a[24]||(a[24]=[g("查看")]))),_:2,__:[24]},1032,["onClick"]),u(t,{size:"small",type:"primary",onClick:a=>{return l=e.row,Object.assign(K,l),void(P.value=!0);var l}},{default:n((()=>a[25]||(a[25]=[g("编辑")]))),_:2,__:[25]},1032,["onClick"]),u(t,{size:"small",type:"danger",onClick:a=>(async e=>{try{await w.confirm(`确定要删除建筑"${e.name}"吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const a=W.value.findIndex((a=>a.id===e.id));a>-1&&(W.value.splice(a,1),V.success("删除成功"))}catch(a){}})(e.row)},{default:n((()=>a[26]||(a[26]=[g("删除")]))),_:2,__:[26]},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[xe,q.value]]),i("div",D,[u(_e,{"current-page":F.currentPage,"onUpdate:currentPage":a[3]||(a[3]=e=>F.currentPage=e),"page-size":F.pageSize,"onUpdate:pageSize":a[4]||(a[4]=e=>F.pageSize=e),"page-sizes":[10,20,50,100],total:F.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:oe,onCurrentChange:ie},null,8,["current-page","page-size","total"])])]),u(he,{modelValue:P.value,"onUpdate:modelValue":a[14]||(a[14]=e=>P.value=e),title:G.value,width:"600px",onClose:le},{footer:n((()=>[i("div",S,[u(t,{onClick:a[13]||(a[13]=e=>P.value=!1)},{default:n((()=>a[28]||(a[28]=[g("取消")]))),_:1,__:[28]}),u(t,{type:"primary",onClick:ae,loading:I.value},{default:n((()=>a[29]||(a[29]=[g("确定")]))),_:1,__:[29]},8,["loading"])])])),default:n((()=>[u(ye,{model:K,rules:R,ref_key:"buildingFormRef",ref:L,"label-width":"100px"},{default:n((()=>[u(ge,{label:"建筑名称",prop:"name"},{default:n((()=>[u(d,{modelValue:K.name,"onUpdate:modelValue":a[5]||(a[5]=e=>K.name=e),placeholder:"请输入建筑名称"},null,8,["modelValue"])])),_:1}),u(ge,{label:"建筑类型",prop:"type"},{default:n((()=>[u(se,{modelValue:K.type,"onUpdate:modelValue":a[6]||(a[6]=e=>K.type=e),placeholder:"请选择建筑类型",style:{width:"100%"}},{default:n((()=>[u(re,{label:"办公楼",value:"office"}),u(re,{label:"住宅楼",value:"residential"}),u(re,{label:"商业楼",value:"commercial"}),u(re,{label:"工业建筑",value:"industrial"})])),_:1},8,["modelValue"])])),_:1}),u(ge,{label:"地址",prop:"address"},{default:n((()=>[u(d,{modelValue:K.address,"onUpdate:modelValue":a[7]||(a[7]=e=>K.address=e),placeholder:"请输入建筑地址"},null,8,["modelValue"])])),_:1}),u(ge,{label:"楼层数",prop:"floors"},{default:n((()=>[u(be,{modelValue:K.floors,"onUpdate:modelValue":a[8]||(a[8]=e=>K.floors=e),min:1,max:200,style:{width:"100%"}},null,8,["modelValue"])])),_:1}),u(ge,{label:"建筑面积",prop:"area"},{default:n((()=>[u(be,{modelValue:K.area,"onUpdate:modelValue":a[9]||(a[9]=e=>K.area=e),min:1,precision:2,style:{width:"100%"}},null,8,["modelValue"]),a[27]||(a[27]=i("span",{style:{"margin-left":"10px",color:"#666"}},"m²",-1))])),_:1,__:[27]}),u(ge,{label:"建筑状态",prop:"status"},{default:n((()=>[u(se,{modelValue:K.status,"onUpdate:modelValue":a[10]||(a[10]=e=>K.status=e),placeholder:"请选择建筑状态",style:{width:"100%"}},{default:n((()=>[u(re,{label:"正常",value:"normal"}),u(re,{label:"维护中",value:"maintenance"}),u(re,{label:"停用",value:"disabled"})])),_:1},8,["modelValue"])])),_:1}),u(ge,{label:"建成日期",prop:"buildDate"},{default:n((()=>[u(ve,{modelValue:K.buildDate,"onUpdate:modelValue":a[11]||(a[11]=e=>K.buildDate=e),type:"date",placeholder:"选择建成日期",style:{width:"100%"}},null,8,["modelValue"])])),_:1}),u(ge,{label:"描述",prop:"description"},{default:n((()=>[u(d,{modelValue:K.description,"onUpdate:modelValue":a[12]||(a[12]=e=>K.description=e),type:"textarea",rows:3,placeholder:"请输入建筑描述"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","title"]),u(he,{modelValue:j.value,"onUpdate:modelValue":a[16]||(a[16]=e=>j.value=e),title:"建筑详情",width:"800px"},{footer:n((()=>[i("div",T,[u(t,{onClick:a[15]||(a[15]=e=>j.value=!1)},{default:n((()=>a[30]||(a[30]=[g("关闭")]))),_:1,__:[30]}),u(t,{type:"primary",onClick:ue},{default:n((()=>a[31]||(a[31]=[g("路径规划")]))),_:1,__:[31]})])])),default:n((()=>[J.value?(m(),o("div",M,[u(Ve,{column:2,border:""},{default:n((()=>[u(we,{label:"建筑名称"},{default:n((()=>[g(y(J.value.name),1)])),_:1}),u(we,{label:"建筑类型"},{default:n((()=>[u(me,{type:Q(J.value.type)},{default:n((()=>[g(y(H(J.value.type)),1)])),_:1},8,["type"])])),_:1}),u(we,{label:"地址"},{default:n((()=>[g(y(J.value.address),1)])),_:1}),u(we,{label:"楼层数"},{default:n((()=>[g(y(J.value.floors)+"层",1)])),_:1}),u(we,{label:"建筑面积"},{default:n((()=>[g(y(J.value.area)+" m²",1)])),_:1}),u(we,{label:"建筑状态"},{default:n((()=>[u(me,{type:Y(J.value.status)},{default:n((()=>[g(y(X(J.value.status)),1)])),_:1},8,["type"])])),_:1}),u(we,{label:"建成日期"},{default:n((()=>[g(y(J.value.buildDate),1)])),_:1}),u(we,{label:"创建时间"},{default:n((()=>[g(y(J.value.createTime),1)])),_:1}),u(we,{label:"描述",span:2},{default:n((()=>[g(y(J.value.description||"暂无描述"),1)])),_:1})])),_:1})])):h("",!0)])),_:1},8,["modelValue"]),u(he,{modelValue:N.value,"onUpdate:modelValue":a[19]||(a[19]=e=>N.value=e),title:"路径规划",width:"800px"},{default:n((()=>[i("div",null,[u(ye,{model:Z,"label-width":"80px",inline:""},{default:n((()=>[u(ge,{label:"起点"},{default:n((()=>[u(d,{modelValue:Z.start,"onUpdate:modelValue":a[17]||(a[17]=e=>Z.start=e),placeholder:"请输入起点",style:{width:"200px"}},null,8,["modelValue"])])),_:1}),u(ge,{label:"终点"},{default:n((()=>[u(d,{modelValue:Z.end,"onUpdate:modelValue":a[18]||(a[18]=e=>Z.end=e),placeholder:"请输入终点",style:{width:"200px"}},null,8,["modelValue"])])),_:1}),u(ge,null,{default:n((()=>[u(t,{type:"primary",onClick:ne},{default:n((()=>a[32]||(a[32]=[g("规划路径")]))),_:1,__:[32]})])),_:1})])),_:1},8,["model"]),a[35]||(a[35]=i("div",{id:"baiduMapContainer",style:{width:"100%",height:"400px","margin-top":"16px"}},null,-1)),$.value?(m(),o("div",B,[u(Ce,{title:$.value,type:"success","show-icon":""},null,8,["title"])])):h("",!0),A.value.length?(m(),o("div",O,[a[34]||(a[34]=i("h4",null,"历史路径规划",-1)),u(fe,{data:A.value,size:"small",style:{width:"100%"}},{default:n((()=>[u(ce,{prop:"start",label:"起点"}),u(ce,{prop:"end",label:"终点"}),u(ce,{prop:"time",label:"时间",width:"180"}),u(ce,{label:"操作",width:"80"},{default:n((e=>[u(t,{size:"small",onClick:a=>{return l=e.row,Z.start=l.start,Z.end=l.end,void ne();var l}},{default:n((()=>a[33]||(a[33]=[g("回显")]))),_:2,__:[33]},1032,["onClick"])])),_:1})])),_:1},8,["data"])])):h("",!0)])])),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-aa77908f"]]);export{q as default};
