import{C as e,V as a,u as l,S as t,o as n,B as d,v as i,b as u,M as s,k as o,c,W as r,h as p,y as f,e as m,w as v,E as g,a as _,O as b,T as y,L as h,l as V,m as w,x as k,i as C,f as U,g as x,J as D}from"./index-DyjvvSaJ.js";const z={class:"traffic-container"},M={class:"page-header"},S={class:"header-actions"},T={class:"overview-section"},P={class:"card-content"},j={class:"card-icon primary"},q={class:"card-info"},I={class:"card-value"},O={class:"card-content"},R={class:"card-icon success"},A={class:"card-info"},B={class:"card-value"},L={class:"card-content"},F={class:"card-icon warning"},E={class:"card-info"},J={class:"card-value"},K={class:"card-content"},$={class:"card-icon info"},G={class:"card-info"},H={class:"card-value"},N={class:"search-section"},Q={class:"traffic-list"},W={class:"pagination-container"},X={class:"dialog-footer"},Y={key:0,class:"traffic-detail"},Z=e({__name:"traffic",setup(e){const Z=a(!1),ee=a(!1),ae=a(!1),le=a(!1),te=a(),ne=a(null),de=l({name:"",type:"",status:""}),ie=l({currentPage:1,pageSize:10,total:0}),ue=l({id:null,name:"",type:"",location:"",length:0,capacity:"",status:"normal",buildDate:"",lastMaintenance:"",description:""}),se={name:[{required:!0,message:"请输入设施名称",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"}],type:[{required:!0,message:"请选择设施类型",trigger:"change"}],location:[{required:!0,message:"请输入设施位置",trigger:"blur"}],length:[{required:!0,message:"请输入设施长度",trigger:"blur"}],capacity:[{required:!0,message:"请输入通行能力",trigger:"blur"}]},oe=l({totalRoads:0,totalVehicles:0,totalAccidents:0,totalSignals:0}),ce=a([{id:1,name:"长安街",type:"road",location:"北京市中心",length:3.8,capacity:"双向八车道",status:"normal",buildDate:"1950-01-01",lastMaintenance:"2024-01-15",description:"北京市最重要的东西向主干道，连接天安门广场",createTime:"2020-01-01 10:00:00"},{id:2,name:"二环路",type:"road",location:"北京市二环",length:32.7,capacity:"双向六车道",status:"normal",buildDate:"1980-01-01",lastMaintenance:"2024-02-01",description:"北京市重要的环形主干道",createTime:"2020-01-01 10:00:00"},{id:3,name:"长安街信号灯系统",type:"signal",location:"长安街沿线",length:0,capacity:"智能控制",status:"normal",buildDate:"2010-01-01",lastMaintenance:"2024-01-20",description:"智能交通信号灯系统，实现绿波带控制",createTime:"2020-01-01 10:00:00"},{id:4,name:"西直门立交桥",type:"bridge",location:"西直门地区",length:1.2,capacity:"双向四车道",status:"maintenance",buildDate:"1995-01-01",lastMaintenance:"2024-03-01",description:"重要的交通枢纽立交桥",createTime:"2020-01-01 10:00:00"},{id:5,name:"王府井停车场",type:"parking",location:"王府井商业区",length:0,capacity:"500个车位",status:"normal",buildDate:"2005-01-01",lastMaintenance:"2024-01-10",description:"王府井商业区地下停车场",createTime:"2020-01-01 10:00:00"}]),re=t((()=>ue.id?"编辑交通设施":"添加交通设施")),pe=e=>({road:"道路",bridge:"桥梁",tunnel:"隧道",signal:"信号灯",parking:"停车场"}[e]||"未知"),fe=e=>({road:"primary",bridge:"success",tunnel:"warning",signal:"info",parking:"danger"}[e]||""),me=e=>({normal:"正常",maintenance:"维护中",fault:"故障",construction:"建设中"}[e]||"未知"),ve=e=>({normal:"success",maintenance:"warning",fault:"danger",construction:"info"}[e]||""),ge=e=>e.toLocaleString(),_e=()=>{ue.id=null,ae.value=!0},be=async()=>{if(te.value)try{if(await te.value.validate(),ee.value=!0,await new Promise((e=>setTimeout(e,1e3))),ue.id){const e=ce.value.findIndex((e=>e.id===ue.id));e>-1&&(ce.value[e]={...ue}),D.success("编辑成功")}else{const e={...ue,id:Date.now(),createTime:(new Date).toLocaleString()};ce.value.unshift(e),D.success("添加成功")}Ue(),ae.value=!1,ye()}catch(e){}finally{ee.value=!1}},ye=()=>{te.value&&te.value.resetFields(),Object.assign(ue,{id:null,name:"",type:"",location:"",length:0,capacity:"",status:"normal",buildDate:"",lastMaintenance:"",description:""})},he=()=>{ie.currentPage=1},Ve=()=>{Object.assign(de,{name:"",type:"",status:""}),he()},we=e=>{ie.pageSize=e},ke=e=>{ie.currentPage=e},Ce=()=>{D.success("交通设施数据导出成功")},Ue=()=>{oe.totalRoads=ce.value.filter((e=>"road"===e.type)).length,oe.totalVehicles=15e5,oe.totalAccidents=25,oe.totalSignals=ce.value.filter((e=>"signal"===e.type)).length};return n((()=>{Ue(),ie.total=ce.value.length})),(e,a)=>{const l=d("el-icon"),t=d("el-button"),n=d("el-card"),xe=d("el-col"),De=d("el-row"),ze=d("el-input"),Me=d("el-option"),Se=d("el-select"),Te=d("el-table-column"),Pe=d("el-tag"),je=d("el-table"),qe=d("el-pagination"),Ie=d("el-form-item"),Oe=d("el-input-number"),Re=d("el-date-picker"),Ae=d("el-form"),Be=d("el-dialog"),Le=d("el-descriptions-item"),Fe=d("el-descriptions"),Ee=i("loading");return u(),s("div",z,[o("div",M,[a[19]||(a[19]=o("h2",null,"交通管理系统",-1)),o("div",S,[c(t,{type:"success",onClick:Ce},{default:r((()=>[c(l,null,{default:r((()=>[c(p(f))])),_:1}),a[17]||(a[17]=m(" 导出数据 "))])),_:1,__:[17]}),c(t,{type:"primary",onClick:_e},{default:r((()=>[c(l,null,{default:r((()=>[c(p(v))])),_:1}),a[18]||(a[18]=m(" 添加设施 "))])),_:1,__:[18]})])]),o("div",T,[c(De,{gutter:20},{default:r((()=>[c(xe,{span:6},{default:r((()=>[c(n,{class:"overview-card"},{default:r((()=>[o("div",P,[o("div",j,[c(l,null,{default:r((()=>[c(p(g))])),_:1})]),o("div",q,[a[20]||(a[20]=o("div",{class:"card-title"},"道路总数",-1)),o("div",I,_(oe.totalRoads),1)])])])),_:1})])),_:1}),c(xe,{span:6},{default:r((()=>[c(n,{class:"overview-card"},{default:r((()=>[o("div",O,[o("div",R,[c(l,null,{default:r((()=>[c(p(b))])),_:1})]),o("div",A,[a[21]||(a[21]=o("div",{class:"card-title"},"车辆流量",-1)),o("div",B,_(ge(oe.totalVehicles)),1)])])])),_:1})])),_:1}),c(xe,{span:6},{default:r((()=>[c(n,{class:"overview-card"},{default:r((()=>[o("div",L,[o("div",F,[c(l,null,{default:r((()=>[c(p(y))])),_:1})]),o("div",E,[a[22]||(a[22]=o("div",{class:"card-title"},"事故数量",-1)),o("div",J,_(oe.totalAccidents),1)])])])),_:1})])),_:1}),c(xe,{span:6},{default:r((()=>[c(n,{class:"overview-card"},{default:r((()=>[o("div",K,[o("div",$,[c(l,null,{default:r((()=>[c(p(h))])),_:1})]),o("div",G,[a[23]||(a[23]=o("div",{class:"card-title"},"信号灯",-1)),o("div",H,_(oe.totalSignals),1)])])])),_:1})])),_:1})])),_:1})]),o("div",N,[c(De,{gutter:20},{default:r((()=>[c(xe,{span:6},{default:r((()=>[c(ze,{modelValue:de.name,"onUpdate:modelValue":a[0]||(a[0]=e=>de.name=e),placeholder:"设施名称",clearable:"",onClear:he,onKeyup:V(he,["enter"])},{prefix:r((()=>[c(l,null,{default:r((()=>[c(p(w))])),_:1})])),_:1},8,["modelValue"])])),_:1}),c(xe,{span:6},{default:r((()=>[c(Se,{modelValue:de.type,"onUpdate:modelValue":a[1]||(a[1]=e=>de.type=e),placeholder:"设施类型",clearable:"",onChange:he},{default:r((()=>[c(Me,{label:"道路",value:"road"}),c(Me,{label:"桥梁",value:"bridge"}),c(Me,{label:"隧道",value:"tunnel"}),c(Me,{label:"信号灯",value:"signal"}),c(Me,{label:"停车场",value:"parking"})])),_:1},8,["modelValue"])])),_:1}),c(xe,{span:6},{default:r((()=>[c(Se,{modelValue:de.status,"onUpdate:modelValue":a[2]||(a[2]=e=>de.status=e),placeholder:"设施状态",clearable:"",onChange:he},{default:r((()=>[c(Me,{label:"正常",value:"normal"}),c(Me,{label:"维护中",value:"maintenance"}),c(Me,{label:"故障",value:"fault"}),c(Me,{label:"建设中",value:"construction"})])),_:1},8,["modelValue"])])),_:1}),c(xe,{span:6},{default:r((()=>[c(t,{type:"primary",onClick:he},{default:r((()=>[c(l,null,{default:r((()=>[c(p(w))])),_:1}),a[24]||(a[24]=m(" 搜索 "))])),_:1,__:[24]}),c(t,{onClick:Ve},{default:r((()=>a[25]||(a[25]=[m("重置")]))),_:1,__:[25]})])),_:1})])),_:1})]),o("div",Q,[k((u(),C(je,{data:ce.value,stripe:""},{default:r((()=>[c(Te,{prop:"id",label:"ID",width:"80"}),c(Te,{prop:"name",label:"设施名称"}),c(Te,{prop:"type",label:"设施类型",width:"100"},{default:r((e=>[c(Pe,{type:fe(e.row.type)},{default:r((()=>[m(_(pe(e.row.type)),1)])),_:2},1032,["type"])])),_:1}),c(Te,{prop:"location",label:"位置"}),c(Te,{prop:"length",label:"长度(km)",width:"100"}),c(Te,{prop:"capacity",label:"通行能力",width:"120"}),c(Te,{prop:"status",label:"状态",width:"100"},{default:r((e=>[c(Pe,{type:ve(e.row.status)},{default:r((()=>[m(_(me(e.row.status)),1)])),_:2},1032,["type"])])),_:1}),c(Te,{prop:"lastMaintenance",label:"最后维护",width:"120"}),c(Te,{label:"操作",width:"200",fixed:"right"},{default:r((e=>[c(t,{size:"small",onClick:a=>(e=>{ne.value=e,le.value=!0})(e.row)},{default:r((()=>a[26]||(a[26]=[m("查看")]))),_:2,__:[26]},1032,["onClick"]),c(t,{size:"small",type:"primary",onClick:a=>(e=>{Object.assign(ue,e),ae.value=!0})(e.row)},{default:r((()=>a[27]||(a[27]=[m("编辑")]))),_:2,__:[27]},1032,["onClick"]),c(t,{size:"small",type:"danger",onClick:a=>(async e=>{try{await x.confirm(`确定要删除交通设施"${e.name}"吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const a=ce.value.findIndex((a=>a.id===e.id));a>-1&&(ce.value.splice(a,1),Ue(),D.success("删除成功"))}catch{}})(e.row)},{default:r((()=>a[28]||(a[28]=[m("删除")]))),_:2,__:[28]},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[Ee,Z.value]]),o("div",W,[c(qe,{"current-page":ie.currentPage,"onUpdate:currentPage":a[3]||(a[3]=e=>ie.currentPage=e),"page-size":ie.pageSize,"onUpdate:pageSize":a[4]||(a[4]=e=>ie.pageSize=e),"page-sizes":[10,20,50,100],total:ie.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:we,onCurrentChange:ke},null,8,["current-page","page-size","total"])])]),c(Be,{modelValue:ae.value,"onUpdate:modelValue":a[15]||(a[15]=e=>ae.value=e),title:re.value,width:"700px",onClose:ye},{footer:r((()=>[o("div",X,[c(t,{onClick:a[14]||(a[14]=e=>ae.value=!1)},{default:r((()=>a[29]||(a[29]=[m("取消")]))),_:1,__:[29]}),c(t,{type:"primary",onClick:be,loading:ee.value},{default:r((()=>a[30]||(a[30]=[m("确定")]))),_:1,__:[30]},8,["loading"])])])),default:r((()=>[c(Ae,{model:ue,rules:se,ref_key:"trafficFormRef",ref:te,"label-width":"120px"},{default:r((()=>[c(De,{gutter:20},{default:r((()=>[c(xe,{span:12},{default:r((()=>[c(Ie,{label:"设施名称",prop:"name"},{default:r((()=>[c(ze,{modelValue:ue.name,"onUpdate:modelValue":a[5]||(a[5]=e=>ue.name=e),placeholder:"请输入设施名称"},null,8,["modelValue"])])),_:1})])),_:1}),c(xe,{span:12},{default:r((()=>[c(Ie,{label:"设施类型",prop:"type"},{default:r((()=>[c(Se,{modelValue:ue.type,"onUpdate:modelValue":a[6]||(a[6]=e=>ue.type=e),placeholder:"请选择设施类型",style:{width:"100%"}},{default:r((()=>[c(Me,{label:"道路",value:"road"}),c(Me,{label:"桥梁",value:"bridge"}),c(Me,{label:"隧道",value:"tunnel"}),c(Me,{label:"信号灯",value:"signal"}),c(Me,{label:"停车场",value:"parking"})])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),c(De,{gutter:20},{default:r((()=>[c(xe,{span:12},{default:r((()=>[c(Ie,{label:"位置",prop:"location"},{default:r((()=>[c(ze,{modelValue:ue.location,"onUpdate:modelValue":a[7]||(a[7]=e=>ue.location=e),placeholder:"请输入设施位置"},null,8,["modelValue"])])),_:1})])),_:1}),c(xe,{span:12},{default:r((()=>[c(Ie,{label:"长度(km)",prop:"length"},{default:r((()=>[c(Oe,{modelValue:ue.length,"onUpdate:modelValue":a[8]||(a[8]=e=>ue.length=e),min:0,precision:2,style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),c(De,{gutter:20},{default:r((()=>[c(xe,{span:12},{default:r((()=>[c(Ie,{label:"通行能力",prop:"capacity"},{default:r((()=>[c(ze,{modelValue:ue.capacity,"onUpdate:modelValue":a[9]||(a[9]=e=>ue.capacity=e),placeholder:"如：双向四车道"},null,8,["modelValue"])])),_:1})])),_:1}),c(xe,{span:12},{default:r((()=>[c(Ie,{label:"设施状态",prop:"status"},{default:r((()=>[c(Se,{modelValue:ue.status,"onUpdate:modelValue":a[10]||(a[10]=e=>ue.status=e),placeholder:"请选择设施状态",style:{width:"100%"}},{default:r((()=>[c(Me,{label:"正常",value:"normal"}),c(Me,{label:"维护中",value:"maintenance"}),c(Me,{label:"故障",value:"fault"}),c(Me,{label:"建设中",value:"construction"})])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),c(De,{gutter:20},{default:r((()=>[c(xe,{span:12},{default:r((()=>[c(Ie,{label:"建设时间",prop:"buildDate"},{default:r((()=>[c(Re,{modelValue:ue.buildDate,"onUpdate:modelValue":a[11]||(a[11]=e=>ue.buildDate=e),type:"date",placeholder:"选择建设时间",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),c(xe,{span:12},{default:r((()=>[c(Ie,{label:"最后维护",prop:"lastMaintenance"},{default:r((()=>[c(Re,{modelValue:ue.lastMaintenance,"onUpdate:modelValue":a[12]||(a[12]=e=>ue.lastMaintenance=e),type:"date",placeholder:"选择最后维护时间",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),c(Ie,{label:"设施描述",prop:"description"},{default:r((()=>[c(ze,{modelValue:ue.description,"onUpdate:modelValue":a[13]||(a[13]=e=>ue.description=e),type:"textarea",rows:3,placeholder:"请输入设施描述"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","title"]),c(Be,{modelValue:le.value,"onUpdate:modelValue":a[16]||(a[16]=e=>le.value=e),title:"交通设施详情",width:"800px"},{default:r((()=>[ne.value?(u(),s("div",Y,[c(Fe,{column:2,border:""},{default:r((()=>[c(Le,{label:"设施名称"},{default:r((()=>[m(_(ne.value.name),1)])),_:1}),c(Le,{label:"设施类型"},{default:r((()=>[c(Pe,{type:fe(ne.value.type)},{default:r((()=>[m(_(pe(ne.value.type)),1)])),_:1},8,["type"])])),_:1}),c(Le,{label:"位置"},{default:r((()=>[m(_(ne.value.location),1)])),_:1}),c(Le,{label:"长度"},{default:r((()=>[m(_(ne.value.length)+" km",1)])),_:1}),c(Le,{label:"通行能力"},{default:r((()=>[m(_(ne.value.capacity),1)])),_:1}),c(Le,{label:"设施状态"},{default:r((()=>[c(Pe,{type:ve(ne.value.status)},{default:r((()=>[m(_(me(ne.value.status)),1)])),_:1},8,["type"])])),_:1}),c(Le,{label:"建设时间"},{default:r((()=>[m(_(ne.value.buildDate),1)])),_:1}),c(Le,{label:"最后维护"},{default:r((()=>[m(_(ne.value.lastMaintenance),1)])),_:1}),c(Le,{label:"设施描述",span:2},{default:r((()=>[m(_(ne.value.description||"暂无描述"),1)])),_:1})])),_:1})])):U("",!0)])),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-6fb2a1f1"]]);export{Z as default};
