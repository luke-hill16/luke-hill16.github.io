import{defineComponent as e,ref as l,reactive as a,resolveComponent as t,openBlock as n,createElementBlock as u,Fragment as s,createVNode as d,withCtx as i,createTextVNode as o,unref as r,createElementVNode as m,withDirectives as p,vShow as _,toDisplayString as c,isRef as f,renderList as g,normalizeClass as v,withKeys as w,nextTick as h}from"vue";import{u as y,a as x,h as b,c as k,b as V,d as C,m as D,f as z,t as U,e as j,g as L,i as I,j as S,k as T,l as $,s as q,n as A,o as N,p as O,q as E,r as F,v as H,w as K,x as M,y as R,z as B}from"./index-BOpLbFaH.js";import{h as G}from"./http-Dy8u1s8a.js";import{ElMessage as J}from"element-plus";/* empty css                                                                    */import{_ as P}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./axios-DjXdQO6G.js";const Q=(e,l,a)=>G.post("/auth/resetpwd",{oldpwd:e,pwd1:l,pwd2:a}),W=e=>G.post("/chat/",{message:e}),X={class:"left-header"},Y={class:"right-header"},Z={class:"el-dropdown-link"},ee={style:{"margin-left":"10px"}},le={class:"dialog-footer"},ae={class:"chat-container"},te={class:"chat-sidebar"},ne={class:"sidebar-menu"},ue={class:"chat-main"},se={key:0,class:"message user-message"},de={class:"message-content"},ie={class:"message-text"},oe={class:"message-time"},re={class:"message-avatar"},me={key:1,class:"message ai-message"},pe={class:"message-avatar"},_e={class:"message-content"},ce={class:"message-text"},fe={class:"message-time"},ge={class:"chat-input-area"},ve={class:"input-container"},we={class:"input-actions"},he=e({name:"frame"}),ye=P(Object.assign(he,{setup(e){let G="140px",P=l(!1),he=a({oldpwd:"",pwd1:"",pwd2:""}),ye=l(),xe=a({oldpwd:[{required:!0,message:"旧密码",trigger:"blur"},{min:6,max:20,message:"Length should be 6 to 20",trigger:"blur"}],pwd1:[{required:!0,message:"新密码",trigger:"blur"},{min:6,max:20,message:"Length should be 6 to 20",trigger:"blur"}],pwd2:[{required:!0,message:"确认密码",trigger:"blur"},{min:6,max:20,message:"Length should be 6 to 20",trigger:"blur"}]});const be=y(),ke=x(),Ve=l(!1),Ce=l(""),De=l(!1),ze=l(null),Ue=l(""),je=a([{type:"ai",content:"您好！我是AI智能助手，有什么可以帮助您的吗？",timestamp:new Date}]),Le=()=>{Ve.value=!0,h((()=>{Te()}))},Ie=()=>{Ve.value=!1,Ce.value=""},Se=async()=>{if(!Ce.value.trim()||De.value)return;const e=Ce.value.trim();je.push({type:"user",content:e,timestamp:new Date}),Ce.value="",De.value=!0,await h(),Te();try{const l=await W(e);je.push({type:"ai",content:l.reply,timestamp:new Date})}catch(l){je.push({type:"ai",content:"抱歉，AI服务暂时不可用，请稍后再试。",timestamp:new Date})}finally{De.value=!1,h((()=>{Te()}))}},Te=()=>{ze.value&&(ze.value.scrollTop=ze.value.scrollHeight)},$e=e=>{const l=new Date(e),a=new Date,t=a-l;return t<6e4?"刚刚":t<36e5?`${Math.floor(t/6e4)}分钟前`:l.toDateString()===a.toDateString()?l.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}):l.toLocaleDateString("zh-CN")+" "+l.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"})},qe=async e=>{const l={policy:"政策库",enterprise:"企业库",regulation:"法规库",standard:"标准库",case:"案例库",help:"帮助中心"}[e]||"未知功能",a=`我想查看${l}`;je.push({type:"user",content:a,timestamp:new Date}),h((()=>{Te()}));try{const e=await W(a);je.push({type:"ai",content:e.reply,timestamp:new Date})}catch(t){je.push({type:"ai",content:`好的，我来为您打开${l}。这里是${l}的相关信息，您可以根据需要进行查询和浏览。`,timestamp:new Date})}h((()=>{Te()}))},Ae=()=>{be.clearUserToken(),ke.push({name:"login"})},Ne=()=>{he.oldpwd="",he.pwd1="",he.pwd2="",P.value=!0},Oe=()=>{ye.value.validate((async(e,l)=>{if(e)try{await Q(he.oldpwd,he.pwd1,he.pwd2),J.success("密码修改成功"),P.value=!1}catch(a){J.error(a)}else J.info("字段校验失败!")})),P.value=!1},Ee=(e,l)=>{},Fe=(e,l)=>{},He=l(!1),Ke=()=>{He.value=!He.value};return(e,l)=>{const a=t("router-link"),h=t("el-icon"),y=t("el-menu-item"),x=t("el-sub-menu"),J=t("el-menu"),Q=t("el-aside"),W=t("el-button"),ke=t("el-avatar"),Te=t("el-dropdown-item"),Me=t("el-dropdown-menu"),Re=t("el-dropdown"),Be=t("el-header"),Ge=t("RouterView"),Je=t("el-main"),Pe=t("el-container"),Qe=t("el-input"),We=t("el-form-item"),Xe=t("el-form"),Ye=t("el-dialog");return n(),u(s,null,[d(Pe,{class:"container"},{default:i((()=>[d(Q,{class:"aside",width:"250px"},{default:i((()=>[d(a,{to:"/",class:"brand"},{default:i((()=>l[13]||(l[13]=[o("益客管理系统")]))),_:1,__:[13]}),d(J,{router:!0,"default-active":e.$route.name,class:"el-menu-vertical-demo",onOpen:Ee,onClose:Fe},{default:i((()=>[d(y,{index:"home",route:{name:"home"}},{title:i((()=>[d(h,null,{default:i((()=>[d(r(b))])),_:1}),l[14]||(l[14]=m("span",null,"首页",-1))])),_:1}),d(x,{index:"2"},{title:i((()=>[d(h,null,{default:i((()=>[d(r(k))])),_:1}),l[15]||(l[15]=m("span",null,"考勤管理",-1))])),default:i((()=>[d(y,{index:"myabsent",route:{name:"myabsent"}},{default:i((()=>[d(h,null,{default:i((()=>[d(r(V))])),_:1}),l[16]||(l[16]=o("个人管理"))])),_:1,__:[16]}),d(y,{index:"subabsent",route:{name:"subabsent"}},{default:i((()=>[d(h,null,{default:i((()=>[d(r(C))])),_:1}),l[17]||(l[17]=o("下属考勤"))])),_:1,__:[17]}),d(y,{index:"expense-rd",route:{name:"expense-rd"}},{default:i((()=>[d(h,null,{default:i((()=>[d(r(D))])),_:1}),l[18]||(l[18]=o("研发费用管理"))])),_:1,__:[18]})])),_:1}),d(x,{index:"3"},{title:i((()=>[d(h,null,{default:i((()=>[d(r(z))])),_:1}),l[19]||(l[19]=m("span",null,"通知管理",-1))])),default:i((()=>[d(y,{index:"notification",route:{name:"notification"}},{default:i((()=>[d(h,null,{default:i((()=>[d(r(U))])),_:1}),l[20]||(l[20]=o("发布通的知"))])),_:1,__:[20]}),d(y,{index:"video-monitor",route:{name:"video-monitor"}},{default:i((()=>[d(h,null,{default:i((()=>[d(r(j))])),_:1}),l[21]||(l[21]=o("通知列的表"))])),_:1,__:[21]}),d(y,{index:"expense-rd2",route:{name:"expense-rd2"}},{default:i((()=>[d(h,null,{default:i((()=>[d(r(D))])),_:1}),l[22]||(l[22]=o("研发费用管理2"))])),_:1,__:[22]})])),_:1}),d(x,{index:"5"},{title:i((()=>[d(h,null,{default:i((()=>[d(r(L))])),_:1}),l[23]||(l[23]=m("span",null,"员工管理",-1))])),default:i((()=>[d(y,{index:"exam",route:{name:"exam"}},{default:i((()=>[d(h,null,{default:i((()=>[d(r(I))])),_:1}),l[24]||(l[24]=o("员工通的知"))])),_:1,__:[24]}),d(y,{index:"employee",route:{name:"employee"}},{default:i((()=>[d(h,null,{default:i((()=>[d(r(S))])),_:1}),l[25]||(l[25]=o("员工列的表"))])),_:1,__:[25]}),d(y,{index:"filemanage",route:{name:"filemanage"}},{default:i((()=>[d(h,null,{default:i((()=>[d(r(z))])),_:1}),l[26]||(l[26]=o("员工管的理"))])),_:1,__:[26]})])),_:1}),d(x,{index:"6"},{title:i((()=>[d(h,null,{default:i((()=>[d(r(L))])),_:1}),l[27]||(l[27]=m("span",null,"智慧农业",-1))])),default:i((()=>[d(y,{index:"agriculture",route:{name:"agriculture"}},{default:i((()=>[d(h,null,{default:i((()=>[d(r(T))])),_:1}),l[28]||(l[28]=o("农业管理"))])),_:1,__:[28]}),d(y,{index:"building",route:{name:"building"}},{default:i((()=>[d(h,null,{default:i((()=>[d(r(T))])),_:1}),l[29]||(l[29]=o("建筑管理"))])),_:1,__:[29]}),d(y,{index:"language",route:{name:"language"}},{default:i((()=>[d(h,null,{default:i((()=>[d(r(T))])),_:1}),l[30]||(l[30]=o("语言管理"))])),_:1,__:[30]}),d(y,{index:"district",route:{name:"district"}},{default:i((()=>[d(h,null,{default:i((()=>[d(r($))])),_:1}),l[31]||(l[31]=o("区县管理"))])),_:1,__:[31]}),d(y,{index:"traffic",route:{name:"traffic"}},{default:i((()=>[d(h,null,{default:i((()=>[d(r($))])),_:1}),l[32]||(l[32]=o("交通管理"))])),_:1,__:[32]})])),_:1}),d(x,{index:"16"},{title:i((()=>[d(h,null,{default:i((()=>[d(r(L))])),_:1}),l[33]||(l[33]=m("span",null,"智慧工信",-1))])),default:i((()=>[d(y,{index:"industry",route:{name:"industry"}},{default:i((()=>[d(h,null,{default:i((()=>[d(r(T))])),_:1}),l[34]||(l[34]=o("工信管理"))])),_:1,__:[34]}),d(y,{index:"education",route:{name:"education"}},{default:i((()=>[d(h,null,{default:i((()=>[d(r(q))])),_:1}),l[35]||(l[35]=o("教育管理"))])),_:1,__:[35]}),d(y,{index:"enterprise",route:{name:"enterprise"}},{default:i((()=>[d(h,null,{default:i((()=>[d(r(A))])),_:1}),l[36]||(l[36]=o("企业管理"))])),_:1,__:[36]})])),_:1})])),_:1},8,["default-active"])])),_:1}),d(Pe,null,{default:i((()=>[d(Be,{class:"header"},{default:i((()=>[m("div",X,[d(W,null,{default:i((()=>[d(h,null,{default:i((()=>[d(r(N))])),_:1})])),_:1})]),p(d(W,{icon:r(N),onClick:Ke},null,8,["icon"]),[[_,He.value]]),m("div",Y,[d(W,{class:"ai-button",type:"primary",size:"small",onClick:Le,style:{"margin-right":"15px"}},{default:i((()=>[d(h,null,{default:i((()=>[d(r(O))])),_:1}),l[37]||(l[37]=o(" AI助手 "))])),_:1,__:[37]}),d(Re,null,{dropdown:i((()=>[d(Me,null,{default:i((()=>[d(Te,{onClick:Ne},{default:i((()=>l[38]||(l[38]=[o("修改密码")]))),_:1,__:[38]}),d(Te,null,{default:i((()=>l[39]||(l[39]=[o("个人中心")]))),_:1,__:[39]}),d(Te,{divided:"",onClick:Ae},{default:i((()=>l[40]||(l[40]=[o("退出登录")]))),_:1,__:[40]})])),_:1})])),default:i((()=>[m("span",Z,[d(ke,{size:30,icon:"UserFilled"}),m("span",ee,"("+c(r(be).user.department.name)+")"+c(r(be).user.realname),1),d(h,{class:"el-icon--right"},{default:i((()=>[d(r(E))])),_:1})])])),_:1})])])),_:1}),d(Je,{class:"main"},{default:i((()=>[d(Ge)])),_:1})])),_:1})])),_:1}),d(Ye,{modelValue:r(P),"onUpdate:modelValue":l[4]||(l[4]=e=>f(P)?P.value=e:P=e),title:"修改密码",width:"500"},{footer:i((()=>[m("div",le,[d(W,{onClick:l[3]||(l[3]=e=>f(P)?P.value=!1:P=!1)},{default:i((()=>l[41]||(l[41]=[o("取消")]))),_:1,__:[41]}),d(W,{type:"primary",onClick:Oe},{default:i((()=>l[42]||(l[42]=[o(" 确认 ")]))),_:1,__:[42]})])])),default:i((()=>[d(Xe,{model:r(he),rules:r(xe),ref_key:"formTag",ref:ye},{default:i((()=>[d(We,{label:"旧密码","label-width":r(G),prop:"oldpwd"},{default:i((()=>[d(Qe,{modelValue:r(he).oldpwd,"onUpdate:modelValue":l[0]||(l[0]=e=>r(he).oldpwd=e),autocomplete:"off",type:"password"},null,8,["modelValue"])])),_:1},8,["label-width"]),d(We,{label:"新密码","label-width":r(G),prop:"pwd1"},{default:i((()=>[d(Qe,{modelValue:r(he).pwd1,"onUpdate:modelValue":l[1]||(l[1]=e=>r(he).pwd1=e),autocomplete:"off",type:"password"},null,8,["modelValue"])])),_:1},8,["label-width"]),d(We,{label:"确认密码","label-width":r(G),prop:"pwd2"},{default:i((()=>[d(Qe,{modelValue:r(he).pwd2,"onUpdate:modelValue":l[2]||(l[2]=e=>r(he).pwd2=e),autocomplete:"off",type:"password"},null,8,["modelValue"])])),_:1},8,["label-width"])])),_:1},8,["model","rules"])])),_:1},8,["modelValue"]),d(Ye,{modelValue:Ve.value,"onUpdate:modelValue":l[12]||(l[12]=e=>Ve.value=e),title:"AI智能助手",width:"800px","before-close":Ie,class:"ai-chat-dialog",draggable:""},{default:i((()=>[m("div",ae,[m("div",te,[m("div",ne,[m("div",{class:"menu-item",onClick:l[5]||(l[5]=e=>qe("policy"))},[d(h,null,{default:i((()=>[d(r(F))])),_:1}),l[43]||(l[43]=m("span",null,"政策库",-1))]),m("div",{class:"menu-item",onClick:l[6]||(l[6]=e=>qe("enterprise"))},[d(h,null,{default:i((()=>[d(r(H))])),_:1}),l[44]||(l[44]=m("span",null,"企业库",-1))]),m("div",{class:"menu-item",onClick:l[7]||(l[7]=e=>qe("regulation"))},[d(h,null,{default:i((()=>[d(r(K))])),_:1}),l[45]||(l[45]=m("span",null,"法规库",-1))]),m("div",{class:"menu-item",onClick:l[8]||(l[8]=e=>qe("standard"))},[d(h,null,{default:i((()=>[d(r(M))])),_:1}),l[46]||(l[46]=m("span",null,"标准库",-1))]),m("div",{class:"menu-item",onClick:l[9]||(l[9]=e=>qe("case"))},[d(h,null,{default:i((()=>[d(r(z))])),_:1}),l[47]||(l[47]=m("span",null,"案例库",-1))]),m("div",{class:"menu-item",onClick:l[10]||(l[10]=e=>qe("help"))},[d(h,null,{default:i((()=>[d(r(R))])),_:1}),l[48]||(l[48]=m("span",null,"帮助中心",-1))])])]),m("div",ue,[m("div",{class:"chat-messages",ref_key:"messagesContainer",ref:ze},[(n(!0),u(s,null,g(je,((e,l)=>(n(),u("div",{key:l,class:v(["message-item",e.type])},["user"===e.type?(n(),u("div",se,[m("div",de,[m("div",ie,c(e.content),1),m("div",oe,c($e(e.timestamp)),1)]),m("div",re,[d(ke,{size:40,src:Ue.value},{default:i((()=>[d(h,null,{default:i((()=>[d(r(C))])),_:1})])),_:1},8,["src"])])])):(n(),u("div",me,[m("div",pe,[d(ke,{size:40,class:"ai-avatar"},{default:i((()=>[d(h,null,{default:i((()=>[d(r(B))])),_:1})])),_:1})]),m("div",_e,[m("div",ce,c(e.content),1),m("div",fe,c($e(e.timestamp)),1)])]))],2)))),128))],512),m("div",ge,[m("div",ve,[d(Qe,{modelValue:Ce.value,"onUpdate:modelValue":l[11]||(l[11]=e=>Ce.value=e),type:"textarea",rows:3,placeholder:"请输入您的问题...",onKeydown:w(Se,["enter"]),resize:"none"},null,8,["modelValue"]),m("div",we,[l[50]||(l[50]=m("span",{class:"input-tip"},"Enter 发送",-1)),d(W,{type:"primary",onClick:Se,loading:De.value,disabled:!Ce.value.trim()},{default:i((()=>l[49]||(l[49]=[o(" 发送 ")]))),_:1,__:[49]},8,["loading","disabled"])])])])])])])),_:1},8,["modelValue"])],64)}}}),[["__scopeId","data-v-35e213e1"]]);export{ye as default};
