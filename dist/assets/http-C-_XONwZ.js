import{a as i}from"./axios-DWwaMX5J.js";import{u as n,r as c}from"./index-NiQ5wmz2.js";import{z as l}from"./element-plus-B_exy3hO.js";class p{constructor(){this.instance=i.create({baseURL:"192.168.1.48/api",timeout:6e4}),this.instance.interceptors.request.use(t=>{const s=n().token;return s&&(t.headers.Authorization="JWT "+s),t}),this.instance.interceptors.response.use(t=>t,t=>{var r;if(((r=t.response)==null?void 0:r.status)===403){const s=n();l.error("登录已过期，请重新登录"),s.clearUserToken(),c.push("/login")}return Promise.reject(t)})}post(t,r){return new Promise(async(s,a)=>{try{let e=await this.instance.post(t,r);console.log(e),s(e.data)}catch(e){console.log("请求出错:",e);let o=e.response&&e.response.data&&e.response.data.detail?e.response.data.detail:e.message||"未知错误";a(o)}})}get(t,r){return new Promise(async(s,a)=>{try{let e=await this.instance.get(t,r);s(e.data)}catch(e){console.log("请求出错:",e);let o=e.response&&e.response.data&&e.response.data.detail?e.response.data.detail:e.message||"未知错误";a(o)}})}}const g=new p;export{g as h};
