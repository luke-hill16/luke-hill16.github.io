import{I as fe,B as k,t as T,S as me,o as ve,a as s,v as ge,b as j,z as K,_ as d,R as e,q as l,f as w,C as _e,H as u,w as be,E as ye,k as r,P as he,T as Ve,$ as we,A as ke,Y as N,x as Ce,s as Ue,d as xe,l as $e,e as P}from"./index-f7x5kkv9.js";const ze={class:"traffic-container"},De={class:"page-header"},Me={class:"header-actions"},Se={class:"overview-section"},Te={class:"card-content"},Pe={class:"card-icon primary"},qe={class:"card-info"},Ie={class:"card-value"},Ae={class:"card-content"},je={class:"card-icon success"},Be={class:"card-info"},Re={class:"card-value"},Le={class:"card-content"},Oe={class:"card-icon warning"},Ee={class:"card-info"},He={class:"card-value"},We={class:"card-content"},Fe={class:"card-icon info"},Ke={class:"card-info"},Ne={class:"card-value"},Ye={class:"search-section"},Ge={class:"traffic-list"},Je={class:"pagination-container"},Qe={class:"dialog-footer"},Xe={key:0,class:"traffic-detail"},Ze={__name:"traffic",setup(el){const Y=k(!1),q=k(!1),C=k(!1),I=k(!1),$=k(),p=k(null),h=T({name:"",type:"",status:""}),m=T({currentPage:1,pageSize:10,total:0}),i=T({id:null,name:"",type:"",location:"",length:0,capacity:"",status:"normal",buildDate:"",lastMaintenance:"",description:""}),G={name:[{required:!0,message:"请输入设施名称",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"}],type:[{required:!0,message:"请选择设施类型",trigger:"change"}],location:[{required:!0,message:"请输入设施位置",trigger:"blur"}],length:[{required:!0,message:"请输入设施长度",trigger:"blur"}],capacity:[{required:!0,message:"请输入通行能力",trigger:"blur"}]},V=T({totalRoads:0,totalVehicles:0,totalAccidents:0,totalSignals:0}),v=k([{id:1,name:"长安街",type:"road",location:"北京市中心",length:3.8,capacity:"双向八车道",status:"normal",buildDate:"1950-01-01",lastMaintenance:"2024-01-15",description:"北京市最重要的东西向主干道，连接天安门广场",createTime:"2020-01-01 10:00:00"},{id:2,name:"二环路",type:"road",location:"北京市二环",length:32.7,capacity:"双向六车道",status:"normal",buildDate:"1980-01-01",lastMaintenance:"2024-02-01",description:"北京市重要的环形主干道",createTime:"2020-01-01 10:00:00"},{id:3,name:"长安街信号灯系统",type:"signal",location:"长安街沿线",length:0,capacity:"智能控制",status:"normal",buildDate:"2010-01-01",lastMaintenance:"2024-01-20",description:"智能交通信号灯系统，实现绿波带控制",createTime:"2020-01-01 10:00:00"},{id:4,name:"西直门立交桥",type:"bridge",location:"西直门地区",length:1.2,capacity:"双向四车道",status:"maintenance",buildDate:"1995-01-01",lastMaintenance:"2024-03-01",description:"重要的交通枢纽立交桥",createTime:"2020-01-01 10:00:00"},{id:5,name:"王府井停车场",type:"parking",location:"王府井商业区",length:0,capacity:"500个车位",status:"normal",buildDate:"2005-01-01",lastMaintenance:"2024-01-10",description:"王府井商业区地下停车场",createTime:"2020-01-01 10:00:00"}]),J=me(()=>i.id?"编辑交通设施":"添加交通设施"),B=n=>({road:"道路",bridge:"桥梁",tunnel:"隧道",signal:"信号灯",parking:"停车场"})[n]||"未知",R=n=>({road:"primary",bridge:"success",tunnel:"warning",signal:"info",parking:"danger"})[n]||"",L=n=>({normal:"正常",maintenance:"维护中",fault:"故障",construction:"建设中"})[n]||"未知",O=n=>({normal:"success",maintenance:"warning",fault:"danger",construction:"info"})[n]||"",Q=n=>n.toLocaleString(),X=()=>{i.id=null,C.value=!0},Z=n=>{Object.assign(i,n),C.value=!0},ee=n=>{p.value=n,I.value=!0},le=async n=>{try{await $e.confirm(`确定要删除交通设施"${n.name}"吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const a=v.value.findIndex(f=>f.id===n.id);a>-1&&(v.value.splice(a,1),A(),P.success("删除成功"))}catch{}},ae=async()=>{if($.value)try{if(await $.value.validate(),q.value=!0,await new Promise(n=>setTimeout(n,1e3)),i.id){const n=v.value.findIndex(a=>a.id===i.id);n>-1&&(v.value[n]={...i}),P.success("编辑成功")}else{const n={...i,id:Date.now(),createTime:new Date().toLocaleString()};v.value.unshift(n),P.success("添加成功")}A(),C.value=!1,E()}catch(n){console.error("表单验证失败:",n)}finally{q.value=!1}},E=()=>{$.value&&$.value.resetFields(),Object.assign(i,{id:null,name:"",type:"",location:"",length:0,capacity:"",status:"normal",buildDate:"",lastMaintenance:"",description:""})},U=()=>{m.currentPage=1,console.log("搜索条件:",h)},te=()=>{Object.assign(h,{name:"",type:"",status:""}),U()},ne=n=>{m.pageSize=n},de=n=>{m.currentPage=n},ie=()=>{P.success("交通设施数据导出成功")},A=()=>{V.totalRoads=v.value.filter(n=>n.type==="road").length,V.totalVehicles=15e5,V.totalAccidents=25,V.totalSignals=v.value.filter(n=>n.type==="signal").length};return ve(()=>{A(),m.total=v.value.length}),(n,a)=>{const f=s("el-icon"),g=s("el-button"),D=s("el-card"),c=s("el-col"),x=s("el-row"),z=s("el-input"),o=s("el-option"),M=s("el-select"),_=s("el-table-column"),S=s("el-tag"),ue=s("el-table"),se=s("el-pagination"),b=s("el-form-item"),oe=s("el-input-number"),H=s("el-date-picker"),ce=s("el-form"),W=s("el-dialog"),y=s("el-descriptions-item"),re=s("el-descriptions"),pe=ge("loading");return j(),K("div",ze,[d("div",De,[a[19]||(a[19]=d("h2",null,"交通管理系统",-1)),d("div",Me,[e(g,{type:"success",onClick:ie},{default:l(()=>[e(f,null,{default:l(()=>[e(w(_e))]),_:1}),a[17]||(a[17]=u(" 导出数据 "))]),_:1,__:[17]}),e(g,{type:"primary",onClick:X},{default:l(()=>[e(f,null,{default:l(()=>[e(w(be))]),_:1}),a[18]||(a[18]=u(" 添加设施 "))]),_:1,__:[18]})])]),d("div",Se,[e(x,{gutter:20},{default:l(()=>[e(c,{span:6},{default:l(()=>[e(D,{class:"overview-card"},{default:l(()=>[d("div",Te,[d("div",Pe,[e(f,null,{default:l(()=>[e(w(ye))]),_:1})]),d("div",qe,[a[20]||(a[20]=d("div",{class:"card-title"},"道路总数",-1)),d("div",Ie,r(V.totalRoads),1)])])]),_:1})]),_:1}),e(c,{span:6},{default:l(()=>[e(D,{class:"overview-card"},{default:l(()=>[d("div",Ae,[d("div",je,[e(f,null,{default:l(()=>[e(w(he))]),_:1})]),d("div",Be,[a[21]||(a[21]=d("div",{class:"card-title"},"车辆流量",-1)),d("div",Re,r(Q(V.totalVehicles)),1)])])]),_:1})]),_:1}),e(c,{span:6},{default:l(()=>[e(D,{class:"overview-card"},{default:l(()=>[d("div",Le,[d("div",Oe,[e(f,null,{default:l(()=>[e(w(Ve))]),_:1})]),d("div",Ee,[a[22]||(a[22]=d("div",{class:"card-title"},"事故数量",-1)),d("div",He,r(V.totalAccidents),1)])])]),_:1})]),_:1}),e(c,{span:6},{default:l(()=>[e(D,{class:"overview-card"},{default:l(()=>[d("div",We,[d("div",Fe,[e(f,null,{default:l(()=>[e(w(we))]),_:1})]),d("div",Ke,[a[23]||(a[23]=d("div",{class:"card-title"},"信号灯",-1)),d("div",Ne,r(V.totalSignals),1)])])]),_:1})]),_:1})]),_:1})]),d("div",Ye,[e(x,{gutter:20},{default:l(()=>[e(c,{span:6},{default:l(()=>[e(z,{modelValue:h.name,"onUpdate:modelValue":a[0]||(a[0]=t=>h.name=t),placeholder:"设施名称",clearable:"",onClear:U,onKeyup:ke(U,["enter"])},{prefix:l(()=>[e(f,null,{default:l(()=>[e(w(N))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(c,{span:6},{default:l(()=>[e(M,{modelValue:h.type,"onUpdate:modelValue":a[1]||(a[1]=t=>h.type=t),placeholder:"设施类型",clearable:"",onChange:U},{default:l(()=>[e(o,{label:"道路",value:"road"}),e(o,{label:"桥梁",value:"bridge"}),e(o,{label:"隧道",value:"tunnel"}),e(o,{label:"信号灯",value:"signal"}),e(o,{label:"停车场",value:"parking"})]),_:1},8,["modelValue"])]),_:1}),e(c,{span:6},{default:l(()=>[e(M,{modelValue:h.status,"onUpdate:modelValue":a[2]||(a[2]=t=>h.status=t),placeholder:"设施状态",clearable:"",onChange:U},{default:l(()=>[e(o,{label:"正常",value:"normal"}),e(o,{label:"维护中",value:"maintenance"}),e(o,{label:"故障",value:"fault"}),e(o,{label:"建设中",value:"construction"})]),_:1},8,["modelValue"])]),_:1}),e(c,{span:6},{default:l(()=>[e(g,{type:"primary",onClick:U},{default:l(()=>[e(f,null,{default:l(()=>[e(w(N))]),_:1}),a[24]||(a[24]=u(" 搜索 "))]),_:1,__:[24]}),e(g,{onClick:te},{default:l(()=>a[25]||(a[25]=[u("重置")])),_:1,__:[25]})]),_:1})]),_:1})]),d("div",Ge,[Ce((j(),Ue(ue,{data:v.value,stripe:""},{default:l(()=>[e(_,{prop:"id",label:"ID",width:"80"}),e(_,{prop:"name",label:"设施名称"}),e(_,{prop:"type",label:"设施类型",width:"100"},{default:l(t=>[e(S,{type:R(t.row.type)},{default:l(()=>[u(r(B(t.row.type)),1)]),_:2},1032,["type"])]),_:1}),e(_,{prop:"location",label:"位置"}),e(_,{prop:"length",label:"长度(km)",width:"100"}),e(_,{prop:"capacity",label:"通行能力",width:"120"}),e(_,{prop:"status",label:"状态",width:"100"},{default:l(t=>[e(S,{type:O(t.row.status)},{default:l(()=>[u(r(L(t.row.status)),1)]),_:2},1032,["type"])]),_:1}),e(_,{prop:"lastMaintenance",label:"最后维护",width:"120"}),e(_,{label:"操作",width:"200",fixed:"right"},{default:l(t=>[e(g,{size:"small",onClick:F=>ee(t.row)},{default:l(()=>a[26]||(a[26]=[u("查看")])),_:2,__:[26]},1032,["onClick"]),e(g,{size:"small",type:"primary",onClick:F=>Z(t.row)},{default:l(()=>a[27]||(a[27]=[u("编辑")])),_:2,__:[27]},1032,["onClick"]),e(g,{size:"small",type:"danger",onClick:F=>le(t.row)},{default:l(()=>a[28]||(a[28]=[u("删除")])),_:2,__:[28]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[pe,Y.value]]),d("div",Je,[e(se,{"current-page":m.currentPage,"onUpdate:currentPage":a[3]||(a[3]=t=>m.currentPage=t),"page-size":m.pageSize,"onUpdate:pageSize":a[4]||(a[4]=t=>m.pageSize=t),"page-sizes":[10,20,50,100],total:m.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:ne,onCurrentChange:de},null,8,["current-page","page-size","total"])])]),e(W,{modelValue:C.value,"onUpdate:modelValue":a[15]||(a[15]=t=>C.value=t),title:J.value,width:"700px",onClose:E},{footer:l(()=>[d("div",Qe,[e(g,{onClick:a[14]||(a[14]=t=>C.value=!1)},{default:l(()=>a[29]||(a[29]=[u("取消")])),_:1,__:[29]}),e(g,{type:"primary",onClick:ae,loading:q.value},{default:l(()=>a[30]||(a[30]=[u("确定")])),_:1,__:[30]},8,["loading"])])]),default:l(()=>[e(ce,{model:i,rules:G,ref_key:"trafficFormRef",ref:$,"label-width":"120px"},{default:l(()=>[e(x,{gutter:20},{default:l(()=>[e(c,{span:12},{default:l(()=>[e(b,{label:"设施名称",prop:"name"},{default:l(()=>[e(z,{modelValue:i.name,"onUpdate:modelValue":a[5]||(a[5]=t=>i.name=t),placeholder:"请输入设施名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{span:12},{default:l(()=>[e(b,{label:"设施类型",prop:"type"},{default:l(()=>[e(M,{modelValue:i.type,"onUpdate:modelValue":a[6]||(a[6]=t=>i.type=t),placeholder:"请选择设施类型",style:{width:"100%"}},{default:l(()=>[e(o,{label:"道路",value:"road"}),e(o,{label:"桥梁",value:"bridge"}),e(o,{label:"隧道",value:"tunnel"}),e(o,{label:"信号灯",value:"signal"}),e(o,{label:"停车场",value:"parking"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(x,{gutter:20},{default:l(()=>[e(c,{span:12},{default:l(()=>[e(b,{label:"位置",prop:"location"},{default:l(()=>[e(z,{modelValue:i.location,"onUpdate:modelValue":a[7]||(a[7]=t=>i.location=t),placeholder:"请输入设施位置"},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{span:12},{default:l(()=>[e(b,{label:"长度(km)",prop:"length"},{default:l(()=>[e(oe,{modelValue:i.length,"onUpdate:modelValue":a[8]||(a[8]=t=>i.length=t),min:0,precision:2,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(x,{gutter:20},{default:l(()=>[e(c,{span:12},{default:l(()=>[e(b,{label:"通行能力",prop:"capacity"},{default:l(()=>[e(z,{modelValue:i.capacity,"onUpdate:modelValue":a[9]||(a[9]=t=>i.capacity=t),placeholder:"如：双向四车道"},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{span:12},{default:l(()=>[e(b,{label:"设施状态",prop:"status"},{default:l(()=>[e(M,{modelValue:i.status,"onUpdate:modelValue":a[10]||(a[10]=t=>i.status=t),placeholder:"请选择设施状态",style:{width:"100%"}},{default:l(()=>[e(o,{label:"正常",value:"normal"}),e(o,{label:"维护中",value:"maintenance"}),e(o,{label:"故障",value:"fault"}),e(o,{label:"建设中",value:"construction"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(x,{gutter:20},{default:l(()=>[e(c,{span:12},{default:l(()=>[e(b,{label:"建设时间",prop:"buildDate"},{default:l(()=>[e(H,{modelValue:i.buildDate,"onUpdate:modelValue":a[11]||(a[11]=t=>i.buildDate=t),type:"date",placeholder:"选择建设时间",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{span:12},{default:l(()=>[e(b,{label:"最后维护",prop:"lastMaintenance"},{default:l(()=>[e(H,{modelValue:i.lastMaintenance,"onUpdate:modelValue":a[12]||(a[12]=t=>i.lastMaintenance=t),type:"date",placeholder:"选择最后维护时间",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(b,{label:"设施描述",prop:"description"},{default:l(()=>[e(z,{modelValue:i.description,"onUpdate:modelValue":a[13]||(a[13]=t=>i.description=t),type:"textarea",rows:3,placeholder:"请输入设施描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),e(W,{modelValue:I.value,"onUpdate:modelValue":a[16]||(a[16]=t=>I.value=t),title:"交通设施详情",width:"800px"},{default:l(()=>[p.value?(j(),K("div",Xe,[e(re,{column:2,border:""},{default:l(()=>[e(y,{label:"设施名称"},{default:l(()=>[u(r(p.value.name),1)]),_:1}),e(y,{label:"设施类型"},{default:l(()=>[e(S,{type:R(p.value.type)},{default:l(()=>[u(r(B(p.value.type)),1)]),_:1},8,["type"])]),_:1}),e(y,{label:"位置"},{default:l(()=>[u(r(p.value.location),1)]),_:1}),e(y,{label:"长度"},{default:l(()=>[u(r(p.value.length)+" km",1)]),_:1}),e(y,{label:"通行能力"},{default:l(()=>[u(r(p.value.capacity),1)]),_:1}),e(y,{label:"设施状态"},{default:l(()=>[e(S,{type:O(p.value.status)},{default:l(()=>[u(r(L(p.value.status)),1)]),_:1},8,["type"])]),_:1}),e(y,{label:"建设时间"},{default:l(()=>[u(r(p.value.buildDate),1)]),_:1}),e(y,{label:"最后维护"},{default:l(()=>[u(r(p.value.lastMaintenance),1)]),_:1}),e(y,{label:"设施描述",span:2},{default:l(()=>[u(r(p.value.description||"暂无描述"),1)]),_:1})]),_:1})])):xe("",!0)]),_:1},8,["modelValue"])])}}},al=fe(Ze,[["__scopeId","data-v-6fb2a1f1"]]);export{al as default};
