import{Y as _,_ as q,V as ye,p as C,C as e,c as l,D as s,u as H,T as P,f as xe,M as be,r as i,I as V,e as d,Z as ke,a as n,b as Ce,H as Ve,q as J,d as K,B as O,g as De,S as Ie,h as Z,U as ze,i as Ue,j as S,N as Q,k as Ae,t as Se,l as R,n as Te,m as $e,O as Le,o as x,s as Me,v as Ne,z as qe,w as Oe,x as Ze,$ as je,y as Ee,A as We,E as Ye,F as Be,G as D,J as j}from"./index-CrbR1nZg.js";import{g as E}from"./http-6I3P9ZYl-BRh3s9tC.js";import{s as Fe}from"./plugin-vue_export-helper-DlAUqK2U-lGy7RumW.js";import"./axios-DWwaMX5J-DXTQ3iZI.js";const Ge=(w,f)=>E.post("/auth/login",{email:w,password:f}),He=(w,f,c)=>E.post("/auth/resetpwd",{oldpwd:w,pwd1:f,pwd2:c}),Pe={login:Ge,resetPwd:He},Je=w=>E.post("/chat/",{message:w}),X={chatWithAI:Je},Ke={class:"left-header"},Qe={class:"right-header"},Re={class:"el-dropdown-link"},Xe={style:{"margin-left":"10px"}},ea={class:"dialog-footer"},aa={class:"chat-container"},la={class:"chat-sidebar"},sa={class:"sidebar-menu"},ta={class:"chat-main"},na={key:0,class:"message user-message"},ua={class:"message-content"},da={class:"message-text"},ia={class:"message-time"},oa={class:"message-avatar"},ra={key:1,class:"message ai-message"},ma={class:"message-avatar"},ca={class:"message-content"},pa={class:"message-text"},_a={class:"message-time"},fa={class:"chat-input-area"},ga={class:"input-container"},va={class:"input-actions"},wa=xe({name:"frame"}),ha=Object.assign(wa,{setup(w){let f="140px",c=_(!1),m=q({oldpwd:"",pwd1:"",pwd2:""}),W=_(),ee=q({oldpwd:[{required:!0,message:"旧密码",trigger:"blur"},{min:6,max:20,message:"Length should be 6 to 20",trigger:"blur"}],pwd1:[{required:!0,message:"新密码",trigger:"blur"},{min:6,max:20,message:"Length should be 6 to 20",trigger:"blur"}],pwd2:[{required:!0,message:"确认密码",trigger:"blur"},{min:6,max:20,message:"Length should be 6 to 20",trigger:"blur"}]});const T=ye(),ae=be(),I=_(!1),g=_(""),z=_(!1),U=_(null),le=_(""),v=q([{type:"ai",content:"您好！我是AI智能助手，有什么可以帮助您的吗？",timestamp:new Date}]),se=()=>{I.value=!0,D(()=>{b()})},te=()=>{I.value=!1,g.value=""},Y=async()=>{if(!g.value.trim()||z.value)return;const r=g.value.trim();v.push({type:"user",content:r,timestamp:new Date}),g.value="",z.value=!0,await D(),b();try{const a=await X.chatWithAI(r);v.push({type:"ai",content:a.reply,timestamp:new Date})}catch(a){console.error("AI接口调用失败:",a),v.push({type:"ai",content:"抱歉，AI服务暂时不可用，请稍后再试。",timestamp:new Date})}finally{z.value=!1,D(()=>{b()})}},b=()=>{U.value&&(U.value.scrollTop=U.value.scrollHeight)},B=r=>{const a=new Date(r),p=new Date,t=p-a;return t<6e4?"刚刚":t<36e5?`${Math.floor(t/6e4)}分钟前`:a.toDateString()===p.toDateString()?a.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}):a.toLocaleDateString("zh-CN")+" "+a.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"})},h=async r=>{const a={policy:"政策库",enterprise:"企业库",regulation:"法规库",standard:"标准库",case:"案例库",help:"帮助中心"}[r]||"未知功能",p=`我想查看${a}`;v.push({type:"user",content:p,timestamp:new Date}),D(()=>{b()});try{const t=await X.chatWithAI(p);v.push({type:"ai",content:t.reply,timestamp:new Date})}catch(t){console.error("AI接口调用失败:",t),v.push({type:"ai",content:`好的，我来为您打开${a}。这里是${a}的相关信息，您可以根据需要进行查询和浏览。`,timestamp:new Date})}D(()=>{b()})},ne=()=>{T.clearUserToken(),ae.push({name:"login"})},ue=()=>{m.oldpwd="",m.pwd1="",m.pwd2="",c.value=!0},de=()=>{W.value.validate(async(r,a)=>{if(r)try{await Pe.resetPwd(m.oldpwd,m.pwd1,m.pwd2),j.success("密码修改成功"),c.value=!1}catch(p){j.error(p)}else j.info("字段校验失败!"),console.log("字段校验失败!");console.log(a)}),c.value=!1},ie=(r,a)=>{console.log(r,a)},oe=(r,a)=>{console.log(r,a)},$=_(!1),re=()=>{$.value=!$.value};return(r,a)=>{const p=i("router-link"),t=i("el-icon"),o=i("el-menu-item"),k=i("el-sub-menu"),me=i("el-menu"),ce=i("el-aside"),y=i("el-button"),L=i("el-avatar"),M=i("el-dropdown-item"),pe=i("el-dropdown-menu"),_e=i("el-dropdown"),fe=i("el-header"),ge=i("RouterView"),ve=i("el-main"),F=i("el-container"),A=i("el-input"),N=i("el-form-item"),we=i("el-form"),G=i("el-dialog");return V(),C(P,null,[e(F,{class:"container"},{default:l(()=>[e(ce,{class:"aside",width:"250px"},{default:l(()=>[e(p,{to:"/",class:"brand"},{default:l(()=>a[13]||(a[13]=[d("益客管理系统")])),_:1,__:[13]}),e(me,{router:!0,"default-active":r.$route.name,class:"el-menu-vertical-demo",onOpen:ie,onClose:oe},{default:l(()=>[e(o,{index:"home",route:{name:"home"}},{title:l(()=>[e(t,null,{default:l(()=>[e(s(ke))]),_:1}),a[14]||(a[14]=n("span",null,"首页",-1))]),_:1}),e(k,{index:"2"},{title:l(()=>[e(t,null,{default:l(()=>[e(s(Ce))]),_:1}),a[15]||(a[15]=n("span",null,"考勤管理",-1))]),default:l(()=>[e(o,{index:"myabsent",route:{name:"myabsent"}},{default:l(()=>[e(t,null,{default:l(()=>[e(s(Ve))]),_:1}),a[16]||(a[16]=d("个人管理"))]),_:1,__:[16]}),e(o,{index:"subabsent",route:{name:"subabsent"}},{default:l(()=>[e(t,null,{default:l(()=>[e(s(J))]),_:1}),a[17]||(a[17]=d("下属考勤"))]),_:1,__:[17]}),e(o,{index:"expense-rd",route:{name:"expense-rd"}},{default:l(()=>[e(t,null,{default:l(()=>[e(s(K))]),_:1}),a[18]||(a[18]=d("研发费用管理"))]),_:1,__:[18]})]),_:1}),e(k,{index:"3"},{title:l(()=>[e(t,null,{default:l(()=>[e(s(O))]),_:1}),a[19]||(a[19]=n("span",null,"通知管理",-1))]),default:l(()=>[e(o,{index:"notification",route:{name:"notification"}},{default:l(()=>[e(t,null,{default:l(()=>[e(s(De))]),_:1}),a[20]||(a[20]=d("发布通的知"))]),_:1,__:[20]}),e(o,{index:"video-monitor",route:{name:"video-monitor"}},{default:l(()=>[e(t,null,{default:l(()=>[e(s(Ie))]),_:1}),a[21]||(a[21]=d("通知列的表"))]),_:1,__:[21]}),e(o,{index:"expense-rd2",route:{name:"expense-rd2"}},{default:l(()=>[e(t,null,{default:l(()=>[e(s(K))]),_:1}),a[22]||(a[22]=d("研发费用管理2"))]),_:1,__:[22]})]),_:1}),e(k,{index:"5"},{title:l(()=>[e(t,null,{default:l(()=>[e(s(Z))]),_:1}),a[23]||(a[23]=n("span",null,"员工管理",-1))]),default:l(()=>[e(o,{index:"exam",route:{name:"exam"}},{default:l(()=>[e(t,null,{default:l(()=>[e(s(ze))]),_:1}),a[24]||(a[24]=d("员工通的知"))]),_:1,__:[24]}),e(o,{index:"employee",route:{name:"employee"}},{default:l(()=>[e(t,null,{default:l(()=>[e(s(Ue))]),_:1}),a[25]||(a[25]=d("员工列的表"))]),_:1,__:[25]}),e(o,{index:"filemanage",route:{name:"filemanage"}},{default:l(()=>[e(t,null,{default:l(()=>[e(s(O))]),_:1}),a[26]||(a[26]=d("员工管的理"))]),_:1,__:[26]})]),_:1}),e(k,{index:"6"},{title:l(()=>[e(t,null,{default:l(()=>[e(s(Z))]),_:1}),a[27]||(a[27]=n("span",null,"智慧农业",-1))]),default:l(()=>[e(o,{index:"agriculture",route:{name:"agriculture"}},{default:l(()=>[e(t,null,{default:l(()=>[e(s(S))]),_:1}),a[28]||(a[28]=d("农业管理"))]),_:1,__:[28]}),e(o,{index:"building",route:{name:"building"}},{default:l(()=>[e(t,null,{default:l(()=>[e(s(S))]),_:1}),a[29]||(a[29]=d("建筑管理"))]),_:1,__:[29]}),e(o,{index:"language",route:{name:"language"}},{default:l(()=>[e(t,null,{default:l(()=>[e(s(S))]),_:1}),a[30]||(a[30]=d("语言管理"))]),_:1,__:[30]}),e(o,{index:"district",route:{name:"district"}},{default:l(()=>[e(t,null,{default:l(()=>[e(s(Q))]),_:1}),a[31]||(a[31]=d("区县管理"))]),_:1,__:[31]}),e(o,{index:"traffic",route:{name:"traffic"}},{default:l(()=>[e(t,null,{default:l(()=>[e(s(Q))]),_:1}),a[32]||(a[32]=d("交通管理"))]),_:1,__:[32]})]),_:1}),e(k,{index:"16"},{title:l(()=>[e(t,null,{default:l(()=>[e(s(Z))]),_:1}),a[33]||(a[33]=n("span",null,"智慧工信",-1))]),default:l(()=>[e(o,{index:"industry",route:{name:"industry"}},{default:l(()=>[e(t,null,{default:l(()=>[e(s(S))]),_:1}),a[34]||(a[34]=d("工信管理"))]),_:1,__:[34]}),e(o,{index:"education",route:{name:"education"}},{default:l(()=>[e(t,null,{default:l(()=>[e(s(Ae))]),_:1}),a[35]||(a[35]=d("教育管理"))]),_:1,__:[35]}),e(o,{index:"enterprise",route:{name:"enterprise"}},{default:l(()=>[e(t,null,{default:l(()=>[e(s(Se))]),_:1}),a[36]||(a[36]=d("企业管理"))]),_:1,__:[36]})]),_:1})]),_:1},8,["default-active"])]),_:1}),e(F,null,{default:l(()=>[e(fe,{class:"header"},{default:l(()=>[n("div",Ke,[e(y,null,{default:l(()=>[e(t,null,{default:l(()=>[e(s(R))]),_:1})]),_:1})]),Te(e(y,{icon:s(R),onClick:re},null,8,["icon"]),[[$e,$.value]]),n("div",Qe,[e(y,{class:"ai-button",type:"primary",size:"small",onClick:se,style:{"margin-right":"15px"}},{default:l(()=>[e(t,null,{default:l(()=>[e(s(Le))]),_:1}),a[37]||(a[37]=d(" AI助手 "))]),_:1,__:[37]}),e(_e,null,{dropdown:l(()=>[e(pe,null,{default:l(()=>[e(M,{onClick:ue},{default:l(()=>a[38]||(a[38]=[d("修改密码")])),_:1,__:[38]}),e(M,null,{default:l(()=>a[39]||(a[39]=[d("个人中心")])),_:1,__:[39]}),e(M,{divided:"",onClick:ne},{default:l(()=>a[40]||(a[40]=[d("退出登录")])),_:1,__:[40]})]),_:1})]),default:l(()=>[n("span",Re,[e(L,{size:30,icon:"UserFilled"}),n("span",Xe,"("+x(s(T).user.department.name)+")"+x(s(T).user.realname),1),e(t,{class:"el-icon--right"},{default:l(()=>[e(s(Me))]),_:1})])]),_:1})])]),_:1}),e(ve,{class:"main"},{default:l(()=>[e(ge)]),_:1})]),_:1})]),_:1}),e(G,{modelValue:s(c),"onUpdate:modelValue":a[4]||(a[4]=u=>H(c)?c.value=u:c=u),title:"修改密码",width:"500"},{footer:l(()=>[n("div",ea,[e(y,{onClick:a[3]||(a[3]=u=>H(c)?c.value=!1:c=!1)},{default:l(()=>a[41]||(a[41]=[d("取消")])),_:1,__:[41]}),e(y,{type:"primary",onClick:de},{default:l(()=>a[42]||(a[42]=[d(" 确认 ")])),_:1,__:[42]})])]),default:l(()=>[e(we,{model:s(m),rules:s(ee),ref_key:"formTag",ref:W},{default:l(()=>[e(N,{label:"旧密码","label-width":s(f),prop:"oldpwd"},{default:l(()=>[e(A,{modelValue:s(m).oldpwd,"onUpdate:modelValue":a[0]||(a[0]=u=>s(m).oldpwd=u),autocomplete:"off",type:"password"},null,8,["modelValue"])]),_:1},8,["label-width"]),e(N,{label:"新密码","label-width":s(f),prop:"pwd1"},{default:l(()=>[e(A,{modelValue:s(m).pwd1,"onUpdate:modelValue":a[1]||(a[1]=u=>s(m).pwd1=u),autocomplete:"off",type:"password"},null,8,["modelValue"])]),_:1},8,["label-width"]),e(N,{label:"确认密码","label-width":s(f),prop:"pwd2"},{default:l(()=>[e(A,{modelValue:s(m).pwd2,"onUpdate:modelValue":a[2]||(a[2]=u=>s(m).pwd2=u),autocomplete:"off",type:"password"},null,8,["modelValue"])]),_:1},8,["label-width"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),e(G,{modelValue:I.value,"onUpdate:modelValue":a[12]||(a[12]=u=>I.value=u),title:"AI智能助手",width:"800px","before-close":te,class:"ai-chat-dialog",draggable:""},{default:l(()=>[n("div",aa,[n("div",la,[n("div",sa,[n("div",{class:"menu-item",onClick:a[5]||(a[5]=u=>h("policy"))},[e(t,null,{default:l(()=>[e(s(Ne))]),_:1}),a[43]||(a[43]=n("span",null,"政策库",-1))]),n("div",{class:"menu-item",onClick:a[6]||(a[6]=u=>h("enterprise"))},[e(t,null,{default:l(()=>[e(s(qe))]),_:1}),a[44]||(a[44]=n("span",null,"企业库",-1))]),n("div",{class:"menu-item",onClick:a[7]||(a[7]=u=>h("regulation"))},[e(t,null,{default:l(()=>[e(s(Oe))]),_:1}),a[45]||(a[45]=n("span",null,"法规库",-1))]),n("div",{class:"menu-item",onClick:a[8]||(a[8]=u=>h("standard"))},[e(t,null,{default:l(()=>[e(s(Ze))]),_:1}),a[46]||(a[46]=n("span",null,"标准库",-1))]),n("div",{class:"menu-item",onClick:a[9]||(a[9]=u=>h("case"))},[e(t,null,{default:l(()=>[e(s(O))]),_:1}),a[47]||(a[47]=n("span",null,"案例库",-1))]),n("div",{class:"menu-item",onClick:a[10]||(a[10]=u=>h("help"))},[e(t,null,{default:l(()=>[e(s(je))]),_:1}),a[48]||(a[48]=n("span",null,"帮助中心",-1))])])]),n("div",ta,[n("div",{class:"chat-messages",ref_key:"messagesContainer",ref:U},[(V(!0),C(P,null,Ee(v,(u,he)=>(V(),C("div",{key:he,class:We(["message-item",u.type])},[u.type==="user"?(V(),C("div",na,[n("div",ua,[n("div",da,x(u.content),1),n("div",ia,x(B(u.timestamp)),1)]),n("div",oa,[e(L,{size:40,src:le.value},{default:l(()=>[e(t,null,{default:l(()=>[e(s(J))]),_:1})]),_:1},8,["src"])])])):(V(),C("div",ra,[n("div",ma,[e(L,{size:40,class:"ai-avatar"},{default:l(()=>[e(t,null,{default:l(()=>[e(s(Ye))]),_:1})]),_:1})]),n("div",ca,[n("div",pa,x(u.content),1),n("div",_a,x(B(u.timestamp)),1)])]))],2))),128))],512),n("div",fa,[n("div",ga,[e(A,{modelValue:g.value,"onUpdate:modelValue":a[11]||(a[11]=u=>g.value=u),type:"textarea",rows:3,placeholder:"请输入您的问题...",onKeydown:Be(Y,["enter"]),resize:"none"},null,8,["modelValue"]),n("div",va,[a[50]||(a[50]=n("span",{class:"input-tip"},"Enter 发送",-1)),e(y,{type:"primary",onClick:Y,loading:z.value,disabled:!g.value.trim()},{default:l(()=>a[49]||(a[49]=[d(" 发送 ")])),_:1,__:[49]},8,["loading","disabled"])])])])])])]),_:1},8,["modelValue"])],64)}}}),Ca=Fe(ha,[["__scopeId","data-v-35e213e1"]]);export{Ca as default};
