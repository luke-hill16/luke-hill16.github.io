import{ref as e,reactive as a,computed as l,onMounted as t,resolveComponent as n,resolveDirective as i,openBlock as d,createElementBlock as u,createElementVNode as o,createVNode as s,withCtx as r,unref as c,createTextVNode as p,toDisplayString as m,withKeys as f,withDirectives as v,createBlock as g,createCommentVNode as _}from"vue";import{ElMessageBox as b,ElMessage as y}from"element-plus";import{K as h,J as V,r as w,l as k,P as C,k as U,F as x}from"./index-BOpLbFaH.js";import{_ as D}from"./_plugin-vue_export-helper-BCo6x5W8.js";const z={class:"traffic-container"},M={class:"page-header"},S={class:"header-actions"},T={class:"overview-section"},P={class:"card-content"},j={class:"card-icon primary"},q={class:"card-info"},I={class:"card-value"},R={class:"card-content"},A={class:"card-icon success"},F={class:"card-info"},O={class:"card-value"},B={class:"card-content"},K={class:"card-icon warning"},L={class:"card-info"},J={class:"card-value"},$={class:"card-content"},E={class:"card-icon info"},G={class:"card-info"},H={class:"card-value"},N={class:"search-section"},Q={class:"traffic-list"},W={class:"pagination-container"},X={class:"dialog-footer"},Y={key:0,class:"traffic-detail"},Z=D({__name:"traffic",setup(D){const Z=e(!1),ee=e(!1),ae=e(!1),le=e(!1),te=e(),ne=e(null),ie=a({name:"",type:"",status:""}),de=a({currentPage:1,pageSize:10,total:0}),ue=a({id:null,name:"",type:"",location:"",length:0,capacity:"",status:"normal",buildDate:"",lastMaintenance:"",description:""}),oe={name:[{required:!0,message:"请输入设施名称",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"}],type:[{required:!0,message:"请选择设施类型",trigger:"change"}],location:[{required:!0,message:"请输入设施位置",trigger:"blur"}],length:[{required:!0,message:"请输入设施长度",trigger:"blur"}],capacity:[{required:!0,message:"请输入通行能力",trigger:"blur"}]},se=a({totalRoads:0,totalVehicles:0,totalAccidents:0,totalSignals:0}),re=e([{id:1,name:"长安街",type:"road",location:"北京市中心",length:3.8,capacity:"双向八车道",status:"normal",buildDate:"1950-01-01",lastMaintenance:"2024-01-15",description:"北京市最重要的东西向主干道，连接天安门广场",createTime:"2020-01-01 10:00:00"},{id:2,name:"二环路",type:"road",location:"北京市二环",length:32.7,capacity:"双向六车道",status:"normal",buildDate:"1980-01-01",lastMaintenance:"2024-02-01",description:"北京市重要的环形主干道",createTime:"2020-01-01 10:00:00"},{id:3,name:"长安街信号灯系统",type:"signal",location:"长安街沿线",length:0,capacity:"智能控制",status:"normal",buildDate:"2010-01-01",lastMaintenance:"2024-01-20",description:"智能交通信号灯系统，实现绿波带控制",createTime:"2020-01-01 10:00:00"},{id:4,name:"西直门立交桥",type:"bridge",location:"西直门地区",length:1.2,capacity:"双向四车道",status:"maintenance",buildDate:"1995-01-01",lastMaintenance:"2024-03-01",description:"重要的交通枢纽立交桥",createTime:"2020-01-01 10:00:00"},{id:5,name:"王府井停车场",type:"parking",location:"王府井商业区",length:0,capacity:"500个车位",status:"normal",buildDate:"2005-01-01",lastMaintenance:"2024-01-10",description:"王府井商业区地下停车场",createTime:"2020-01-01 10:00:00"}]),ce=l((()=>ue.id?"编辑交通设施":"添加交通设施")),pe=e=>({road:"道路",bridge:"桥梁",tunnel:"隧道",signal:"信号灯",parking:"停车场"}[e]||"未知"),me=e=>({road:"primary",bridge:"success",tunnel:"warning",signal:"info",parking:"danger"}[e]||""),fe=e=>({normal:"正常",maintenance:"维护中",fault:"故障",construction:"建设中"}[e]||"未知"),ve=e=>({normal:"success",maintenance:"warning",fault:"danger",construction:"info"}[e]||""),ge=()=>{ue.id=null,ae.value=!0},_e=async()=>{if(te.value)try{if(await te.value.validate(),ee.value=!0,await new Promise((e=>setTimeout(e,1e3))),ue.id){const e=re.value.findIndex((e=>e.id===ue.id));e>-1&&(re.value[e]={...ue}),y.success("编辑成功")}else{const e={...ue,id:Date.now(),createTime:(new Date).toLocaleString()};re.value.unshift(e),y.success("添加成功")}Ce(),ae.value=!1,be()}catch(e){}finally{ee.value=!1}},be=()=>{te.value&&te.value.resetFields(),Object.assign(ue,{id:null,name:"",type:"",location:"",length:0,capacity:"",status:"normal",buildDate:"",lastMaintenance:"",description:""})},ye=()=>{de.currentPage=1},he=()=>{Object.assign(ie,{name:"",type:"",status:""}),ye()},Ve=e=>{de.pageSize=e},we=e=>{de.currentPage=e},ke=()=>{y.success("交通设施数据导出成功")},Ce=()=>{se.totalRoads=re.value.filter((e=>"road"===e.type)).length,se.totalVehicles=15e5,se.totalAccidents=25,se.totalSignals=re.value.filter((e=>"signal"===e.type)).length};return t((()=>{Ce(),de.total=re.value.length})),(e,a)=>{const l=n("el-icon"),t=n("el-button"),D=n("el-card"),Ue=n("el-col"),xe=n("el-row"),De=n("el-input"),ze=n("el-option"),Me=n("el-select"),Se=n("el-table-column"),Te=n("el-tag"),Pe=n("el-table"),je=n("el-pagination"),qe=n("el-form-item"),Ie=n("el-input-number"),Re=n("el-date-picker"),Ae=n("el-form"),Fe=n("el-dialog"),Oe=n("el-descriptions-item"),Be=n("el-descriptions"),Ke=i("loading");return d(),u("div",z,[o("div",M,[a[19]||(a[19]=o("h2",null,"交通管理系统",-1)),o("div",S,[s(t,{type:"success",onClick:ke},{default:r((()=>[s(l,null,{default:r((()=>[s(c(h))])),_:1}),a[17]||(a[17]=p(" 导出数据 "))])),_:1,__:[17]}),s(t,{type:"primary",onClick:ge},{default:r((()=>[s(l,null,{default:r((()=>[s(c(V))])),_:1}),a[18]||(a[18]=p(" 添加设施 "))])),_:1,__:[18]})])]),o("div",T,[s(xe,{gutter:20},{default:r((()=>[s(Ue,{span:6},{default:r((()=>[s(D,{class:"overview-card"},{default:r((()=>[o("div",P,[o("div",j,[s(l,null,{default:r((()=>[s(c(w))])),_:1})]),o("div",q,[a[20]||(a[20]=o("div",{class:"card-title"},"道路总数",-1)),o("div",I,m(se.totalRoads),1)])])])),_:1})])),_:1}),s(Ue,{span:6},{default:r((()=>[s(D,{class:"overview-card"},{default:r((()=>{return[o("div",R,[o("div",A,[s(l,null,{default:r((()=>[s(c(k))])),_:1})]),o("div",F,[a[21]||(a[21]=o("div",{class:"card-title"},"车辆流量",-1)),o("div",O,m((e=se.totalVehicles,e.toLocaleString())),1)])])];var e})),_:1})])),_:1}),s(Ue,{span:6},{default:r((()=>[s(D,{class:"overview-card"},{default:r((()=>[o("div",B,[o("div",K,[s(l,null,{default:r((()=>[s(c(C))])),_:1})]),o("div",L,[a[22]||(a[22]=o("div",{class:"card-title"},"事故数量",-1)),o("div",J,m(se.totalAccidents),1)])])])),_:1})])),_:1}),s(Ue,{span:6},{default:r((()=>[s(D,{class:"overview-card"},{default:r((()=>[o("div",$,[o("div",E,[s(l,null,{default:r((()=>[s(c(U))])),_:1})]),o("div",G,[a[23]||(a[23]=o("div",{class:"card-title"},"信号灯",-1)),o("div",H,m(se.totalSignals),1)])])])),_:1})])),_:1})])),_:1})]),o("div",N,[s(xe,{gutter:20},{default:r((()=>[s(Ue,{span:6},{default:r((()=>[s(De,{modelValue:ie.name,"onUpdate:modelValue":a[0]||(a[0]=e=>ie.name=e),placeholder:"设施名称",clearable:"",onClear:ye,onKeyup:f(ye,["enter"])},{prefix:r((()=>[s(l,null,{default:r((()=>[s(c(x))])),_:1})])),_:1},8,["modelValue"])])),_:1}),s(Ue,{span:6},{default:r((()=>[s(Me,{modelValue:ie.type,"onUpdate:modelValue":a[1]||(a[1]=e=>ie.type=e),placeholder:"设施类型",clearable:"",onChange:ye},{default:r((()=>[s(ze,{label:"道路",value:"road"}),s(ze,{label:"桥梁",value:"bridge"}),s(ze,{label:"隧道",value:"tunnel"}),s(ze,{label:"信号灯",value:"signal"}),s(ze,{label:"停车场",value:"parking"})])),_:1},8,["modelValue"])])),_:1}),s(Ue,{span:6},{default:r((()=>[s(Me,{modelValue:ie.status,"onUpdate:modelValue":a[2]||(a[2]=e=>ie.status=e),placeholder:"设施状态",clearable:"",onChange:ye},{default:r((()=>[s(ze,{label:"正常",value:"normal"}),s(ze,{label:"维护中",value:"maintenance"}),s(ze,{label:"故障",value:"fault"}),s(ze,{label:"建设中",value:"construction"})])),_:1},8,["modelValue"])])),_:1}),s(Ue,{span:6},{default:r((()=>[s(t,{type:"primary",onClick:ye},{default:r((()=>[s(l,null,{default:r((()=>[s(c(x))])),_:1}),a[24]||(a[24]=p(" 搜索 "))])),_:1,__:[24]}),s(t,{onClick:he},{default:r((()=>a[25]||(a[25]=[p("重置")]))),_:1,__:[25]})])),_:1})])),_:1})]),o("div",Q,[v((d(),g(Pe,{data:re.value,stripe:""},{default:r((()=>[s(Se,{prop:"id",label:"ID",width:"80"}),s(Se,{prop:"name",label:"设施名称"}),s(Se,{prop:"type",label:"设施类型",width:"100"},{default:r((e=>[s(Te,{type:me(e.row.type)},{default:r((()=>[p(m(pe(e.row.type)),1)])),_:2},1032,["type"])])),_:1}),s(Se,{prop:"location",label:"位置"}),s(Se,{prop:"length",label:"长度(km)",width:"100"}),s(Se,{prop:"capacity",label:"通行能力",width:"120"}),s(Se,{prop:"status",label:"状态",width:"100"},{default:r((e=>[s(Te,{type:ve(e.row.status)},{default:r((()=>[p(m(fe(e.row.status)),1)])),_:2},1032,["type"])])),_:1}),s(Se,{prop:"lastMaintenance",label:"最后维护",width:"120"}),s(Se,{label:"操作",width:"200",fixed:"right"},{default:r((e=>[s(t,{size:"small",onClick:a=>{return l=e.row,ne.value=l,void(le.value=!0);var l}},{default:r((()=>a[26]||(a[26]=[p("查看")]))),_:2,__:[26]},1032,["onClick"]),s(t,{size:"small",type:"primary",onClick:a=>{return l=e.row,Object.assign(ue,l),void(ae.value=!0);var l}},{default:r((()=>a[27]||(a[27]=[p("编辑")]))),_:2,__:[27]},1032,["onClick"]),s(t,{size:"small",type:"danger",onClick:a=>(async e=>{try{await b.confirm(`确定要删除交通设施"${e.name}"吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const a=re.value.findIndex((a=>a.id===e.id));a>-1&&(re.value.splice(a,1),Ce(),y.success("删除成功"))}catch(a){}})(e.row)},{default:r((()=>a[28]||(a[28]=[p("删除")]))),_:2,__:[28]},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[Ke,Z.value]]),o("div",W,[s(je,{"current-page":de.currentPage,"onUpdate:currentPage":a[3]||(a[3]=e=>de.currentPage=e),"page-size":de.pageSize,"onUpdate:pageSize":a[4]||(a[4]=e=>de.pageSize=e),"page-sizes":[10,20,50,100],total:de.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:Ve,onCurrentChange:we},null,8,["current-page","page-size","total"])])]),s(Fe,{modelValue:ae.value,"onUpdate:modelValue":a[15]||(a[15]=e=>ae.value=e),title:ce.value,width:"700px",onClose:be},{footer:r((()=>[o("div",X,[s(t,{onClick:a[14]||(a[14]=e=>ae.value=!1)},{default:r((()=>a[29]||(a[29]=[p("取消")]))),_:1,__:[29]}),s(t,{type:"primary",onClick:_e,loading:ee.value},{default:r((()=>a[30]||(a[30]=[p("确定")]))),_:1,__:[30]},8,["loading"])])])),default:r((()=>[s(Ae,{model:ue,rules:oe,ref_key:"trafficFormRef",ref:te,"label-width":"120px"},{default:r((()=>[s(xe,{gutter:20},{default:r((()=>[s(Ue,{span:12},{default:r((()=>[s(qe,{label:"设施名称",prop:"name"},{default:r((()=>[s(De,{modelValue:ue.name,"onUpdate:modelValue":a[5]||(a[5]=e=>ue.name=e),placeholder:"请输入设施名称"},null,8,["modelValue"])])),_:1})])),_:1}),s(Ue,{span:12},{default:r((()=>[s(qe,{label:"设施类型",prop:"type"},{default:r((()=>[s(Me,{modelValue:ue.type,"onUpdate:modelValue":a[6]||(a[6]=e=>ue.type=e),placeholder:"请选择设施类型",style:{width:"100%"}},{default:r((()=>[s(ze,{label:"道路",value:"road"}),s(ze,{label:"桥梁",value:"bridge"}),s(ze,{label:"隧道",value:"tunnel"}),s(ze,{label:"信号灯",value:"signal"}),s(ze,{label:"停车场",value:"parking"})])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),s(xe,{gutter:20},{default:r((()=>[s(Ue,{span:12},{default:r((()=>[s(qe,{label:"位置",prop:"location"},{default:r((()=>[s(De,{modelValue:ue.location,"onUpdate:modelValue":a[7]||(a[7]=e=>ue.location=e),placeholder:"请输入设施位置"},null,8,["modelValue"])])),_:1})])),_:1}),s(Ue,{span:12},{default:r((()=>[s(qe,{label:"长度(km)",prop:"length"},{default:r((()=>[s(Ie,{modelValue:ue.length,"onUpdate:modelValue":a[8]||(a[8]=e=>ue.length=e),min:0,precision:2,style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),s(xe,{gutter:20},{default:r((()=>[s(Ue,{span:12},{default:r((()=>[s(qe,{label:"通行能力",prop:"capacity"},{default:r((()=>[s(De,{modelValue:ue.capacity,"onUpdate:modelValue":a[9]||(a[9]=e=>ue.capacity=e),placeholder:"如：双向四车道"},null,8,["modelValue"])])),_:1})])),_:1}),s(Ue,{span:12},{default:r((()=>[s(qe,{label:"设施状态",prop:"status"},{default:r((()=>[s(Me,{modelValue:ue.status,"onUpdate:modelValue":a[10]||(a[10]=e=>ue.status=e),placeholder:"请选择设施状态",style:{width:"100%"}},{default:r((()=>[s(ze,{label:"正常",value:"normal"}),s(ze,{label:"维护中",value:"maintenance"}),s(ze,{label:"故障",value:"fault"}),s(ze,{label:"建设中",value:"construction"})])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),s(xe,{gutter:20},{default:r((()=>[s(Ue,{span:12},{default:r((()=>[s(qe,{label:"建设时间",prop:"buildDate"},{default:r((()=>[s(Re,{modelValue:ue.buildDate,"onUpdate:modelValue":a[11]||(a[11]=e=>ue.buildDate=e),type:"date",placeholder:"选择建设时间",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),s(Ue,{span:12},{default:r((()=>[s(qe,{label:"最后维护",prop:"lastMaintenance"},{default:r((()=>[s(Re,{modelValue:ue.lastMaintenance,"onUpdate:modelValue":a[12]||(a[12]=e=>ue.lastMaintenance=e),type:"date",placeholder:"选择最后维护时间",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),s(qe,{label:"设施描述",prop:"description"},{default:r((()=>[s(De,{modelValue:ue.description,"onUpdate:modelValue":a[13]||(a[13]=e=>ue.description=e),type:"textarea",rows:3,placeholder:"请输入设施描述"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","title"]),s(Fe,{modelValue:le.value,"onUpdate:modelValue":a[16]||(a[16]=e=>le.value=e),title:"交通设施详情",width:"800px"},{default:r((()=>[ne.value?(d(),u("div",Y,[s(Be,{column:2,border:""},{default:r((()=>[s(Oe,{label:"设施名称"},{default:r((()=>[p(m(ne.value.name),1)])),_:1}),s(Oe,{label:"设施类型"},{default:r((()=>[s(Te,{type:me(ne.value.type)},{default:r((()=>[p(m(pe(ne.value.type)),1)])),_:1},8,["type"])])),_:1}),s(Oe,{label:"位置"},{default:r((()=>[p(m(ne.value.location),1)])),_:1}),s(Oe,{label:"长度"},{default:r((()=>[p(m(ne.value.length)+" km",1)])),_:1}),s(Oe,{label:"通行能力"},{default:r((()=>[p(m(ne.value.capacity),1)])),_:1}),s(Oe,{label:"设施状态"},{default:r((()=>[s(Te,{type:ve(ne.value.status)},{default:r((()=>[p(m(fe(ne.value.status)),1)])),_:1},8,["type"])])),_:1}),s(Oe,{label:"建设时间"},{default:r((()=>[p(m(ne.value.buildDate),1)])),_:1}),s(Oe,{label:"最后维护"},{default:r((()=>[p(m(ne.value.lastMaintenance),1)])),_:1}),s(Oe,{label:"设施描述",span:2},{default:r((()=>[p(m(ne.value.description||"暂无描述"),1)])),_:1})])),_:1})])):_("",!0)])),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-6fb2a1f1"]]);export{Z as default};
