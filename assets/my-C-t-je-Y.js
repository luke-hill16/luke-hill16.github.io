import{defineComponent as e,ref as l,reactive as t,computed as a,onMounted as d,resolveComponent as o,openBlock as n,createElementBlock as r,Fragment as i,createVNode as u,withCtx as s,createTextVNode as p,renderList as _,createBlock as m,createElementVNode as b,unref as c,isRef as f,toDisplayString as g}from"vue";import{_ as y}from"./OAPageHeader-qQyNp4x3.js";import{h}from"./http-Dy8u1s8a.js";import{ElMessage as w}from"element-plus";import"./index-BOpLbFaH.js";import"./axios-DjXdQO6G.js";const v=()=>h.get("/absent/type"),V=()=>h.get("/absent/responder"),x=e=>h.post("/absent/absent",e),k=e=>h.get("/absent/absent?who=my"),q={style:{"text-align":"right"}},z={class:"dialog-footer"},Y={class:"demo-pagination-block",style:{display:"flex","align-items":"right","justify-content":"right"}},C=e({name:"my_abhosentt"}),j=Object.assign(C,{setup(e){let h=l(!1),C=l([]),j=t({email:"",realname:""}),U=l([]),D=a((()=>j.email?"["+j.email+"]"+j.realname:"无")),M=t({title:"",absent_type_id:null,date_range:[],request_content:""});const L=()=>{M.title="",M.absent_type_id=null,M.date_range=[],M.request_content="",h.value=!0};let W=t({title:[{required:!0,message:"请输入标题！",trigger:"blur"}],absent_type_id:[{required:!0,message:"请选择请假类型！",trigger:"change"}],date_range:[{required:!0,message:"请选择请假时间！",trigger:"blur"}],request_content:[{required:!0,message:"请输入请假理由！",trigger:"blur"}]}),O=l();const P=()=>{O.value.validate((async(e,l)=>{if(e){let e={title:M.title,absent_type_id:M.absent_type_id,start_date:M.date_range[0],end_date:M.date_range[1],request_content:M.request_content};try{await x(e);h.value=!1}catch(t){w.error(t)}}}))};return d((async()=>{try{let e=await v();C.value=e;let l=await V();Object.assign(j,l);let t=await k();U.value=t}catch(e){w.error(e)}})),(e,l)=>{const t=o("el-input"),a=o("el-option"),d=o("el-select"),w=o("el-button"),v=o("Plus"),V=o("el-icon"),x=o("el-card"),k=o("el-space"),j=o("el-form-item"),S=o("el-date-picker"),F=o("el-form"),$=o("el-dialog"),A=o("el-table-column"),E=o("el-tag"),H=o("el-table"),R=o("el-pagination");return n(),r(i,null,[u(k,{direction:"vertical",fill:"",size:20,style:{width:"100%"}},{default:s((()=>[u(y,{content:"个人考勤"}),u(x,{style:{"border-bottom":"1px solid#fff"},shadow:"none"},{default:s((()=>[l[12]||(l[12]=p(" 邮箱")),u(t,{modelValue:e.input,"onUpdate:modelValue":l[0]||(l[0]=l=>e.input=l),style:{width:"240px","text-align":"left",margin:"20px"},placeholder:"Please input"},null,8,["modelValue"]),l[13]||(l[13]=p(" 姓名")),u(t,{modelValue:e.input,"onUpdate:modelValue":l[1]||(l[1]=l=>e.input=l),style:{width:"240px","text-align":"left",margin:"20px"},placeholder:"Please input"},null,8,["modelValue"]),l[14]||(l[14]=p(" 地址")),u(d,{modelValue:e.value,"onUpdate:modelValue":l[2]||(l[2]=l=>e.value=l),placeholder:"Select",size:"middle",style:{width:"240px",margin:"20px"}},{default:s((()=>[(n(!0),r(i,null,_(e.options,(e=>(n(),m(a,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),u(w,{type:"primary"},{default:s((()=>l[9]||(l[9]=[p("编辑")]))),_:1,__:[9]}),u(w,null,{default:s((()=>l[10]||(l[10]=[p("重置")]))),_:1,__:[10]}),b("div",q,[u(w,{type:"primary",onClick:L},{default:s((()=>[u(V,null,{default:s((()=>[u(v)])),_:1}),l[11]||(l[11]=p("发起考勤"))])),_:1,__:[11]})])])),_:1,__:[12,13,14]})])),_:1}),u($,{modelValue:c(h),"onUpdate:modelValue":l[8]||(l[8]=e=>f(h)?h.value=e:h=e),title:"发起考勤",width:"600"},{footer:s((()=>[b("div",z,[u(w,{onClick:l[7]||(l[7]=e=>f(h)?h.value=!1:h=!1)},{default:s((()=>l[15]||(l[15]=[p("取消")]))),_:1,__:[15]}),u(w,{type:"primary",onClick:P},{default:s((()=>l[16]||(l[16]=[p(" 确定 ")]))),_:1,__:[16]})])])),default:s((()=>[u(F,{model:c(M),rules:c(W),ref_key:"absentFormRef",ref:O},{default:s((()=>[u(j,{label:"标题","label-width":e.formLabelWidth,prop:"title"},{default:s((()=>[u(t,{modelValue:c(M).title,"onUpdate:modelValue":l[3]||(l[3]=e=>c(M).title=e),autocomplete:"off"},null,8,["modelValue"])])),_:1},8,["label-width"]),u(j,{label:"请假类型","label-width":e.formLabelWidth,prop:"absent_type_id"},{default:s((()=>[u(d,{modelValue:c(M).absent_type_id,"onUpdate:modelValue":l[4]||(l[4]=e=>c(M).absent_type_id=e),placeholder:"请选择请假类型"},{default:s((()=>[(n(!0),r(i,null,_(c(C),(e=>(n(),m(a,{label:e.name,value:e.id,key:e.name},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["label-width"]),u(j,{label:"起止日期","label-width":e.formLabelWidth,prop:"date_range"},{default:s((()=>[u(S,{modelValue:c(M).date_range,"onUpdate:modelValue":l[5]||(l[5]=e=>c(M).date_range=e),type:"daterange","range-separator":"到","start-placeholder":"起始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])])),_:1},8,["label-width"]),u(j,{label:"审批人","label-width":e.formLabelWidth},{default:s((()=>[u(t,{value:c(D),readonly:"",disabled:"",autocomplete:"off"},null,8,["value"])])),_:1},8,["label-width"]),u(j,{label:"请假理由","label-width":e.formLabelWidth,prop:"request_content"},{default:s((()=>[u(t,{type:"textarea",modelValue:c(M).request_content,"onUpdate:modelValue":l[6]||(l[6]=e=>c(M).request_content=e),autocomplete:"off"},null,8,["modelValue"])])),_:1},8,["label-width"])])),_:1},8,["model","rules"])])),_:1},8,["modelValue"]),u(x,null,{default:s((()=>[u(H,{data:c(U),stripe:"",style:{width:"100%"},"default-sort":{prop:"date",order:"descending"},fit:"False"},{default:s((()=>[u(A,{type:"selection",selectable:e.selectable,width:"55"},null,8,["selectable"]),u(A,{type:"index",width:"50"}),u(A,{prop:"title",label:"标题",sortable:""}),u(A,{prop:"absent_type.name",label:"类型"}),u(A,{prop:"request_content",label:"原因"}),u(A,{prop:"start_date",label:"开始时间",sortable:""}),u(A,{prop:"end_date",label:"结束时间"}),u(A,{prop:"create_time.format('YYYY-MM-DD')",label:"发起它的时间"}),u(A,{label:"审核领导"},{default:s((()=>[p(g(c(D)),1)])),_:1}),u(A,{prop:"response_content",label:"反馈意见"}),u(A,{label:"审核状态"},{default:s((e=>[1==e.row.status?(n(),m(E,{key:0,type:"info"},{default:s((()=>l[17]||(l[17]=[p("审核中")]))),_:1,__:[17]})):2==e.row.status?(n(),m(E,{key:1,type:"success"},{default:s((()=>l[18]||(l[18]=[p("已通过")]))),_:1,__:[18]})):(n(),m(E,{key:2,type:"danger"},{default:s((()=>l[19]||(l[19]=[p("已拒绝")]))),_:1,__:[19]}))])),_:1}),u(A,{label:"Operations"},{default:s((t=>[u(w,{size:"small",type:"primary",onClick:l=>e.handleEdit(t.$index,t.row)},{default:s((()=>l[20]||(l[20]=[p(" 编辑 ")]))),_:2,__:[20]},1032,["onClick"]),u(w,{size:"small",type:"primary",onClick:l=>e.handleDelete(t.$index,t.row)},{default:s((()=>l[21]||(l[21]=[p(" 删除 ")]))),_:2,__:[21]},1032,["onClick"])])),_:1})])),_:1},8,["data"])])),_:1}),b("div",Y,[l[22]||(l[22]=b("div",{class:"demonstration"},null,-1)),u(R,{"page-sizes":[100,200,300,400],size:e.size,disabled:e.disabled,background:e.background,layout:"total, sizes, prev, pager, next, jumper",total:400,onSizeChange:e.handleSizeChange},null,8,["size","disabled","background","onSizeChange"])])],64)}}});export{j as default};
