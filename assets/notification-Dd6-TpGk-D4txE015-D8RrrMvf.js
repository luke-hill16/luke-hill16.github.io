import{r as oe}from"./_plugin-vue_export-helper-DlAUqK2U-lGy7RumW-DNI5evPq.js";import{L as y,E as ne,r as o,b as p,$ as S,Y as l,J as a,M as u,a as i,l as r,O as m,P as L,C as w,U as pe}from"./index-q8LaeBoo.js";const ce={class:"notification-container"},me={class:"header"},ve={class:"header-actions"},_e=["onClick"],fe={key:0,class:"notification-detail"},ye={class:"card-header"},be={class:"detail-item"},ge={class:"detail-item"},we={class:"detail-item"},he={class:"detail-item"},ke={class:"detail-item"},Ce={class:"detail-item"},Ve={class:"detail-item"},Te={class:"content-text"},xe={class:"card-header"},Ue={class:"header-actions"},$e={class:"dialog-footer"},qe={key:0,class:"read-status-detail"},ze={class:"status-summary"},Ae={class:"status-card"},De={class:"status-number"},Me={class:"status-card"},Pe={class:"status-number"},Be={class:"status-card"},Re={class:"status-number"},Se={__name:"notification",setup(Ie){const T=y([]),x=y(!1),d=y(null),h=y(!1),U=y("发布通知"),$=y(null),q=y(!1),_=y(null),A=y([]),N=[{id:"notif001",title:"关于公司年度会议的通知",category:"公司公告",priority:"高",status:"已发布",publisher:"张经理",publishTime:"2024-01-15 09:00:00",readCount:45,content:"各位同事，公司将于本周五下午2点在大会议室召开年度总结会议，请各部门负责人准时参加。会议将讨论公司年度业绩、来年规划等重要事项。"},{id:"notif002",title:"系统维护通知",category:"系统通知",priority:"中",status:"已发布",publisher:"技术部",publishTime:"2024-01-14 18:00:00",readCount:38,content:"为了提升系统性能，我们将在今晚22:00-24:00进行系统维护，期间可能影响部分功能的使用，请提前做好准备。"},{id:"notif003",title:"员工福利活动通知",category:"活动通知",priority:"低",status:"草稿",publisher:"人事部",publishTime:"2024-01-13 10:30:00",readCount:0,content:"为增进员工之间的交流，公司将于下周三组织团建活动，活动地点和时间另行通知，请大家踊跃报名参加。"}],D=y([{id:"rs001",realname:"张三",department:"技术部",status:"已读",readTime:"2025-01-15 09:15:00",ipAddress:"192.168.1.100"},{id:"rs002",realname:"李四",department:"人事部",status:"已读",readTime:"2025-01-15 09:20:00",ipAddress:"192.168.1.101"},{id:"rs003",realname:"王五",department:"财务部",status:"已读",readTime:"2025-01-15 09:20:00",ipAddress:"192.168.1.101"}]),n=y({title:"",category:"",priority:"中",targetDepartments:[],content:"",urgent:!1,requireConfirm:!1}),O={title:[{required:!0,message:"请输入通知标题",trigger:"blur"}],category:[{required:!0,message:"请选择通知类别",trigger:"change"}],priority:[{required:!0,message:"请选择优先级",trigger:"change"}],targetDepartments:[{required:!0,message:"请选择接收部门",trigger:"change"}],content:[{required:!0,message:"请输入通知内容",trigger:"blur"}]},z=async()=>{try{await new Promise(s=>setTimeout(s,500)),T.value=N,w.success("通知列表加载成功")}catch{w.error("获取通知列表失败")}},H=()=>{z()},K=()=>{U.value="发布通知",n.value={title:"",category:"",priority:"中",targetDepartments:[],content:"",urgent:!1,requireConfirm:!1},A.value=[],h.value=!0},I=s=>{U.value="编辑通知",n.value={...s},h.value=!0},Q=async()=>{try{await $.value.validate(),await new Promise(s=>setTimeout(s,1e3)),w.success(U.value==="发布通知"?"通知发布成功":"通知更新成功"),h.value=!1,z()}catch{w.error("表单验证失败")}},W=async()=>{try{await $.value.validate(),await new Promise(s=>setTimeout(s,500)),w.success("草稿保存成功"),h.value=!1,z()}catch{w.error("表单验证失败")}},X=async s=>{try{await pe.confirm(`确定要删除通知"${s.title}"吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),T.value=T.value.filter(e=>e.id!==s.id),w.success("删除成功")}catch{w.info("已取消删除")}},Z=s=>{d.value=s,x.value=!0,F(s.id)},G=s=>{_.value={...s,totalCount:50,unreadCount:50-s.readCount,readRate:Math.round(s.readCount/50*100)},q.value=!0},F=s=>{D.value=[{id:"rs001",realname:"张三",department:"技术部",status:"已读",readTime:"2025-01-15 09:15:00",ipAddress:"192.168.1.100"},{id:"rs002",realname:"李四",department:"人事部",status:"已读",readTime:"2025-01-15 09:20:00",ipAddress:"192.168.1.101"},{id:"rs003",realname:"王五",department:"财务部",status:"已读",readTime:"2025-01-15 09:20:00",ipAddress:"192.168.1.101"}]},ee=()=>{d.value&&(F(d.value.id),w.success("已读状态已刷新"))},le=(s,e)=>{console.log("文件变化:",s,e)},ae=()=>{x.value=!1,d.value=null,D.value=[]},te=()=>{var s;h.value=!1,(s=$.value)==null||s.resetFields(),A.value=[]},ue=()=>{q.value=!1,_.value=null};return ne(z),(s,e)=>{const f=o("el-button"),v=o("el-table-column"),c=o("el-tag"),Y=o("el-table"),M=o("el-card"),b=o("el-col"),V=o("el-row"),P=o("el-dialog"),j=o("el-input"),k=o("el-form-item"),g=o("el-option"),E=o("el-select"),B=o("el-radio"),ie=o("el-radio-group"),re=o("el-upload"),J=o("el-checkbox"),se=o("el-form"),C=o("el-descriptions-item"),de=o("el-descriptions");return p(),S("div",ce,[l(M,null,{default:a(()=>[u("div",me,[e[14]||(e[14]=u("span",null,"通知管理",-1)),u("div",ve,[l(f,{type:"primary",onClick:K,size:"small"},{default:a(()=>e[12]||(e[12]=[i("发布通知")])),_:1,__:[12]}),l(f,{type:"success",onClick:H,size:"small"},{default:a(()=>e[13]||(e[13]=[i("刷新")])),_:1,__:[13]})])]),l(Y,{data:T.value,style:{width:"100%","margin-top":"20px"},fit:"true"},{default:a(()=>[l(v,{prop:"title",label:"通知标题","min-width":"200"},{default:a(t=>[u("span",{class:"clickable-title",onClick:R=>Z(t.row)},r(t.row.title),9,_e)]),_:1}),l(v,{prop:"category",label:"通知类别","min-width":"120"}),l(v,{prop:"priority",label:"优先级","min-width":"100"},{default:a(t=>[t.row.priority==="高"?(p(),m(c,{key:0,type:"danger"},{default:a(()=>[i(r(t.row.priority),1)]),_:2},1024)):t.row.priority==="中"?(p(),m(c,{key:1,type:"warning"},{default:a(()=>[i(r(t.row.priority),1)]),_:2},1024)):(p(),m(c,{key:2,type:"info"},{default:a(()=>[i(r(t.row.priority),1)]),_:2},1024))]),_:1}),l(v,{prop:"status",label:"状态","min-width":"100"},{default:a(t=>[t.row.status==="已发布"?(p(),m(c,{key:0,type:"success"},{default:a(()=>[i(r(t.row.status),1)]),_:2},1024)):t.row.status==="草稿"?(p(),m(c,{key:1,type:"info"},{default:a(()=>[i(r(t.row.status),1)]),_:2},1024)):(p(),m(c,{key:2,type:"warning"},{default:a(()=>[i(r(t.row.status),1)]),_:2},1024))]),_:1}),l(v,{prop:"publisher",label:"发布人","min-width":"120"}),l(v,{prop:"publishTime",label:"发布时间","min-width":"150"}),l(v,{prop:"readCount",label:"已读人数","min-width":"100"}),l(v,{label:"操作","min-width":"200",fixed:"right"},{default:a(t=>[l(f,{size:"small",type:"primary",onClick:R=>I(t.row)},{default:a(()=>e[15]||(e[15]=[i("编辑")])),_:2,__:[15]},1032,["onClick"]),l(f,{size:"small",type:"success",onClick:R=>G(t.row)},{default:a(()=>e[16]||(e[16]=[i("查看已读")])),_:2,__:[16]},1032,["onClick"]),l(f,{size:"small",type:"danger",onClick:R=>X(t.row)},{default:a(()=>e[17]||(e[17]=[i("删除")])),_:2,__:[17]},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),l(P,{modelValue:x.value,"onUpdate:modelValue":e[1]||(e[1]=t=>x.value=t),title:"通知详情",width:"900px","before-close":ae},{default:a(()=>[d.value?(p(),S("div",fe,[l(M,{class:"info-card",shadow:"never"},{header:a(()=>[u("div",ye,[e[19]||(e[19]=u("span",null,"通知信息",-1)),l(f,{type:"primary",size:"small",onClick:e[0]||(e[0]=t=>I(d.value))},{default:a(()=>e[18]||(e[18]=[i("编辑通知")])),_:1,__:[18]})])]),default:a(()=>[l(V,{gutter:20},{default:a(()=>[l(b,{span:12},{default:a(()=>[u("div",be,[e[20]||(e[20]=u("label",null,"通知标题：",-1)),u("span",null,r(d.value.title),1)])]),_:1}),l(b,{span:12},{default:a(()=>[u("div",ge,[e[21]||(e[21]=u("label",null,"通知类别：",-1)),u("span",null,r(d.value.category),1)])]),_:1})]),_:1}),l(V,{gutter:20},{default:a(()=>[l(b,{span:12},{default:a(()=>[u("div",we,[e[22]||(e[22]=u("label",null,"优先级：",-1)),d.value.priority==="高"?(p(),m(c,{key:0,type:"danger"},{default:a(()=>[i(r(d.value.priority),1)]),_:1})):d.value.priority==="中"?(p(),m(c,{key:1,type:"warning"},{default:a(()=>[i(r(d.value.priority),1)]),_:1})):(p(),m(c,{key:2,type:"info"},{default:a(()=>[i(r(d.value.priority),1)]),_:1}))])]),_:1}),l(b,{span:12},{default:a(()=>[u("div",he,[e[23]||(e[23]=u("label",null,"状态：",-1)),d.value.status==="已发布"?(p(),m(c,{key:0,type:"success"},{default:a(()=>[i(r(d.value.status),1)]),_:1})):d.value.status==="草稿"?(p(),m(c,{key:1,type:"info"},{default:a(()=>[i(r(d.value.status),1)]),_:1})):(p(),m(c,{key:2,type:"warning"},{default:a(()=>[i(r(d.value.status),1)]),_:1}))])]),_:1})]),_:1}),l(V,{gutter:20},{default:a(()=>[l(b,{span:12},{default:a(()=>[u("div",ke,[e[24]||(e[24]=u("label",null,"发布人：",-1)),u("span",null,r(d.value.publisher),1)])]),_:1}),l(b,{span:12},{default:a(()=>[u("div",Ce,[e[25]||(e[25]=u("label",null,"发布时间：",-1)),u("span",null,r(d.value.publishTime),1)])]),_:1})]),_:1}),l(V,{gutter:20},{default:a(()=>[l(b,{span:24},{default:a(()=>[u("div",Ve,[e[26]||(e[26]=u("label",null,"通知内容：",-1)),u("div",Te,r(d.value.content),1)])]),_:1})]),_:1})]),_:1}),l(M,{class:"read-status-card",shadow:"never"},{header:a(()=>[u("div",xe,[e[28]||(e[28]=u("span",null,"已读状态",-1)),u("div",Ue,[l(f,{type:"primary",size:"small",onClick:ee},{default:a(()=>e[27]||(e[27]=[i("刷新")])),_:1,__:[27]})])])]),default:a(()=>[l(Y,{data:D.value,style:{width:"100%"},stripe:""},{default:a(()=>[l(v,{prop:"realname",label:"姓名",width:"120"}),l(v,{prop:"department",label:"部门",width:"120"}),l(v,{prop:"status",label:"状态",width:"100"},{default:a(t=>[t.row.status==="已读"?(p(),m(c,{key:0,type:"success"},{default:a(()=>[i(r(t.row.status),1)]),_:2},1024)):(p(),m(c,{key:1,type:"warning"},{default:a(()=>[i(r(t.row.status),1)]),_:2},1024))]),_:1}),l(v,{prop:"readTime",label:"阅读时间","min-width":"150"}),l(v,{prop:"ipAddress",label:"IP地址",width:"120"})]),_:1},8,["data"])]),_:1})])):L("",!0)]),_:1},8,["modelValue"]),l(P,{modelValue:h.value,"onUpdate:modelValue":e[10]||(e[10]=t=>h.value=t),title:U.value,width:"800px","before-close":te},{footer:a(()=>[u("div",$e,[l(f,{onClick:W},{default:a(()=>e[36]||(e[36]=[i("保存草稿")])),_:1,__:[36]}),l(f,{onClick:e[9]||(e[9]=t=>h.value=!1)},{default:a(()=>e[37]||(e[37]=[i("取消")])),_:1,__:[37]}),l(f,{type:"primary",onClick:Q},{default:a(()=>e[38]||(e[38]=[i("发布通知")])),_:1,__:[38]})])]),default:a(()=>[l(se,{model:n.value,rules:O,ref_key:"notificationFormRef",ref:$,"label-width":"120px"},{default:a(()=>[l(k,{label:"通知标题",prop:"title"},{default:a(()=>[l(j,{modelValue:n.value.title,"onUpdate:modelValue":e[2]||(e[2]=t=>n.value.title=t),placeholder:"请输入通知标题"},null,8,["modelValue"])]),_:1}),l(k,{label:"通知类别",prop:"category"},{default:a(()=>[l(E,{modelValue:n.value.category,"onUpdate:modelValue":e[3]||(e[3]=t=>n.value.category=t),placeholder:"请选择通知类别",style:{width:"100%"}},{default:a(()=>[l(g,{label:"公司公告",value:"公司公告"}),l(g,{label:"部门通知",value:"部门通知"}),l(g,{label:"系统通知",value:"系统通知"}),l(g,{label:"活动通知",value:"活动通知"}),l(g,{label:"其他",value:"其他"})]),_:1},8,["modelValue"])]),_:1}),l(k,{label:"优先级",prop:"priority"},{default:a(()=>[l(ie,{modelValue:n.value.priority,"onUpdate:modelValue":e[4]||(e[4]=t=>n.value.priority=t)},{default:a(()=>[l(B,{label:"低"},{default:a(()=>e[29]||(e[29]=[i("低")])),_:1,__:[29]}),l(B,{label:"中"},{default:a(()=>e[30]||(e[30]=[i("中")])),_:1,__:[30]}),l(B,{label:"高"},{default:a(()=>e[31]||(e[31]=[i("高")])),_:1,__:[31]})]),_:1},8,["modelValue"])]),_:1}),l(k,{label:"接收部门",prop:"targetDepartments"},{default:a(()=>[l(E,{modelValue:n.value.targetDepartments,"onUpdate:modelValue":e[5]||(e[5]=t=>n.value.targetDepartments=t),multiple:"",placeholder:"请选择接收部门",style:{width:"100%"}},{default:a(()=>[l(g,{label:"技术部",value:"技术部"}),l(g,{label:"人事部",value:"人事部"}),l(g,{label:"财务部",value:"财务部"}),l(g,{label:"市场部",value:"市场部"}),l(g,{label:"行政部",value:"行政部"})]),_:1},8,["modelValue"])]),_:1}),l(k,{label:"通知内容",prop:"content"},{default:a(()=>[l(j,{modelValue:n.value.content,"onUpdate:modelValue":e[6]||(e[6]=t=>n.value.content=t),type:"textarea",rows:6,placeholder:"请输入通知内容"},null,8,["modelValue"])]),_:1}),l(k,{label:"附件"},{default:a(()=>[l(re,{class:"upload-demo",action:"#","auto-upload":!1,"on-change":le,"file-list":A.value,multiple:""},{tip:a(()=>e[33]||(e[33]=[u("div",{class:"el-upload__tip"}," 支持jpg/png/pdf/doc/docx文件，且不超过10MB ",-1)])),default:a(()=>[l(f,{type:"primary"},{default:a(()=>e[32]||(e[32]=[i("选择文件")])),_:1,__:[32]})]),_:1},8,["file-list"])]),_:1}),l(k,{label:"发布设置"},{default:a(()=>[l(J,{modelValue:n.value.urgent,"onUpdate:modelValue":e[7]||(e[7]=t=>n.value.urgent=t)},{default:a(()=>e[34]||(e[34]=[i("紧急通知")])),_:1,__:[34]},8,["modelValue"]),l(J,{modelValue:n.value.requireConfirm,"onUpdate:modelValue":e[8]||(e[8]=t=>n.value.requireConfirm=t)},{default:a(()=>e[35]||(e[35]=[i("需要确认")])),_:1,__:[35]},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),l(P,{modelValue:q.value,"onUpdate:modelValue":e[11]||(e[11]=t=>q.value=t),title:"已读状态详情",width:"800px","before-close":ue},{default:a(()=>[_.value?(p(),S("div",qe,[l(de,{column:2,border:""},{default:a(()=>[l(C,{label:"通知标题"},{default:a(()=>[i(r(_.value.title),1)]),_:1}),l(C,{label:"发布人"},{default:a(()=>[i(r(_.value.publisher),1)]),_:1}),l(C,{label:"发布时间"},{default:a(()=>[i(r(_.value.publishTime),1)]),_:1}),l(C,{label:"总人数"},{default:a(()=>[i(r(_.value.totalCount),1)]),_:1}),l(C,{label:"已读人数"},{default:a(()=>[i(r(_.value.readCount),1)]),_:1}),l(C,{label:"未读人数"},{default:a(()=>[i(r(_.value.unreadCount),1)]),_:1})]),_:1}),u("div",ze,[l(V,{gutter:20},{default:a(()=>[l(b,{span:8},{default:a(()=>[u("div",Ae,[u("div",De,r(_.value.readCount),1),e[39]||(e[39]=u("div",{class:"status-label"},"已读",-1))])]),_:1}),l(b,{span:8},{default:a(()=>[u("div",Me,[u("div",Pe,r(_.value.unreadCount),1),e[40]||(e[40]=u("div",{class:"status-label"},"未读",-1))])]),_:1}),l(b,{span:8},{default:a(()=>[u("div",Be,[u("div",Re,r(_.value.readRate)+"%",1),e[41]||(e[41]=u("div",{class:"status-label"},"已读率",-1))])]),_:1})]),_:1})])])):L("",!0)]),_:1},8,["modelValue"])])}}},je=oe(Se,[["__scopeId","data-v-c2935bb3"]]);export{je as default};
