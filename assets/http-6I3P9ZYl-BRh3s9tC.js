import{S as i}from"./axios-DWwaMX5J-DXTQ3iZI.js";import{V as n,J as c,ak as l}from"./index-CrbR1nZg.js";class p{constructor(){const a="https://luke-hill16.github.io/api";this.instance=i.create({baseURL:a,timeout:6e4}),this.instance.interceptors.request.use(s=>{const t=n().token;return t&&(s.headers.Authorization="JWT "+t),s}),this.instance.interceptors.response.use(s=>s,s=>{var t;if(((t=s.response)==null?void 0:t.status)===403){const o=n();c.error("登录已过期，请重新登录"),o.clearUserToken(),l.push("/login")}return Promise.reject(s)})}post(a,s){return new Promise(async(t,o)=>{try{let e=await this.instance.post(a,s);console.log(e),t(e.data)}catch(e){console.log("请求出错:",e);let r=e.response&&e.response.data&&e.response.data.detail?e.response.data.detail:e.message||"未知错误";o(r)}})}get(a,s){return new Promise(async(t,o)=>{try{let e=await this.instance.get(a,s);t(e.data)}catch(e){console.log("请求出错:",e);let r=e.response&&e.response.data&&e.response.data.detail?e.response.data.detail:e.message||"未知错误";o(r)}})}}const g=new p;export{g};
