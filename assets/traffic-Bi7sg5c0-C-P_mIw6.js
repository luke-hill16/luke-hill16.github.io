import{Y as k,_ as I,R as fe,K as me,r as s,a9 as ve,I as q,p as Y,a as d,C as e,c as a,D as w,ab as ge,e as u,aa as _e,v as be,o as r,N as ye,ag as he,j as Ve,F as we,a5 as $,n as ke,P as Ce,Q as De,X as Ue,J as P}from"./index-CrbR1nZg.js";import{s as ze}from"./plugin-vue_export-helper-DlAUqK2U-lGy7RumW.js";const xe={class:"traffic-container"},Se={class:"page-header"},Me={class:"header-actions"},Te={class:"overview-section"},Ie={class:"card-content"},Pe={class:"card-icon primary"},je={class:"card-info"},Oe={class:"card-value"},Re={class:"card-content"},qe={class:"card-icon success"},Fe={class:"card-info"},Le={class:"card-value"},Ae={class:"card-content"},Be={class:"card-icon warning"},Ge={class:"card-info"},Ke={class:"card-value"},Ne={class:"card-content"},Xe={class:"card-icon info"},Ye={class:"card-info"},$e={class:"card-value"},Je={class:"search-section"},Qe={class:"traffic-list"},Ee={class:"pagination-container"},We={class:"dialog-footer"},Ze={key:0,class:"traffic-detail"},He={__name:"traffic",setup(ea){const J=k(!1),j=k(!1),C=k(!1),O=k(!1),z=k(),p=k(null),h=I({name:"",type:"",status:""}),m=I({currentPage:1,pageSize:10,total:0}),i=I({id:null,name:"",type:"",location:"",length:0,capacity:"",status:"normal",buildDate:"",lastMaintenance:"",description:""}),Q={name:[{required:!0,message:"请输入设施名称",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"}],type:[{required:!0,message:"请选择设施类型",trigger:"change"}],location:[{required:!0,message:"请输入设施位置",trigger:"blur"}],length:[{required:!0,message:"请输入设施长度",trigger:"blur"}],capacity:[{required:!0,message:"请输入通行能力",trigger:"blur"}]},V=I({totalRoads:0,totalVehicles:0,totalAccidents:0,totalSignals:0}),v=k([{id:1,name:"长安街",type:"road",location:"北京市中心",length:3.8,capacity:"双向八车道",status:"normal",buildDate:"1950-01-01",lastMaintenance:"2024-01-15",description:"北京市最重要的东西向主干道，连接天安门广场",createTime:"2020-01-01 10:00:00"},{id:2,name:"二环路",type:"road",location:"北京市二环",length:32.7,capacity:"双向六车道",status:"normal",buildDate:"1980-01-01",lastMaintenance:"2024-02-01",description:"北京市重要的环形主干道",createTime:"2020-01-01 10:00:00"},{id:3,name:"长安街信号灯系统",type:"signal",location:"长安街沿线",length:0,capacity:"智能控制",status:"normal",buildDate:"2010-01-01",lastMaintenance:"2024-01-20",description:"智能交通信号灯系统，实现绿波带控制",createTime:"2020-01-01 10:00:00"},{id:4,name:"西直门立交桥",type:"bridge",location:"西直门地区",length:1.2,capacity:"双向四车道",status:"maintenance",buildDate:"1995-01-01",lastMaintenance:"2024-03-01",description:"重要的交通枢纽立交桥",createTime:"2020-01-01 10:00:00"},{id:5,name:"王府井停车场",type:"parking",location:"王府井商业区",length:0,capacity:"500个车位",status:"normal",buildDate:"2005-01-01",lastMaintenance:"2024-01-10",description:"王府井商业区地下停车场",createTime:"2020-01-01 10:00:00"}]),E=fe(()=>i.id?"编辑交通设施":"添加交通设施"),F=n=>({road:"道路",bridge:"桥梁",tunnel:"隧道",signal:"信号灯",parking:"停车场"})[n]||"未知",L=n=>({road:"primary",bridge:"success",tunnel:"warning",signal:"info",parking:"danger"})[n]||"",A=n=>({normal:"正常",maintenance:"维护中",fault:"故障",construction:"建设中"})[n]||"未知",B=n=>({normal:"success",maintenance:"warning",fault:"danger",construction:"info"})[n]||"",W=n=>n.toLocaleString(),Z=()=>{i.id=null,C.value=!0},H=n=>{Object.assign(i,n),C.value=!0},ee=n=>{p.value=n,O.value=!0},ae=async n=>{try{await Ue.confirm(`确定要删除交通设施"${n.name}"吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const l=v.value.findIndex(f=>f.id===n.id);l>-1&&(v.value.splice(l,1),R(),P.success("删除成功"))}catch{}},le=async()=>{if(z.value)try{if(await z.value.validate(),j.value=!0,await new Promise(n=>setTimeout(n,1e3)),i.id){const n=v.value.findIndex(l=>l.id===i.id);n>-1&&(v.value[n]={...i}),P.success("编辑成功")}else{const n={...i,id:Date.now(),createTime:new Date().toLocaleString()};v.value.unshift(n),P.success("添加成功")}R(),C.value=!1,G()}catch(n){console.error("表单验证失败:",n)}finally{j.value=!1}},G=()=>{z.value&&z.value.resetFields(),Object.assign(i,{id:null,name:"",type:"",location:"",length:0,capacity:"",status:"normal",buildDate:"",lastMaintenance:"",description:""})},D=()=>{m.currentPage=1,console.log("搜索条件:",h)},te=()=>{Object.assign(h,{name:"",type:"",status:""}),D()},ne=n=>{m.pageSize=n},de=n=>{m.currentPage=n},ie=()=>{P.success("交通设施数据导出成功")},R=()=>{V.totalRoads=v.value.filter(n=>n.type==="road").length,V.totalVehicles=15e5,V.totalAccidents=25,V.totalSignals=v.value.filter(n=>n.type==="signal").length};return me(()=>{R(),m.total=v.value.length}),(n,l)=>{const f=s("el-icon"),g=s("el-button"),S=s("el-card"),c=s("el-col"),U=s("el-row"),x=s("el-input"),o=s("el-option"),M=s("el-select"),_=s("el-table-column"),T=s("el-tag"),ue=s("el-table"),se=s("el-pagination"),b=s("el-form-item"),oe=s("el-input-number"),K=s("el-date-picker"),ce=s("el-form"),N=s("el-dialog"),y=s("el-descriptions-item"),re=s("el-descriptions"),pe=ve("loading");return q(),Y("div",xe,[d("div",Se,[l[19]||(l[19]=d("h2",null,"交通管理系统",-1)),d("div",Me,[e(g,{type:"success",onClick:ie},{default:a(()=>[e(f,null,{default:a(()=>[e(w(ge))]),_:1}),l[17]||(l[17]=u(" 导出数据 "))]),_:1,__:[17]}),e(g,{type:"primary",onClick:Z},{default:a(()=>[e(f,null,{default:a(()=>[e(w(_e))]),_:1}),l[18]||(l[18]=u(" 添加设施 "))]),_:1,__:[18]})])]),d("div",Te,[e(U,{gutter:20},{default:a(()=>[e(c,{span:6},{default:a(()=>[e(S,{class:"overview-card"},{default:a(()=>[d("div",Ie,[d("div",Pe,[e(f,null,{default:a(()=>[e(w(be))]),_:1})]),d("div",je,[l[20]||(l[20]=d("div",{class:"card-title"},"道路总数",-1)),d("div",Oe,r(V.totalRoads),1)])])]),_:1})]),_:1}),e(c,{span:6},{default:a(()=>[e(S,{class:"overview-card"},{default:a(()=>[d("div",Re,[d("div",qe,[e(f,null,{default:a(()=>[e(w(ye))]),_:1})]),d("div",Fe,[l[21]||(l[21]=d("div",{class:"card-title"},"车辆流量",-1)),d("div",Le,r(W(V.totalVehicles)),1)])])]),_:1})]),_:1}),e(c,{span:6},{default:a(()=>[e(S,{class:"overview-card"},{default:a(()=>[d("div",Ae,[d("div",Be,[e(f,null,{default:a(()=>[e(w(he))]),_:1})]),d("div",Ge,[l[22]||(l[22]=d("div",{class:"card-title"},"事故数量",-1)),d("div",Ke,r(V.totalAccidents),1)])])]),_:1})]),_:1}),e(c,{span:6},{default:a(()=>[e(S,{class:"overview-card"},{default:a(()=>[d("div",Ne,[d("div",Xe,[e(f,null,{default:a(()=>[e(w(Ve))]),_:1})]),d("div",Ye,[l[23]||(l[23]=d("div",{class:"card-title"},"信号灯",-1)),d("div",$e,r(V.totalSignals),1)])])]),_:1})]),_:1})]),_:1})]),d("div",Je,[e(U,{gutter:20},{default:a(()=>[e(c,{span:6},{default:a(()=>[e(x,{modelValue:h.name,"onUpdate:modelValue":l[0]||(l[0]=t=>h.name=t),placeholder:"设施名称",clearable:"",onClear:D,onKeyup:we(D,["enter"])},{prefix:a(()=>[e(f,null,{default:a(()=>[e(w($))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(c,{span:6},{default:a(()=>[e(M,{modelValue:h.type,"onUpdate:modelValue":l[1]||(l[1]=t=>h.type=t),placeholder:"设施类型",clearable:"",onChange:D},{default:a(()=>[e(o,{label:"道路",value:"road"}),e(o,{label:"桥梁",value:"bridge"}),e(o,{label:"隧道",value:"tunnel"}),e(o,{label:"信号灯",value:"signal"}),e(o,{label:"停车场",value:"parking"})]),_:1},8,["modelValue"])]),_:1}),e(c,{span:6},{default:a(()=>[e(M,{modelValue:h.status,"onUpdate:modelValue":l[2]||(l[2]=t=>h.status=t),placeholder:"设施状态",clearable:"",onChange:D},{default:a(()=>[e(o,{label:"正常",value:"normal"}),e(o,{label:"维护中",value:"maintenance"}),e(o,{label:"故障",value:"fault"}),e(o,{label:"建设中",value:"construction"})]),_:1},8,["modelValue"])]),_:1}),e(c,{span:6},{default:a(()=>[e(g,{type:"primary",onClick:D},{default:a(()=>[e(f,null,{default:a(()=>[e(w($))]),_:1}),l[24]||(l[24]=u(" 搜索 "))]),_:1,__:[24]}),e(g,{onClick:te},{default:a(()=>l[25]||(l[25]=[u("重置")])),_:1,__:[25]})]),_:1})]),_:1})]),d("div",Qe,[ke((q(),Ce(ue,{data:v.value,stripe:""},{default:a(()=>[e(_,{prop:"id",label:"ID",width:"80"}),e(_,{prop:"name",label:"设施名称"}),e(_,{prop:"type",label:"设施类型",width:"100"},{default:a(t=>[e(T,{type:L(t.row.type)},{default:a(()=>[u(r(F(t.row.type)),1)]),_:2},1032,["type"])]),_:1}),e(_,{prop:"location",label:"位置"}),e(_,{prop:"length",label:"长度(km)",width:"100"}),e(_,{prop:"capacity",label:"通行能力",width:"120"}),e(_,{prop:"status",label:"状态",width:"100"},{default:a(t=>[e(T,{type:B(t.row.status)},{default:a(()=>[u(r(A(t.row.status)),1)]),_:2},1032,["type"])]),_:1}),e(_,{prop:"lastMaintenance",label:"最后维护",width:"120"}),e(_,{label:"操作",width:"200",fixed:"right"},{default:a(t=>[e(g,{size:"small",onClick:X=>ee(t.row)},{default:a(()=>l[26]||(l[26]=[u("查看")])),_:2,__:[26]},1032,["onClick"]),e(g,{size:"small",type:"primary",onClick:X=>H(t.row)},{default:a(()=>l[27]||(l[27]=[u("编辑")])),_:2,__:[27]},1032,["onClick"]),e(g,{size:"small",type:"danger",onClick:X=>ae(t.row)},{default:a(()=>l[28]||(l[28]=[u("删除")])),_:2,__:[28]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[pe,J.value]]),d("div",Ee,[e(se,{"current-page":m.currentPage,"onUpdate:currentPage":l[3]||(l[3]=t=>m.currentPage=t),"page-size":m.pageSize,"onUpdate:pageSize":l[4]||(l[4]=t=>m.pageSize=t),"page-sizes":[10,20,50,100],total:m.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:ne,onCurrentChange:de},null,8,["current-page","page-size","total"])])]),e(N,{modelValue:C.value,"onUpdate:modelValue":l[15]||(l[15]=t=>C.value=t),title:E.value,width:"700px",onClose:G},{footer:a(()=>[d("div",We,[e(g,{onClick:l[14]||(l[14]=t=>C.value=!1)},{default:a(()=>l[29]||(l[29]=[u("取消")])),_:1,__:[29]}),e(g,{type:"primary",onClick:le,loading:j.value},{default:a(()=>l[30]||(l[30]=[u("确定")])),_:1,__:[30]},8,["loading"])])]),default:a(()=>[e(ce,{model:i,rules:Q,ref_key:"trafficFormRef",ref:z,"label-width":"120px"},{default:a(()=>[e(U,{gutter:20},{default:a(()=>[e(c,{span:12},{default:a(()=>[e(b,{label:"设施名称",prop:"name"},{default:a(()=>[e(x,{modelValue:i.name,"onUpdate:modelValue":l[5]||(l[5]=t=>i.name=t),placeholder:"请输入设施名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{span:12},{default:a(()=>[e(b,{label:"设施类型",prop:"type"},{default:a(()=>[e(M,{modelValue:i.type,"onUpdate:modelValue":l[6]||(l[6]=t=>i.type=t),placeholder:"请选择设施类型",style:{width:"100%"}},{default:a(()=>[e(o,{label:"道路",value:"road"}),e(o,{label:"桥梁",value:"bridge"}),e(o,{label:"隧道",value:"tunnel"}),e(o,{label:"信号灯",value:"signal"}),e(o,{label:"停车场",value:"parking"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(U,{gutter:20},{default:a(()=>[e(c,{span:12},{default:a(()=>[e(b,{label:"位置",prop:"location"},{default:a(()=>[e(x,{modelValue:i.location,"onUpdate:modelValue":l[7]||(l[7]=t=>i.location=t),placeholder:"请输入设施位置"},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{span:12},{default:a(()=>[e(b,{label:"长度(km)",prop:"length"},{default:a(()=>[e(oe,{modelValue:i.length,"onUpdate:modelValue":l[8]||(l[8]=t=>i.length=t),min:0,precision:2,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(U,{gutter:20},{default:a(()=>[e(c,{span:12},{default:a(()=>[e(b,{label:"通行能力",prop:"capacity"},{default:a(()=>[e(x,{modelValue:i.capacity,"onUpdate:modelValue":l[9]||(l[9]=t=>i.capacity=t),placeholder:"如：双向四车道"},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{span:12},{default:a(()=>[e(b,{label:"设施状态",prop:"status"},{default:a(()=>[e(M,{modelValue:i.status,"onUpdate:modelValue":l[10]||(l[10]=t=>i.status=t),placeholder:"请选择设施状态",style:{width:"100%"}},{default:a(()=>[e(o,{label:"正常",value:"normal"}),e(o,{label:"维护中",value:"maintenance"}),e(o,{label:"故障",value:"fault"}),e(o,{label:"建设中",value:"construction"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(U,{gutter:20},{default:a(()=>[e(c,{span:12},{default:a(()=>[e(b,{label:"建设时间",prop:"buildDate"},{default:a(()=>[e(K,{modelValue:i.buildDate,"onUpdate:modelValue":l[11]||(l[11]=t=>i.buildDate=t),type:"date",placeholder:"选择建设时间",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{span:12},{default:a(()=>[e(b,{label:"最后维护",prop:"lastMaintenance"},{default:a(()=>[e(K,{modelValue:i.lastMaintenance,"onUpdate:modelValue":l[12]||(l[12]=t=>i.lastMaintenance=t),type:"date",placeholder:"选择最后维护时间",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(b,{label:"设施描述",prop:"description"},{default:a(()=>[e(x,{modelValue:i.description,"onUpdate:modelValue":l[13]||(l[13]=t=>i.description=t),type:"textarea",rows:3,placeholder:"请输入设施描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),e(N,{modelValue:O.value,"onUpdate:modelValue":l[16]||(l[16]=t=>O.value=t),title:"交通设施详情",width:"800px"},{default:a(()=>[p.value?(q(),Y("div",Ze,[e(re,{column:2,border:""},{default:a(()=>[e(y,{label:"设施名称"},{default:a(()=>[u(r(p.value.name),1)]),_:1}),e(y,{label:"设施类型"},{default:a(()=>[e(T,{type:L(p.value.type)},{default:a(()=>[u(r(F(p.value.type)),1)]),_:1},8,["type"])]),_:1}),e(y,{label:"位置"},{default:a(()=>[u(r(p.value.location),1)]),_:1}),e(y,{label:"长度"},{default:a(()=>[u(r(p.value.length)+" km",1)]),_:1}),e(y,{label:"通行能力"},{default:a(()=>[u(r(p.value.capacity),1)]),_:1}),e(y,{label:"设施状态"},{default:a(()=>[e(T,{type:B(p.value.status)},{default:a(()=>[u(r(A(p.value.status)),1)]),_:1},8,["type"])]),_:1}),e(y,{label:"建设时间"},{default:a(()=>[u(r(p.value.buildDate),1)]),_:1}),e(y,{label:"最后维护"},{default:a(()=>[u(r(p.value.lastMaintenance),1)]),_:1}),e(y,{label:"设施描述",span:2},{default:a(()=>[u(r(p.value.description||"暂无描述"),1)]),_:1})]),_:1})])):De("",!0)]),_:1},8,["modelValue"])])}}},ta=ze(He,[["__scopeId","data-v-6fb2a1f1"]]);export{ta as default};
