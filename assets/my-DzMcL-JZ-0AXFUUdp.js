import{B as J}from"./OAPageHeader-ByDRAfLF-6Vu92mKD.js";import{g as v}from"./http-6I3P9ZYl-BRh3s9tC.js";import{Y as y,_ as z,R as K,K as N,J as L,p as Y,C as l,c as a,D as s,u as T,a as h,T as q,f as Z,r as n,I as _,e as r,y as W,P as f,o as Q}from"./index-CrbR1nZg.js";import"./axios-DWwaMX5J-DXTQ3iZI.js";const X=()=>v.get("/absent/type"),ee=()=>v.get("/absent/responder"),le=V=>v.post("/absent/absent",V),te=V=>v.get("/absent/absent?who=my"),w={getAbhsentTypes:X,getResponder:ee,applyAbsent:le,getMyAbsents:te},ae={style:{"text-align":"right"}},de={class:"dialog-footer"},oe={class:"demo-pagination-block",style:{display:"flex","align-items":"right","justify-content":"right"}},ne=Z({name:"my_abhosentt"}),pe=Object.assign(ne,{setup(V){let u=y(!1),C=y([]),g=z({email:"",realname:""}),k=y([]),D=K(()=>g.email?"["+g.email+"]"+g.realname:"无"),o=z({title:"",absent_type_id:null,date_range:[],request_content:""});const j=()=>{o.title="",o.absent_type_id=null,o.date_range=[],o.request_content="",u.value=!0};let R=z({title:[{required:!0,message:"请输入标题！",trigger:"blur"}],absent_type_id:[{required:!0,message:"请选择请假类型！",trigger:"change"}],date_range:[{required:!0,message:"请选择请假时间！",trigger:"blur"}],request_content:[{required:!0,message:"请输入请假理由！",trigger:"blur"}]}),M=y();const O=()=>{M.value.validate(async(d,e)=>{if(d){let p={title:o.title,absent_type_id:o.absent_type_id,start_date:o.date_range[0],end_date:o.date_range[1],request_content:o.request_content};try{let m=await w.applyAbsent(p);console.log(m),u.value=!1}catch(m){L.error(m)}}})};return N(async()=>{try{let d=await w.getAbhsentTypes();C.value=d;let e=await w.getResponder();Object.assign(g,e);let p=await w.getMyAbsents();k.value=p,console.log(k.value)}catch(d){L.error(d)}}),(d,e)=>{const p=n("el-input"),m=n("el-option"),U=n("el-select"),b=n("el-button"),P=n("Plus"),S=n("el-icon"),A=n("el-card"),$=n("el-space"),c=n("el-form-item"),G=n("el-date-picker"),I=n("el-form"),B=n("el-dialog"),i=n("el-table-column"),x=n("el-tag"),E=n("el-table"),F=n("el-pagination");return _(),Y(q,null,[l($,{direction:"vertical",fill:"",size:20,style:{width:"100%"}},{default:a(()=>[l(J,{content:"个人考勤"}),l(A,{style:{"border-bottom":"1px solid#fff"},shadow:"none"},{default:a(()=>[e[12]||(e[12]=r(" 邮箱")),l(p,{modelValue:d.input,"onUpdate:modelValue":e[0]||(e[0]=t=>d.input=t),style:{width:"240px","text-align":"left",margin:"20px"},placeholder:"Please input"},null,8,["modelValue"]),e[13]||(e[13]=r(" 姓名")),l(p,{modelValue:d.input,"onUpdate:modelValue":e[1]||(e[1]=t=>d.input=t),style:{width:"240px","text-align":"left",margin:"20px"},placeholder:"Please input"},null,8,["modelValue"]),e[14]||(e[14]=r(" 地址")),l(U,{modelValue:d.value,"onUpdate:modelValue":e[2]||(e[2]=t=>d.value=t),placeholder:"Select",size:"middle",style:{width:"240px",margin:"20px"}},{default:a(()=>[(_(!0),Y(q,null,W(d.options,t=>(_(),f(m,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),l(b,{type:"primary"},{default:a(()=>e[9]||(e[9]=[r("编辑")])),_:1,__:[9]}),l(b,null,{default:a(()=>e[10]||(e[10]=[r("重置")])),_:1,__:[10]}),h("div",ae,[l(b,{type:"primary",onClick:j},{default:a(()=>[l(S,null,{default:a(()=>[l(P)]),_:1}),e[11]||(e[11]=r("发起考勤"))]),_:1,__:[11]})])]),_:1,__:[12,13,14]})]),_:1}),l(B,{modelValue:s(u),"onUpdate:modelValue":e[8]||(e[8]=t=>T(u)?u.value=t:u=t),title:"发起考勤",width:"600"},{footer:a(()=>[h("div",de,[l(b,{onClick:e[7]||(e[7]=t=>T(u)?u.value=!1:u=!1)},{default:a(()=>e[15]||(e[15]=[r("取消")])),_:1,__:[15]}),l(b,{type:"primary",onClick:O},{default:a(()=>e[16]||(e[16]=[r(" 确定 ")])),_:1,__:[16]})])]),default:a(()=>[l(I,{model:s(o),rules:s(R),ref_key:"absentFormRef",ref:M},{default:a(()=>[l(c,{label:"标题","label-width":d.formLabelWidth,prop:"title"},{default:a(()=>[l(p,{modelValue:s(o).title,"onUpdate:modelValue":e[3]||(e[3]=t=>s(o).title=t),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(c,{label:"请假类型","label-width":d.formLabelWidth,prop:"absent_type_id"},{default:a(()=>[l(U,{modelValue:s(o).absent_type_id,"onUpdate:modelValue":e[4]||(e[4]=t=>s(o).absent_type_id=t),placeholder:"请选择请假类型"},{default:a(()=>[(_(!0),Y(q,null,W(s(C),t=>(_(),f(m,{label:t.name,value:t.id,key:t.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label-width"]),l(c,{label:"起止日期","label-width":d.formLabelWidth,prop:"date_range"},{default:a(()=>[l(G,{modelValue:s(o).date_range,"onUpdate:modelValue":e[5]||(e[5]=t=>s(o).date_range=t),type:"daterange","range-separator":"到","start-placeholder":"起始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(c,{label:"审批人","label-width":d.formLabelWidth},{default:a(()=>[l(p,{value:s(D),readonly:"",disabled:"",autocomplete:"off"},null,8,["value"])]),_:1},8,["label-width"]),l(c,{label:"请假理由","label-width":d.formLabelWidth,prop:"request_content"},{default:a(()=>[l(p,{type:"textarea",modelValue:s(o).request_content,"onUpdate:modelValue":e[6]||(e[6]=t=>s(o).request_content=t),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),l(A,null,{default:a(()=>[l(E,{data:s(k),stripe:"",style:{width:"100%"},"default-sort":{prop:"date",order:"descending"},fit:"False"},{default:a(()=>[l(i,{type:"selection",selectable:d.selectable,width:"55"},null,8,["selectable"]),l(i,{type:"index",width:"50"}),l(i,{prop:"title",label:"标题",sortable:""}),l(i,{prop:"absent_type.name",label:"类型"}),l(i,{prop:"request_content",label:"原因"}),l(i,{prop:"start_date",label:"开始时间",sortable:""}),l(i,{prop:"end_date",label:"结束时间"}),l(i,{prop:"create_time.format('YYYY-MM-DD')",label:"发起它的时间"}),l(i,{label:"审核领导"},{default:a(()=>[r(Q(s(D)),1)]),_:1}),l(i,{prop:"response_content",label:"反馈意见"}),l(i,{label:"审核状态"},{default:a(t=>[t.row.status==1?(_(),f(x,{key:0,type:"info"},{default:a(()=>e[17]||(e[17]=[r("审核中")])),_:1,__:[17]})):t.row.status==2?(_(),f(x,{key:1,type:"success"},{default:a(()=>e[18]||(e[18]=[r("已通过")])),_:1,__:[18]})):(_(),f(x,{key:2,type:"danger"},{default:a(()=>e[19]||(e[19]=[r("已拒绝")])),_:1,__:[19]}))]),_:1}),l(i,{label:"Operations"},{default:a(t=>[l(b,{size:"small",type:"primary",onClick:H=>d.handleEdit(t.$index,t.row)},{default:a(()=>e[20]||(e[20]=[r(" 编辑 ")])),_:2,__:[20]},1032,["onClick"]),l(b,{size:"small",type:"primary",onClick:H=>d.handleDelete(t.$index,t.row)},{default:a(()=>e[21]||(e[21]=[r(" 删除 ")])),_:2,__:[21]},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),h("div",oe,[e[22]||(e[22]=h("div",{class:"demonstration"},null,-1)),l(F,{"page-sizes":[100,200,300,400],size:d.size,disabled:d.disabled,background:d.background,layout:"total, sizes, prev, pager, next, jumper",total:400,onSizeChange:d.handleSizeChange},null,8,["size","disabled","background","onSizeChange"])])],64)}}});export{pe as default};
