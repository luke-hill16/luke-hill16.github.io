import{r as g,X as q,z as V,P as e,H as l,u as n,l as K,O as Q,x as ye,ag as i,y as A,L as u,A as a,I as be,Q as Ce,M as b,a4 as ke,C as Ve,a5 as Ae,aA as De,n as D}from"./vue-vendor-CnY5n9_A.js";import{h as Ie,c as he,a as ze,u as X,m as G,f as R,t as $e,b as Se,d as B,e as Te,g as Le,j as S,l as J,s as Ne,k as Me,n as Y,o as Ue,p as qe,q as Re,r as Be,v as Ee,w as He,x as Oe,y as Pe,z as E}from"./element-plus-B_exy3hO.js";import{u as We}from"./index-NiQ5wmz2.js";import{h as H}from"./http-C-_XONwZ.js";/* empty css                                                                    */import{_ as Fe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./axios-DWwaMX5J.js";const je=(c,_)=>H.post("/auth/login",{email:c,password:_}),Ke=(c,_,f)=>H.post("/auth/resetpwd",{oldpwd:c,pwd1:_,pwd2:f}),Qe={login:je,resetPwd:Ke},Xe=c=>H.post("/chat/",{message:c}),Z={chatWithAI:Xe},Ge={class:"left-header"},Je={class:"right-header"},Ye={class:"el-dropdown-link"},Ze={style:{"margin-left":"10px"}},et={class:"dialog-footer"},tt={class:"chat-container"},lt={class:"chat-sidebar"},nt={class:"sidebar-menu"},st={class:"chat-main"},at={key:0,class:"message user-message"},ot={class:"message-content"},ut={class:"message-text"},dt={class:"message-time"},it={class:"message-avatar"},rt={key:1,class:"message ai-message"},mt={class:"message-avatar"},ft={class:"message-content"},pt={class:"message-text"},_t={class:"message-time"},gt={class:"chat-input-area"},vt={class:"input-container"},wt={class:"input-actions"},ct=ye({name:"frame"}),xt=Object.assign(ct,{setup(c){let _="140px",f=g(!1),r=q({oldpwd:"",pwd1:"",pwd2:""}),O=g(),ee=q({oldpwd:[{required:!0,message:"旧密码",trigger:"blur"},{min:6,max:20,message:"Length should be 6 to 20",trigger:"blur"}],pwd1:[{required:!0,message:"新密码",trigger:"blur"},{min:6,max:20,message:"Length should be 6 to 20",trigger:"blur"}],pwd2:[{required:!0,message:"确认密码",trigger:"blur"},{min:6,max:20,message:"Length should be 6 to 20",trigger:"blur"}]});const T=We(),te=De(),I=g(!1),v=g(""),h=g(!1),z=g(null),le=g(""),w=q([{type:"ai",content:"您好！我是AI智能助手，有什么可以帮助您的吗？",timestamp:new Date}]),ne=()=>{I.value=!0,D(()=>{C()})},se=()=>{I.value=!1,v.value=""},P=async()=>{if(!v.value.trim()||h.value)return;const m=v.value.trim();w.push({type:"user",content:m,timestamp:new Date}),v.value="",h.value=!0,await D(),C();try{const t=await Z.chatWithAI(m);w.push({type:"ai",content:t.reply,timestamp:new Date})}catch(t){console.error("AI接口调用失败:",t),w.push({type:"ai",content:"抱歉，AI服务暂时不可用，请稍后再试。",timestamp:new Date})}finally{h.value=!1,D(()=>{C()})}},C=()=>{z.value&&(z.value.scrollTop=z.value.scrollHeight)},W=m=>{const t=new Date(m),p=new Date,s=p-t;return s<6e4?"刚刚":s<36e5?`${Math.floor(s/6e4)}分钟前`:t.toDateString()===p.toDateString()?t.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}):t.toLocaleDateString("zh-CN")+" "+t.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"})},x=async m=>{const p={policy:"政策库",enterprise:"企业库",regulation:"法规库",standard:"标准库",case:"案例库",help:"帮助中心"}[m]||"未知功能",s=`我想查看${p}`;w.push({type:"user",content:s,timestamp:new Date}),D(()=>{C()});try{const d=await Z.chatWithAI(s);w.push({type:"ai",content:d.reply,timestamp:new Date})}catch(d){console.error("AI接口调用失败:",d),w.push({type:"ai",content:`好的，我来为您打开${p}。这里是${p}的相关信息，您可以根据需要进行查询和浏览。`,timestamp:new Date})}D(()=>{C()})},ae=()=>{T.clearUserToken(),te.push({name:"login"})},oe=()=>{r.oldpwd="",r.pwd1="",r.pwd2="",f.value=!0},ue=()=>{O.value.validate(async(m,t)=>{if(m)try{await Qe.resetPwd(r.oldpwd,r.pwd1,r.pwd2),E.success("密码修改成功"),f.value=!1}catch(p){E.error(p)}else E.info("字段校验失败!"),console.log("字段校验失败!");console.log(t)}),f.value=!1},de=(m,t)=>{console.log(m,t)},ie=(m,t)=>{console.log(m,t)},L=g(!1),re=()=>{L.value=!L.value};return(m,t)=>{const p=i("router-link"),s=i("el-icon"),d=i("el-menu-item"),k=i("el-sub-menu"),me=i("el-menu"),fe=i("el-aside"),y=i("el-button"),N=i("el-avatar"),M=i("el-dropdown-item"),pe=i("el-dropdown-menu"),_e=i("el-dropdown"),ge=i("el-header"),ve=i("RouterView"),we=i("el-main"),F=i("el-container"),$=i("el-input"),U=i("el-form-item"),ce=i("el-form"),j=i("el-dialog");return A(),V(Q,null,[e(F,{class:"container"},{default:l(()=>[e(fe,{class:"aside",width:"250px"},{default:l(()=>[e(p,{to:"/",class:"brand"},{default:l(()=>t[13]||(t[13]=[u("益客管理系统")])),_:1,__:[13]}),e(me,{router:!0,"default-active":m.$route.name,class:"el-menu-vertical-demo",onOpen:de,onClose:ie},{default:l(()=>[e(d,{index:"home",route:{name:"home"}},{title:l(()=>[e(s,null,{default:l(()=>[e(n(Ie))]),_:1}),t[14]||(t[14]=a("span",null,"首页",-1))]),_:1}),e(k,{index:"2"},{title:l(()=>[e(s,null,{default:l(()=>[e(n(he))]),_:1}),t[15]||(t[15]=a("span",null,"考勤管理",-1))]),default:l(()=>[e(d,{index:"myabsent",route:{name:"myabsent"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(ze))]),_:1}),t[16]||(t[16]=u("个人管理"))]),_:1,__:[16]}),e(d,{index:"subabsent",route:{name:"subabsent"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(X))]),_:1}),t[17]||(t[17]=u("下属考勤"))]),_:1,__:[17]}),e(d,{index:"expense-rd",route:{name:"expense-rd"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(G))]),_:1}),t[18]||(t[18]=u("研发费用管理"))]),_:1,__:[18]})]),_:1}),e(k,{index:"3"},{title:l(()=>[e(s,null,{default:l(()=>[e(n(R))]),_:1}),t[19]||(t[19]=a("span",null,"通知管理",-1))]),default:l(()=>[e(d,{index:"notification",route:{name:"notification"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n($e))]),_:1}),t[20]||(t[20]=u("发布通的知"))]),_:1,__:[20]}),e(d,{index:"video-monitor",route:{name:"video-monitor"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(Se))]),_:1}),t[21]||(t[21]=u("通知列的表"))]),_:1,__:[21]}),e(d,{index:"expense-rd2",route:{name:"expense-rd2"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(G))]),_:1}),t[22]||(t[22]=u("研发费用管理2"))]),_:1,__:[22]})]),_:1}),e(k,{index:"5"},{title:l(()=>[e(s,null,{default:l(()=>[e(n(B))]),_:1}),t[23]||(t[23]=a("span",null,"员工管理",-1))]),default:l(()=>[e(d,{index:"exam",route:{name:"exam"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(Te))]),_:1}),t[24]||(t[24]=u("员工通的知"))]),_:1,__:[24]}),e(d,{index:"employee",route:{name:"employee"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(Le))]),_:1}),t[25]||(t[25]=u("员工列的表"))]),_:1,__:[25]}),e(d,{index:"filemanage",route:{name:"filemanage"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(R))]),_:1}),t[26]||(t[26]=u("员工管的理"))]),_:1,__:[26]})]),_:1}),e(k,{index:"6"},{title:l(()=>[e(s,null,{default:l(()=>[e(n(B))]),_:1}),t[27]||(t[27]=a("span",null,"智慧农业",-1))]),default:l(()=>[e(d,{index:"agriculture",route:{name:"agriculture"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(S))]),_:1}),t[28]||(t[28]=u("农业管理"))]),_:1,__:[28]}),e(d,{index:"building",route:{name:"building"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(S))]),_:1}),t[29]||(t[29]=u("建筑管理"))]),_:1,__:[29]}),e(d,{index:"language",route:{name:"language"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(S))]),_:1}),t[30]||(t[30]=u("语言管理"))]),_:1,__:[30]}),e(d,{index:"district",route:{name:"district"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(J))]),_:1}),t[31]||(t[31]=u("区县管理"))]),_:1,__:[31]}),e(d,{index:"traffic",route:{name:"traffic"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(J))]),_:1}),t[32]||(t[32]=u("交通管理"))]),_:1,__:[32]})]),_:1}),e(k,{index:"16"},{title:l(()=>[e(s,null,{default:l(()=>[e(n(B))]),_:1}),t[33]||(t[33]=a("span",null,"智慧工信",-1))]),default:l(()=>[e(d,{index:"industry",route:{name:"industry"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(S))]),_:1}),t[34]||(t[34]=u("工信管理"))]),_:1,__:[34]}),e(d,{index:"education",route:{name:"education"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(Ne))]),_:1}),t[35]||(t[35]=u("教育管理"))]),_:1,__:[35]}),e(d,{index:"enterprise",route:{name:"enterprise"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(Me))]),_:1}),t[36]||(t[36]=u("企业管理"))]),_:1,__:[36]})]),_:1})]),_:1},8,["default-active"])]),_:1}),e(F,null,{default:l(()=>[e(ge,{class:"header"},{default:l(()=>[a("div",Ge,[e(y,null,{default:l(()=>[e(s,null,{default:l(()=>[e(n(Y))]),_:1})]),_:1})]),be(e(y,{icon:n(Y),onClick:re},null,8,["icon"]),[[Ce,L.value]]),a("div",Je,[e(y,{class:"ai-button",type:"primary",size:"small",onClick:ne,style:{"margin-right":"15px"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(Ue))]),_:1}),t[37]||(t[37]=u(" AI助手 "))]),_:1,__:[37]}),e(_e,null,{dropdown:l(()=>[e(pe,null,{default:l(()=>[e(M,{onClick:oe},{default:l(()=>t[38]||(t[38]=[u("修改密码")])),_:1,__:[38]}),e(M,null,{default:l(()=>t[39]||(t[39]=[u("个人中心")])),_:1,__:[39]}),e(M,{divided:"",onClick:ae},{default:l(()=>t[40]||(t[40]=[u("退出登录")])),_:1,__:[40]})]),_:1})]),default:l(()=>[a("span",Ye,[e(N,{size:30,icon:"UserFilled"}),a("span",Ze,"("+b(n(T).user.department.name)+")"+b(n(T).user.realname),1),e(s,{class:"el-icon--right"},{default:l(()=>[e(n(qe))]),_:1})])]),_:1})])]),_:1}),e(we,{class:"main"},{default:l(()=>[e(ve)]),_:1})]),_:1})]),_:1}),e(j,{modelValue:n(f),"onUpdate:modelValue":t[4]||(t[4]=o=>K(f)?f.value=o:f=o),title:"修改密码",width:"500"},{footer:l(()=>[a("div",et,[e(y,{onClick:t[3]||(t[3]=o=>K(f)?f.value=!1:f=!1)},{default:l(()=>t[41]||(t[41]=[u("取消")])),_:1,__:[41]}),e(y,{type:"primary",onClick:ue},{default:l(()=>t[42]||(t[42]=[u(" 确认 ")])),_:1,__:[42]})])]),default:l(()=>[e(ce,{model:n(r),rules:n(ee),ref_key:"formTag",ref:O},{default:l(()=>[e(U,{label:"旧密码","label-width":n(_),prop:"oldpwd"},{default:l(()=>[e($,{modelValue:n(r).oldpwd,"onUpdate:modelValue":t[0]||(t[0]=o=>n(r).oldpwd=o),autocomplete:"off",type:"password"},null,8,["modelValue"])]),_:1},8,["label-width"]),e(U,{label:"新密码","label-width":n(_),prop:"pwd1"},{default:l(()=>[e($,{modelValue:n(r).pwd1,"onUpdate:modelValue":t[1]||(t[1]=o=>n(r).pwd1=o),autocomplete:"off",type:"password"},null,8,["modelValue"])]),_:1},8,["label-width"]),e(U,{label:"确认密码","label-width":n(_),prop:"pwd2"},{default:l(()=>[e($,{modelValue:n(r).pwd2,"onUpdate:modelValue":t[2]||(t[2]=o=>n(r).pwd2=o),autocomplete:"off",type:"password"},null,8,["modelValue"])]),_:1},8,["label-width"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),e(j,{modelValue:I.value,"onUpdate:modelValue":t[12]||(t[12]=o=>I.value=o),title:"AI智能助手",width:"800px","before-close":se,class:"ai-chat-dialog",draggable:""},{default:l(()=>[a("div",tt,[a("div",lt,[a("div",nt,[a("div",{class:"menu-item",onClick:t[5]||(t[5]=o=>x("policy"))},[e(s,null,{default:l(()=>[e(n(Re))]),_:1}),t[43]||(t[43]=a("span",null,"政策库",-1))]),a("div",{class:"menu-item",onClick:t[6]||(t[6]=o=>x("enterprise"))},[e(s,null,{default:l(()=>[e(n(Be))]),_:1}),t[44]||(t[44]=a("span",null,"企业库",-1))]),a("div",{class:"menu-item",onClick:t[7]||(t[7]=o=>x("regulation"))},[e(s,null,{default:l(()=>[e(n(Ee))]),_:1}),t[45]||(t[45]=a("span",null,"法规库",-1))]),a("div",{class:"menu-item",onClick:t[8]||(t[8]=o=>x("standard"))},[e(s,null,{default:l(()=>[e(n(He))]),_:1}),t[46]||(t[46]=a("span",null,"标准库",-1))]),a("div",{class:"menu-item",onClick:t[9]||(t[9]=o=>x("case"))},[e(s,null,{default:l(()=>[e(n(R))]),_:1}),t[47]||(t[47]=a("span",null,"案例库",-1))]),a("div",{class:"menu-item",onClick:t[10]||(t[10]=o=>x("help"))},[e(s,null,{default:l(()=>[e(n(Oe))]),_:1}),t[48]||(t[48]=a("span",null,"帮助中心",-1))])])]),a("div",st,[a("div",{class:"chat-messages",ref_key:"messagesContainer",ref:z},[(A(!0),V(Q,null,ke(w,(o,xe)=>(A(),V("div",{key:xe,class:Ve(["message-item",o.type])},[o.type==="user"?(A(),V("div",at,[a("div",ot,[a("div",ut,b(o.content),1),a("div",dt,b(W(o.timestamp)),1)]),a("div",it,[e(N,{size:40,src:le.value},{default:l(()=>[e(s,null,{default:l(()=>[e(n(X))]),_:1})]),_:1},8,["src"])])])):(A(),V("div",rt,[a("div",mt,[e(N,{size:40,class:"ai-avatar"},{default:l(()=>[e(s,null,{default:l(()=>[e(n(Pe))]),_:1})]),_:1})]),a("div",ft,[a("div",pt,b(o.content),1),a("div",_t,b(W(o.timestamp)),1)])]))],2))),128))],512),a("div",gt,[a("div",vt,[e($,{modelValue:v.value,"onUpdate:modelValue":t[11]||(t[11]=o=>v.value=o),type:"textarea",rows:3,placeholder:"请输入您的问题...",onKeydown:Ae(P,["enter"]),resize:"none"},null,8,["modelValue"]),a("div",wt,[t[50]||(t[50]=a("span",{class:"input-tip"},"Enter 发送",-1)),e(y,{type:"primary",onClick:P,loading:h.value,disabled:!v.value.trim()},{default:l(()=>t[49]||(t[49]=[u(" 发送 ")])),_:1,__:[49]},8,["loading","disabled"])])])])])])]),_:1},8,["modelValue"])],64)}}}),It=Fe(xt,[["__scopeId","data-v-35e213e1"]]);export{It as default};
