import{L as _,w as M,X as ye,$ as V,Y as e,J as t,s as a,z as Q,D as Y,T as xe,d as be,r as i,b as C,a as d,A as ke,M as s,I as Ve,_ as Ce,c as E,G as F,S as X,e as Ie,i as $e,B as q,f as Ae,g as De,Z as T,m as J,H as ze,h as Te,y as R,Q as Ue,j as Le,k as Se,l as x,n as Ne,N as Be,o as Me,p as Xe,q as qe,K as Ge,t as He,V as Ke,u as Oe,v as We,x as I,C as G}from"./index-q8LaeBoo.js";import{m as H}from"./http-C-_XONwZ-BI6Pfl8z-m3MqG1D0.js";import{r as je}from"./_plugin-vue_export-helper-DlAUqK2U-lGy7RumW-DNI5evPq.js";import"./axios-DWwaMX5J-DXTQ3iZI-BeByrt0G.js";const Pe=(w,f)=>H.post("/auth/login",{email:w,password:f}),Qe=(w,f,p)=>H.post("/auth/resetpwd",{oldpwd:w,pwd1:f,pwd2:p}),Ye={login:Pe,resetPwd:Qe},Ee=w=>H.post("/chat/",{message:w}),Z={chatWithAI:Ee},Fe={class:"left-header"},Je={class:"right-header"},Re={class:"el-dropdown-link"},Ze={style:{"margin-left":"10px"}},el={class:"dialog-footer"},ll={class:"chat-container"},tl={class:"chat-sidebar"},al={class:"sidebar-menu"},nl={class:"chat-main"},sl={key:0,class:"message user-message"},ul={class:"message-content"},dl={class:"message-text"},il={class:"message-time"},ol={class:"message-avatar"},rl={key:1,class:"message ai-message"},ml={class:"message-avatar"},pl={class:"message-content"},cl={class:"message-text"},_l={class:"message-time"},fl={class:"chat-input-area"},gl={class:"input-container"},vl={class:"input-actions"},wl=xe({name:"frame"}),hl=Object.assign(wl,{setup(w){let f="140px",p=_(!1),m=M({oldpwd:"",pwd1:"",pwd2:""}),K=_(),ee=M({oldpwd:[{required:!0,message:"旧密码",trigger:"blur"},{min:6,max:20,message:"Length should be 6 to 20",trigger:"blur"}],pwd1:[{required:!0,message:"新密码",trigger:"blur"},{min:6,max:20,message:"Length should be 6 to 20",trigger:"blur"}],pwd2:[{required:!0,message:"确认密码",trigger:"blur"},{min:6,max:20,message:"Length should be 6 to 20",trigger:"blur"}]});const U=ye(),le=be(),$=_(!1),g=_(""),A=_(!1),D=_(null),te=_(""),v=M([{type:"ai",content:"您好！我是AI智能助手，有什么可以帮助您的吗？",timestamp:new Date}]),ae=()=>{$.value=!0,I(()=>{b()})},ne=()=>{$.value=!1,g.value=""},O=async()=>{if(!g.value.trim()||A.value)return;const r=g.value.trim();v.push({type:"user",content:r,timestamp:new Date}),g.value="",A.value=!0,await I(),b();try{const l=await Z.chatWithAI(r);v.push({type:"ai",content:l.reply,timestamp:new Date})}catch(l){console.error("AI接口调用失败:",l),v.push({type:"ai",content:"抱歉，AI服务暂时不可用，请稍后再试。",timestamp:new Date})}finally{A.value=!1,I(()=>{b()})}},b=()=>{D.value&&(D.value.scrollTop=D.value.scrollHeight)},W=r=>{const l=new Date(r),c=new Date,n=c-l;return n<6e4?"刚刚":n<36e5?`${Math.floor(n/6e4)}分钟前`:l.toDateString()===c.toDateString()?l.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}):l.toLocaleDateString("zh-CN")+" "+l.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"})},h=async r=>{const l={policy:"政策库",enterprise:"企业库",regulation:"法规库",standard:"标准库",case:"案例库",help:"帮助中心"}[r]||"未知功能",c=`我想查看${l}`;v.push({type:"user",content:c,timestamp:new Date}),I(()=>{b()});try{const n=await Z.chatWithAI(c);v.push({type:"ai",content:n.reply,timestamp:new Date})}catch(n){console.error("AI接口调用失败:",n),v.push({type:"ai",content:`好的，我来为您打开${l}。这里是${l}的相关信息，您可以根据需要进行查询和浏览。`,timestamp:new Date})}I(()=>{b()})},se=()=>{U.clearUserToken(),le.push({name:"login"})},ue=()=>{m.oldpwd="",m.pwd1="",m.pwd2="",p.value=!0},de=()=>{K.value.validate(async(r,l)=>{if(r)try{await Ye.resetPwd(m.oldpwd,m.pwd1,m.pwd2),G.success("密码修改成功"),p.value=!1}catch(c){G.error(c)}else G.info("字段校验失败!"),console.log("字段校验失败!");console.log(l)}),p.value=!1},ie=(r,l)=>{console.log(r,l)},oe=(r,l)=>{console.log(r,l)},L=_(!1),re=()=>{L.value=!L.value};return(r,l)=>{const c=i("router-link"),n=i("el-icon"),o=i("el-menu-item"),k=i("el-sub-menu"),me=i("el-menu"),pe=i("el-aside"),y=i("el-button"),S=i("el-avatar"),N=i("el-dropdown-item"),ce=i("el-dropdown-menu"),_e=i("el-dropdown"),fe=i("el-header"),ge=i("RouterView"),ve=i("el-main"),j=i("el-container"),z=i("el-input"),B=i("el-form-item"),we=i("el-form"),P=i("el-dialog");return C(),V(Y,null,[e(j,{class:"container"},{default:t(()=>[e(pe,{class:"aside",width:"250px"},{default:t(()=>[e(c,{to:"/",class:"brand"},{default:t(()=>l[13]||(l[13]=[d("益客管理系统")])),_:1,__:[13]}),e(me,{router:!0,"default-active":r.$route.name,class:"el-menu-vertical-demo",onOpen:ie,onClose:oe},{default:t(()=>[e(o,{index:"home",route:{name:"home"}},{title:t(()=>[e(n,null,{default:t(()=>[e(a(ke))]),_:1}),l[14]||(l[14]=s("span",null,"首页",-1))]),_:1}),e(k,{index:"2"},{title:t(()=>[e(n,null,{default:t(()=>[e(a(Ve))]),_:1}),l[15]||(l[15]=s("span",null,"考勤管理",-1))]),default:t(()=>[e(o,{index:"myabsent",route:{name:"myabsent"}},{default:t(()=>[e(n,null,{default:t(()=>[e(a(Ce))]),_:1}),l[16]||(l[16]=d("个人管理"))]),_:1,__:[16]}),e(o,{index:"subabsent",route:{name:"subabsent"}},{default:t(()=>[e(n,null,{default:t(()=>[e(a(E))]),_:1}),l[17]||(l[17]=d("下属考勤"))]),_:1,__:[17]}),e(o,{index:"expense-rd",route:{name:"expense-rd"}},{default:t(()=>[e(n,null,{default:t(()=>[e(a(F))]),_:1}),l[18]||(l[18]=d("研发费用管理"))]),_:1,__:[18]})]),_:1}),e(k,{index:"3"},{title:t(()=>[e(n,null,{default:t(()=>[e(a(X))]),_:1}),l[19]||(l[19]=s("span",null,"通知管理",-1))]),default:t(()=>[e(o,{index:"notification",route:{name:"notification"}},{default:t(()=>[e(n,null,{default:t(()=>[e(a(Ie))]),_:1}),l[20]||(l[20]=d("发布通的知"))]),_:1,__:[20]}),e(o,{index:"video-monitor",route:{name:"video-monitor"}},{default:t(()=>[e(n,null,{default:t(()=>[e(a($e))]),_:1}),l[21]||(l[21]=d("通知列的表"))]),_:1,__:[21]}),e(o,{index:"expense-rd2",route:{name:"expense-rd2"}},{default:t(()=>[e(n,null,{default:t(()=>[e(a(F))]),_:1}),l[22]||(l[22]=d("研发费用管理2"))]),_:1,__:[22]})]),_:1}),e(k,{index:"5"},{title:t(()=>[e(n,null,{default:t(()=>[e(a(q))]),_:1}),l[23]||(l[23]=s("span",null,"员工管理",-1))]),default:t(()=>[e(o,{index:"exam",route:{name:"exam"}},{default:t(()=>[e(n,null,{default:t(()=>[e(a(Ae))]),_:1}),l[24]||(l[24]=d("员工通的知"))]),_:1,__:[24]}),e(o,{index:"employee",route:{name:"employee"}},{default:t(()=>[e(n,null,{default:t(()=>[e(a(De))]),_:1}),l[25]||(l[25]=d("员工列的表"))]),_:1,__:[25]}),e(o,{index:"filemanage",route:{name:"filemanage"}},{default:t(()=>[e(n,null,{default:t(()=>[e(a(X))]),_:1}),l[26]||(l[26]=d("员工管的理"))]),_:1,__:[26]})]),_:1}),e(k,{index:"6"},{title:t(()=>[e(n,null,{default:t(()=>[e(a(q))]),_:1}),l[27]||(l[27]=s("span",null,"智慧农业",-1))]),default:t(()=>[e(o,{index:"agriculture",route:{name:"agriculture"}},{default:t(()=>[e(n,null,{default:t(()=>[e(a(T))]),_:1}),l[28]||(l[28]=d("农业管理"))]),_:1,__:[28]}),e(o,{index:"building",route:{name:"building"}},{default:t(()=>[e(n,null,{default:t(()=>[e(a(T))]),_:1}),l[29]||(l[29]=d("建筑管理"))]),_:1,__:[29]}),e(o,{index:"language",route:{name:"language"}},{default:t(()=>[e(n,null,{default:t(()=>[e(a(T))]),_:1}),l[30]||(l[30]=d("语言管理"))]),_:1,__:[30]}),e(o,{index:"district",route:{name:"district"}},{default:t(()=>[e(n,null,{default:t(()=>[e(a(J))]),_:1}),l[31]||(l[31]=d("区县管理"))]),_:1,__:[31]}),e(o,{index:"traffic",route:{name:"traffic"}},{default:t(()=>[e(n,null,{default:t(()=>[e(a(J))]),_:1}),l[32]||(l[32]=d("交通管理"))]),_:1,__:[32]})]),_:1}),e(k,{index:"16"},{title:t(()=>[e(n,null,{default:t(()=>[e(a(q))]),_:1}),l[33]||(l[33]=s("span",null,"智慧工信",-1))]),default:t(()=>[e(o,{index:"industry",route:{name:"industry"}},{default:t(()=>[e(n,null,{default:t(()=>[e(a(T))]),_:1}),l[34]||(l[34]=d("工信管理"))]),_:1,__:[34]}),e(o,{index:"education",route:{name:"education"}},{default:t(()=>[e(n,null,{default:t(()=>[e(a(ze))]),_:1}),l[35]||(l[35]=d("教育管理"))]),_:1,__:[35]}),e(o,{index:"enterprise",route:{name:"enterprise"}},{default:t(()=>[e(n,null,{default:t(()=>[e(a(Te))]),_:1}),l[36]||(l[36]=d("企业管理"))]),_:1,__:[36]})]),_:1})]),_:1},8,["default-active"])]),_:1}),e(j,null,{default:t(()=>[e(fe,{class:"header"},{default:t(()=>[s("div",Fe,[e(y,null,{default:t(()=>[e(n,null,{default:t(()=>[e(a(R))]),_:1})]),_:1})]),Ue(e(y,{icon:a(R),onClick:re},null,8,["icon"]),[[Le,L.value]]),s("div",Je,[e(y,{class:"ai-button",type:"primary",size:"small",onClick:ae,style:{"margin-right":"15px"}},{default:t(()=>[e(n,null,{default:t(()=>[e(a(Se))]),_:1}),l[37]||(l[37]=d(" AI助手 "))]),_:1,__:[37]}),e(_e,null,{dropdown:t(()=>[e(ce,null,{default:t(()=>[e(N,{onClick:ue},{default:t(()=>l[38]||(l[38]=[d("修改密码")])),_:1,__:[38]}),e(N,null,{default:t(()=>l[39]||(l[39]=[d("个人中心")])),_:1,__:[39]}),e(N,{divided:"",onClick:se},{default:t(()=>l[40]||(l[40]=[d("退出登录")])),_:1,__:[40]})]),_:1})]),default:t(()=>[s("span",Re,[e(S,{size:30,icon:"UserFilled"}),s("span",Ze,"("+x(a(U).user.department.name)+")"+x(a(U).user.realname),1),e(n,{class:"el-icon--right"},{default:t(()=>[e(a(Ne))]),_:1})])]),_:1})])]),_:1}),e(ve,{class:"main"},{default:t(()=>[e(ge)]),_:1})]),_:1})]),_:1}),e(P,{modelValue:a(p),"onUpdate:modelValue":l[4]||(l[4]=u=>Q(p)?p.value=u:p=u),title:"修改密码",width:"500"},{footer:t(()=>[s("div",el,[e(y,{onClick:l[3]||(l[3]=u=>Q(p)?p.value=!1:p=!1)},{default:t(()=>l[41]||(l[41]=[d("取消")])),_:1,__:[41]}),e(y,{type:"primary",onClick:de},{default:t(()=>l[42]||(l[42]=[d(" 确认 ")])),_:1,__:[42]})])]),default:t(()=>[e(we,{model:a(m),rules:a(ee),ref_key:"formTag",ref:K},{default:t(()=>[e(B,{label:"旧密码","label-width":a(f),prop:"oldpwd"},{default:t(()=>[e(z,{modelValue:a(m).oldpwd,"onUpdate:modelValue":l[0]||(l[0]=u=>a(m).oldpwd=u),autocomplete:"off",type:"password"},null,8,["modelValue"])]),_:1},8,["label-width"]),e(B,{label:"新密码","label-width":a(f),prop:"pwd1"},{default:t(()=>[e(z,{modelValue:a(m).pwd1,"onUpdate:modelValue":l[1]||(l[1]=u=>a(m).pwd1=u),autocomplete:"off",type:"password"},null,8,["modelValue"])]),_:1},8,["label-width"]),e(B,{label:"确认密码","label-width":a(f),prop:"pwd2"},{default:t(()=>[e(z,{modelValue:a(m).pwd2,"onUpdate:modelValue":l[2]||(l[2]=u=>a(m).pwd2=u),autocomplete:"off",type:"password"},null,8,["modelValue"])]),_:1},8,["label-width"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),e(P,{modelValue:$.value,"onUpdate:modelValue":l[12]||(l[12]=u=>$.value=u),title:"AI智能助手",width:"800px","before-close":ne,class:"ai-chat-dialog",draggable:""},{default:t(()=>[s("div",ll,[s("div",tl,[s("div",al,[s("div",{class:"menu-item",onClick:l[5]||(l[5]=u=>h("policy"))},[e(n,null,{default:t(()=>[e(a(Be))]),_:1}),l[43]||(l[43]=s("span",null,"政策库",-1))]),s("div",{class:"menu-item",onClick:l[6]||(l[6]=u=>h("enterprise"))},[e(n,null,{default:t(()=>[e(a(Me))]),_:1}),l[44]||(l[44]=s("span",null,"企业库",-1))]),s("div",{class:"menu-item",onClick:l[7]||(l[7]=u=>h("regulation"))},[e(n,null,{default:t(()=>[e(a(Xe))]),_:1}),l[45]||(l[45]=s("span",null,"法规库",-1))]),s("div",{class:"menu-item",onClick:l[8]||(l[8]=u=>h("standard"))},[e(n,null,{default:t(()=>[e(a(qe))]),_:1}),l[46]||(l[46]=s("span",null,"标准库",-1))]),s("div",{class:"menu-item",onClick:l[9]||(l[9]=u=>h("case"))},[e(n,null,{default:t(()=>[e(a(X))]),_:1}),l[47]||(l[47]=s("span",null,"案例库",-1))]),s("div",{class:"menu-item",onClick:l[10]||(l[10]=u=>h("help"))},[e(n,null,{default:t(()=>[e(a(Ge))]),_:1}),l[48]||(l[48]=s("span",null,"帮助中心",-1))])])]),s("div",nl,[s("div",{class:"chat-messages",ref_key:"messagesContainer",ref:D},[(C(!0),V(Y,null,He(v,(u,he)=>(C(),V("div",{key:he,class:Ke(["message-item",u.type])},[u.type==="user"?(C(),V("div",sl,[s("div",ul,[s("div",dl,x(u.content),1),s("div",il,x(W(u.timestamp)),1)]),s("div",ol,[e(S,{size:40,src:te.value},{default:t(()=>[e(n,null,{default:t(()=>[e(a(E))]),_:1})]),_:1},8,["src"])])])):(C(),V("div",rl,[s("div",ml,[e(S,{size:40,class:"ai-avatar"},{default:t(()=>[e(n,null,{default:t(()=>[e(a(Oe))]),_:1})]),_:1})]),s("div",pl,[s("div",cl,x(u.content),1),s("div",_l,x(W(u.timestamp)),1)])]))],2))),128))],512),s("div",fl,[s("div",gl,[e(z,{modelValue:g.value,"onUpdate:modelValue":l[11]||(l[11]=u=>g.value=u),type:"textarea",rows:3,placeholder:"请输入您的问题...",onKeydown:We(O,["enter"]),resize:"none"},null,8,["modelValue"]),s("div",vl,[l[50]||(l[50]=s("span",{class:"input-tip"},"Enter 发送",-1)),e(y,{type:"primary",onClick:O,loading:A.value,disabled:!g.value.trim()},{default:t(()=>l[49]||(l[49]=[d(" 发送 ")])),_:1,__:[49]},8,["loading","disabled"])])])])])])]),_:1},8,["modelValue"])],64)}}}),Vl=je(hl,[["__scopeId","data-v-35e213e1"]]);export{Vl as default};
