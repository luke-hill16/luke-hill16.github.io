import{r as g,X as q,z as V,P as e,H as l,u as n,l as Q,O as X,x as be,ag as i,y as A,L as o,A as a,I as Ce,Q as ke,M as b,a4 as Ve,C as Ae,a5 as De,aA as Ie,n as D}from"./chunk-CnY5n9_A.js";import{h as ze,c as $e,a as Se,u as G,m as J,f as R,t as Te,b as Le,d as B,e as Ne,g as Me,j as T,l as E,o as Y,s as Ue,k as he,n as Z,p as qe,q as Re,r as Be,v as Ee,w as He,x as Oe,y as Pe,z as H}from"./chunk-BtzBX2c4.js";import{u as We}from"./index-BD43r0wE.js";import{h as O}from"./chunk-EHvQSt5f.js";/* empty css              */import{_ as Fe}from"./chunk-DlAUqK2U.js";import"./chunk-DWwaMX5J.js";const je=(c,_)=>O.post("/auth/login",{email:c,password:_}),Ke=(c,_,f)=>O.post("/auth/resetpwd",{oldpwd:c,pwd1:_,pwd2:f}),Qe={login:je,resetPwd:Ke},Xe=c=>O.post("/chat/",{message:c}),ee={chatWithAI:Xe},Ge={class:"left-header"},Je={class:"right-header"},Ye={class:"el-dropdown-link"},Ze={style:{"margin-left":"10px"}},et={class:"dialog-footer"},tt={class:"chat-container"},lt={class:"chat-sidebar"},nt={class:"sidebar-menu"},st={class:"chat-main"},at={key:0,class:"message user-message"},ot={class:"message-content"},ut={class:"message-text"},dt={class:"message-time"},it={class:"message-avatar"},rt={key:1,class:"message ai-message"},mt={class:"message-avatar"},ft={class:"message-content"},pt={class:"message-text"},_t={class:"message-time"},gt={class:"chat-input-area"},vt={class:"input-container"},wt={class:"input-actions"},ct=be({name:"frame"}),xt=Object.assign(ct,{setup(c){let _="140px",f=g(!1),r=q({oldpwd:"",pwd1:"",pwd2:""}),P=g(),te=q({oldpwd:[{required:!0,message:"旧密码",trigger:"blur"},{min:6,max:20,message:"Length should be 6 to 20",trigger:"blur"}],pwd1:[{required:!0,message:"新密码",trigger:"blur"},{min:6,max:20,message:"Length should be 6 to 20",trigger:"blur"}],pwd2:[{required:!0,message:"确认密码",trigger:"blur"},{min:6,max:20,message:"Length should be 6 to 20",trigger:"blur"}]});const L=We(),le=Ie(),I=g(!1),v=g(""),z=g(!1),$=g(null),ne=g(""),w=q([{type:"ai",content:"您好！我是AI智能助手，有什么可以帮助您的吗？",timestamp:new Date}]),se=()=>{I.value=!0,D(()=>{C()})},ae=()=>{I.value=!1,v.value=""},W=async()=>{if(!v.value.trim()||z.value)return;const m=v.value.trim();w.push({type:"user",content:m,timestamp:new Date}),v.value="",z.value=!0,await D(),C();try{const t=await ee.chatWithAI(m);w.push({type:"ai",content:t.reply,timestamp:new Date})}catch(t){console.error("AI接口调用失败:",t),w.push({type:"ai",content:"抱歉，AI服务暂时不可用，请稍后再试。",timestamp:new Date})}finally{z.value=!1,D(()=>{C()})}},C=()=>{$.value&&($.value.scrollTop=$.value.scrollHeight)},F=m=>{const t=new Date(m),p=new Date,s=p-t;return s<6e4?"刚刚":s<36e5?`${Math.floor(s/6e4)}分钟前`:t.toDateString()===p.toDateString()?t.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}):t.toLocaleDateString("zh-CN")+" "+t.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"})},x=async m=>{const p={policy:"政策库",enterprise:"企业库",regulation:"法规库",standard:"标准库",case:"案例库",help:"帮助中心"}[m]||"未知功能",s=`我想查看${p}`;w.push({type:"user",content:s,timestamp:new Date}),D(()=>{C()});try{const d=await ee.chatWithAI(s);w.push({type:"ai",content:d.reply,timestamp:new Date})}catch(d){console.error("AI接口调用失败:",d),w.push({type:"ai",content:`好的，我来为您打开${p}。这里是${p}的相关信息，您可以根据需要进行查询和浏览。`,timestamp:new Date})}D(()=>{C()})},oe=()=>{L.clearUserToken(),le.push({name:"login"})},ue=()=>{r.oldpwd="",r.pwd1="",r.pwd2="",f.value=!0},de=()=>{P.value.validate(async(m,t)=>{if(m)try{await Qe.resetPwd(r.oldpwd,r.pwd1,r.pwd2),H.success("密码修改成功"),f.value=!1}catch(p){H.error(p)}else H.info("字段校验失败!"),console.log("字段校验失败!");console.log(t)}),f.value=!1},ie=(m,t)=>{console.log(m,t)},re=(m,t)=>{console.log(m,t)},N=g(!1),me=()=>{N.value=!N.value};return(m,t)=>{const p=i("router-link"),s=i("el-icon"),d=i("el-menu-item"),k=i("el-sub-menu"),fe=i("el-menu"),pe=i("el-aside"),y=i("el-button"),M=i("el-avatar"),U=i("el-dropdown-item"),_e=i("el-dropdown-menu"),ge=i("el-dropdown"),ve=i("el-header"),we=i("RouterView"),ce=i("el-main"),j=i("el-container"),S=i("el-input"),h=i("el-form-item"),xe=i("el-form"),K=i("el-dialog");return A(),V(X,null,[e(j,{class:"container"},{default:l(()=>[e(pe,{class:"aside",width:"250px"},{default:l(()=>[e(p,{to:"/",class:"brand"},{default:l(()=>t[13]||(t[13]=[o("益客管理系统")])),_:1,__:[13]}),e(fe,{router:!0,"default-active":m.$route.name,class:"el-menu-vertical-demo",onOpen:ie,onClose:re},{default:l(()=>[e(d,{index:"home",route:{name:"home"}},{title:l(()=>[e(s,null,{default:l(()=>[e(n(ze))]),_:1}),t[14]||(t[14]=a("span",null,"首页",-1))]),_:1}),e(k,{index:"2"},{title:l(()=>[e(s,null,{default:l(()=>[e(n($e))]),_:1}),t[15]||(t[15]=a("span",null,"考勤管理",-1))]),default:l(()=>[e(d,{index:"myabsent",route:{name:"myabsent"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(Se))]),_:1}),t[16]||(t[16]=o("个人管理"))]),_:1,__:[16]}),e(d,{index:"subabsent",route:{name:"subabsent"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(G))]),_:1}),t[17]||(t[17]=o("下属考勤"))]),_:1,__:[17]}),e(d,{index:"expense-rd",route:{name:"expense-rd"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(J))]),_:1}),t[18]||(t[18]=o("研发费用管理"))]),_:1,__:[18]})]),_:1}),e(k,{index:"3"},{title:l(()=>[e(s,null,{default:l(()=>[e(n(R))]),_:1}),t[19]||(t[19]=a("span",null,"通知管理",-1))]),default:l(()=>[e(d,{index:"notification",route:{name:"notification"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(Te))]),_:1}),t[20]||(t[20]=o("发布通的知"))]),_:1,__:[20]}),e(d,{index:"video-monitor",route:{name:"video-monitor"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(Le))]),_:1}),t[21]||(t[21]=o("通知列的表"))]),_:1,__:[21]}),e(d,{index:"expense-rd2",route:{name:"expense-rd2"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(J))]),_:1}),t[22]||(t[22]=o("研发费用管理2"))]),_:1,__:[22]})]),_:1}),e(k,{index:"5"},{title:l(()=>[e(s,null,{default:l(()=>[e(n(B))]),_:1}),t[23]||(t[23]=a("span",null,"员工管理",-1))]),default:l(()=>[e(d,{index:"exam",route:{name:"exam"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(Ne))]),_:1}),t[24]||(t[24]=o("员工通的知"))]),_:1,__:[24]}),e(d,{index:"employee",route:{name:"employee"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(Me))]),_:1}),t[25]||(t[25]=o("员工列的表"))]),_:1,__:[25]}),e(d,{index:"filemanage",route:{name:"filemanage"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(R))]),_:1}),t[26]||(t[26]=o("员工管的理"))]),_:1,__:[26]})]),_:1}),e(k,{index:"6"},{title:l(()=>[e(s,null,{default:l(()=>[e(n(B))]),_:1}),t[27]||(t[27]=a("span",null,"智慧农业",-1))]),default:l(()=>[e(d,{index:"agriculture",route:{name:"agriculture"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(T))]),_:1}),t[28]||(t[28]=o("农业管理"))]),_:1,__:[28]}),e(d,{index:"building",route:{name:"building"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(T))]),_:1}),t[29]||(t[29]=o("建筑管理"))]),_:1,__:[29]}),e(d,{index:"language",route:{name:"language"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(T))]),_:1}),t[30]||(t[30]=o("语言管理"))]),_:1,__:[30]}),e(d,{index:"district",route:{name:"district"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(E))]),_:1}),t[31]||(t[31]=o("区县管理"))]),_:1,__:[31]}),e(d,{index:"traffic",route:{name:"traffic"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(E))]),_:1}),t[32]||(t[32]=o("交通管理"))]),_:1,__:[32]}),e(d,{index:"enterprise-planning",route:{name:"enterprise-planning"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(Y))]),_:1}),t[33]||(t[33]=o("企业规划"))]),_:1,__:[33]}),e(d,{index:"govenment",route:{name:"govenment"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(E))]),_:1}),t[34]||(t[34]=o("政策管理"))]),_:1,__:[34]})]),_:1}),e(k,{index:"16"},{title:l(()=>[e(s,null,{default:l(()=>[e(n(B))]),_:1}),t[35]||(t[35]=a("span",null,"智慧工信",-1))]),default:l(()=>[e(d,{index:"industry",route:{name:"industry"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(T))]),_:1}),t[36]||(t[36]=o("工信管理"))]),_:1,__:[36]}),e(d,{index:"education",route:{name:"education"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(Ue))]),_:1}),t[37]||(t[37]=o("教育管理"))]),_:1,__:[37]}),e(d,{index:"enterprise",route:{name:"enterprise"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(he))]),_:1}),t[38]||(t[38]=o("企业管理"))]),_:1,__:[38]})]),_:1})]),_:1},8,["default-active"])]),_:1}),e(j,null,{default:l(()=>[e(ve,{class:"header"},{default:l(()=>[a("div",Ge,[e(y,null,{default:l(()=>[e(s,null,{default:l(()=>[e(n(Z))]),_:1})]),_:1})]),Ce(e(y,{icon:n(Z),onClick:me},null,8,["icon"]),[[ke,N.value]]),a("div",Je,[e(y,{class:"ai-button",type:"primary",size:"small",onClick:se,style:{"margin-right":"15px"}},{default:l(()=>[e(s,null,{default:l(()=>[e(n(qe))]),_:1}),t[39]||(t[39]=o(" AI助手 "))]),_:1,__:[39]}),e(ge,null,{dropdown:l(()=>[e(_e,null,{default:l(()=>[e(U,{onClick:ue},{default:l(()=>t[40]||(t[40]=[o("修改密码")])),_:1,__:[40]}),e(U,null,{default:l(()=>t[41]||(t[41]=[o("个人中心")])),_:1,__:[41]}),e(U,{divided:"",onClick:oe},{default:l(()=>t[42]||(t[42]=[o("退出登录")])),_:1,__:[42]})]),_:1})]),default:l(()=>[a("span",Ye,[e(M,{size:30,icon:"UserFilled"}),a("span",Ze,"("+b(n(L).user.department.name)+")"+b(n(L).user.realname),1),e(s,{class:"el-icon--right"},{default:l(()=>[e(n(Re))]),_:1})])]),_:1})])]),_:1}),e(ce,{class:"main"},{default:l(()=>[e(we)]),_:1})]),_:1})]),_:1}),e(K,{modelValue:n(f),"onUpdate:modelValue":t[4]||(t[4]=u=>Q(f)?f.value=u:f=u),title:"修改密码",width:"500"},{footer:l(()=>[a("div",et,[e(y,{onClick:t[3]||(t[3]=u=>Q(f)?f.value=!1:f=!1)},{default:l(()=>t[43]||(t[43]=[o("取消")])),_:1,__:[43]}),e(y,{type:"primary",onClick:de},{default:l(()=>t[44]||(t[44]=[o(" 确认 ")])),_:1,__:[44]})])]),default:l(()=>[e(xe,{model:n(r),rules:n(te),ref_key:"formTag",ref:P},{default:l(()=>[e(h,{label:"旧密码","label-width":n(_),prop:"oldpwd"},{default:l(()=>[e(S,{modelValue:n(r).oldpwd,"onUpdate:modelValue":t[0]||(t[0]=u=>n(r).oldpwd=u),autocomplete:"off",type:"password"},null,8,["modelValue"])]),_:1},8,["label-width"]),e(h,{label:"新密码","label-width":n(_),prop:"pwd1"},{default:l(()=>[e(S,{modelValue:n(r).pwd1,"onUpdate:modelValue":t[1]||(t[1]=u=>n(r).pwd1=u),autocomplete:"off",type:"password"},null,8,["modelValue"])]),_:1},8,["label-width"]),e(h,{label:"确认密码","label-width":n(_),prop:"pwd2"},{default:l(()=>[e(S,{modelValue:n(r).pwd2,"onUpdate:modelValue":t[2]||(t[2]=u=>n(r).pwd2=u),autocomplete:"off",type:"password"},null,8,["modelValue"])]),_:1},8,["label-width"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),e(K,{modelValue:I.value,"onUpdate:modelValue":t[12]||(t[12]=u=>I.value=u),title:"AI智能助手",width:"800px","before-close":ae,class:"ai-chat-dialog",draggable:""},{default:l(()=>[a("div",tt,[a("div",lt,[a("div",nt,[a("div",{class:"menu-item",onClick:t[5]||(t[5]=u=>x("policy"))},[e(s,null,{default:l(()=>[e(n(Be))]),_:1}),t[45]||(t[45]=a("span",null,"政策库",-1))]),a("div",{class:"menu-item",onClick:t[6]||(t[6]=u=>x("enterprise"))},[e(s,null,{default:l(()=>[e(n(Y))]),_:1}),t[46]||(t[46]=a("span",null,"企业库",-1))]),a("div",{class:"menu-item",onClick:t[7]||(t[7]=u=>x("regulation"))},[e(s,null,{default:l(()=>[e(n(Ee))]),_:1}),t[47]||(t[47]=a("span",null,"法规库",-1))]),a("div",{class:"menu-item",onClick:t[8]||(t[8]=u=>x("standard"))},[e(s,null,{default:l(()=>[e(n(He))]),_:1}),t[48]||(t[48]=a("span",null,"标准库",-1))]),a("div",{class:"menu-item",onClick:t[9]||(t[9]=u=>x("case"))},[e(s,null,{default:l(()=>[e(n(R))]),_:1}),t[49]||(t[49]=a("span",null,"案例库",-1))]),a("div",{class:"menu-item",onClick:t[10]||(t[10]=u=>x("help"))},[e(s,null,{default:l(()=>[e(n(Oe))]),_:1}),t[50]||(t[50]=a("span",null,"帮助中心",-1))])])]),a("div",st,[a("div",{class:"chat-messages",ref_key:"messagesContainer",ref:$},[(A(!0),V(X,null,Ve(w,(u,ye)=>(A(),V("div",{key:ye,class:Ae(["message-item",u.type])},[u.type==="user"?(A(),V("div",at,[a("div",ot,[a("div",ut,b(u.content),1),a("div",dt,b(F(u.timestamp)),1)]),a("div",it,[e(M,{size:40,src:ne.value},{default:l(()=>[e(s,null,{default:l(()=>[e(n(G))]),_:1})]),_:1},8,["src"])])])):(A(),V("div",rt,[a("div",mt,[e(M,{size:40,class:"ai-avatar"},{default:l(()=>[e(s,null,{default:l(()=>[e(n(Pe))]),_:1})]),_:1})]),a("div",ft,[a("div",pt,b(u.content),1),a("div",_t,b(F(u.timestamp)),1)])]))],2))),128))],512),a("div",gt,[a("div",vt,[e(S,{modelValue:v.value,"onUpdate:modelValue":t[11]||(t[11]=u=>v.value=u),type:"textarea",rows:3,placeholder:"请输入您的问题...",onKeydown:De(W,["enter"]),resize:"none"},null,8,["modelValue"]),a("div",wt,[t[52]||(t[52]=a("span",{class:"input-tip"},"Enter 发送",-1)),e(y,{type:"primary",onClick:W,loading:z.value,disabled:!v.value.trim()},{default:l(()=>t[51]||(t[51]=[o(" 发送 ")])),_:1,__:[51]},8,["loading","disabled"])])])])])])]),_:1},8,["modelValue"])],64)}}}),It=Fe(xt,[["__scopeId","data-v-0718d9f0"]]);export{It as default};
