import{w as i}from"./axios-DWwaMX5J-DXTQ3iZI-BeByrt0G.js";import{X as n,C as c,ak as l}from"./index-q8LaeBoo.js";class p{constructor(){this.instance=i.create({baseURL:"192.168.1.48/api",timeout:6e4}),this.instance.interceptors.request.use(t=>{const s=n().token;return s&&(t.headers.Authorization="JWT "+s),t}),this.instance.interceptors.response.use(t=>t,t=>{var s;if(((s=t.response)==null?void 0:s.status)===403){const a=n();c.error("登录已过期，请重新登录"),a.clearUserToken(),l.push("/login")}return Promise.reject(t)})}post(t,s){return new Promise(async(a,r)=>{try{let e=await this.instance.post(t,s);console.log(e),a(e.data)}catch(e){console.log("请求出错:",e);let o=e.response&&e.response.data&&e.response.data.detail?e.response.data.detail:e.message||"未知错误";r(o)}})}get(t,s){return new Promise(async(a,r)=>{try{let e=await this.instance.get(t,s);a(e.data)}catch(e){console.log("请求出错:",e);let o=e.response&&e.response.data&&e.response.data.detail?e.response.data.detail:e.message||"未知错误";r(o)}})}}const h=new p;export{h as m};
