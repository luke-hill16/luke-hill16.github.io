import{a as i}from"./chunk-DWwaMX5J.js";import{u as n,r as c}from"./index-CZ3MMUEZ.js";import{z as l}from"./chunk-K-HGTUH1.js";class u{constructor(){const a="https://luke-hill16.github.io/api";this.instance=i.create({baseURL:a,timeout:6e4}),this.instance.interceptors.request.use(t=>{const s=n().token;return s&&(t.headers.Authorization="JWT "+s),t}),this.instance.interceptors.response.use(t=>t,t=>{var r;if(((r=t.response)==null?void 0:r.status)===403){const s=n();l.error("登录已过期，请重新登录"),s.clearUserToken(),c.push("/login")}return Promise.reject(t)})}post(a,t){return new Promise(async(r,s)=>{try{let e=await this.instance.post(a,t);console.log(e),r(e.data)}catch(e){console.log("请求出错:",e);let o=e.response&&e.response.data&&e.response.data.detail?e.response.data.detail:e.message||"未知错误";s(o)}})}get(a,t){return new Promise(async(r,s)=>{try{let e=await this.instance.get(a,t);r(e.data)}catch(e){console.log("请求出错:",e);let o=e.response&&e.response.data&&e.response.data.detail?e.response.data.detail:e.message||"未知错误";s(o)}})}}const g=new u;export{g as h};
