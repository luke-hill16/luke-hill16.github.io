import{r as k,X as P,c as _e,k as fe,z as H,A as o,P as e,H as t,I as me,G as ge,ag as d,aq as ve,y as A,u as h,L as i,M as c,a5 as be,K as ye}from"./chunk-CnY5n9_A.js";import{z as B,M as Ve,L as we,r as he,l as ke,R as Ce,j as Me,H as G,A as Te}from"./chunk-BtzBX2c4.js";import{_ as xe}from"./chunk-DlAUqK2U.js";const De={class:"traffic-container"},Se={class:"page-header"},ze={class:"header-actions"},Ue={class:"overview-section"},Pe={class:"card-content"},Be={class:"card-icon primary"},Fe={class:"card-info"},Le={class:"card-value"},qe={class:"card-content"},Ae={class:"card-icon success"},Re={class:"card-info"},je={class:"card-value"},Ie={class:"card-content"},Ne={class:"card-icon warning"},$e={class:"card-info"},Ee={class:"card-value"},Ke={class:"card-content"},Oe={class:"card-icon info"},He={class:"card-info"},Ge={class:"card-value"},Xe={class:"search-section"},Je={class:"traffic-list"},Qe={class:"pagination-container"},We={class:"dialog-footer"},Ye={key:0,class:"traffic-detail"},Ze={__name:"traffic",setup(et){const X=k(!1),F=k(!1),C=k(!1),L=k(!1),x=k(),p=k(null),V=P({name:"",type:"",status:""}),f=P({currentPage:1,pageSize:10,total:0}),s=P({id:null,name:"",type:"",location:"",length:0,capacity:"",status:"normal",buildDate:"",lastMaintenance:"",description:""}),J={name:[{required:!0,message:"请输入设施名称",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"}],type:[{required:!0,message:"请选择设施类型",trigger:"change"}],location:[{required:!0,message:"请输入设施位置",trigger:"blur"}],length:[{required:!0,message:"请输入设施长度",trigger:"blur"}],capacity:[{required:!0,message:"请输入通行能力",trigger:"blur"}]},w=P({totalRoads:0,totalVehicles:0,totalAccidents:0,totalSignals:0}),m=k([{id:1,name:"长安街",type:"road",location:"北京市中心",length:3.8,capacity:"双向八车道",status:"normal",buildDate:"1950-01-01",lastMaintenance:"2024-01-15",description:"北京市最重要的东西向主干道，连接天安门广场",createTime:"2020-01-01 10:00:00"},{id:2,name:"二环路",type:"road",location:"北京市二环",length:32.7,capacity:"双向六车道",status:"normal",buildDate:"1980-01-01",lastMaintenance:"2024-02-01",description:"北京市重要的环形主干道",createTime:"2020-01-01 10:00:00"},{id:3,name:"长安街信号灯系统",type:"signal",location:"长安街沿线",length:0,capacity:"智能控制",status:"normal",buildDate:"2010-01-01",lastMaintenance:"2024-01-20",description:"智能交通信号灯系统，实现绿波带控制",createTime:"2020-01-01 10:00:00"},{id:4,name:"西直门立交桥",type:"bridge",location:"西直门地区",length:1.2,capacity:"双向四车道",status:"maintenance",buildDate:"1995-01-01",lastMaintenance:"2024-03-01",description:"重要的交通枢纽立交桥",createTime:"2020-01-01 10:00:00"},{id:5,name:"王府井停车场",type:"parking",location:"王府井商业区",length:0,capacity:"500个车位",status:"normal",buildDate:"2005-01-01",lastMaintenance:"2024-01-10",description:"王府井商业区地下停车场",createTime:"2020-01-01 10:00:00"}]),Q=_e(()=>s.id?"编辑交通设施":"添加交通设施"),R=n=>({road:"道路",bridge:"桥梁",tunnel:"隧道",signal:"信号灯",parking:"停车场"})[n]||"未知",j=n=>({road:"primary",bridge:"success",tunnel:"warning",signal:"info",parking:"danger"})[n]||"",I=n=>({normal:"正常",maintenance:"维护中",fault:"故障",construction:"建设中"})[n]||"未知",N=n=>({normal:"success",maintenance:"warning",fault:"danger",construction:"info"})[n]||"",W=n=>n.toLocaleString(),Y=()=>{s.id=null,C.value=!0},Z=n=>{Object.assign(s,n),C.value=!0},ee=n=>{p.value=n,L.value=!0},te=async n=>{try{await Te.confirm(`确定要删除交通设施"${n.name}"吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const a=m.value.findIndex(_=>_.id===n.id);a>-1&&(m.value.splice(a,1),q(),B.success("删除成功"))}catch{}},ae=async()=>{if(x.value)try{if(await x.value.validate(),F.value=!0,await new Promise(n=>setTimeout(n,1e3)),s.id){const n=m.value.findIndex(a=>a.id===s.id);n>-1&&(m.value[n]={...s}),B.success("编辑成功")}else{const n={...s,id:Date.now(),createTime:new Date().toLocaleString()};m.value.unshift(n),B.success("添加成功")}q(),C.value=!1,$()}catch(n){console.error("表单验证失败:",n)}finally{F.value=!1}},$=()=>{x.value&&x.value.resetFields(),Object.assign(s,{id:null,name:"",type:"",location:"",length:0,capacity:"",status:"normal",buildDate:"",lastMaintenance:"",description:""})},M=()=>{f.currentPage=1,console.log("搜索条件:",V)},le=()=>{Object.assign(V,{name:"",type:"",status:""}),M()},ne=n=>{f.pageSize=n},oe=n=>{f.currentPage=n},se=()=>{B.success("交通设施数据导出成功")},q=()=>{w.totalRoads=m.value.filter(n=>n.type==="road").length,w.totalVehicles=15e5,w.totalAccidents=25,w.totalSignals=m.value.filter(n=>n.type==="signal").length};return fe(()=>{q(),f.total=m.value.length}),(n,a)=>{const _=d("el-icon"),g=d("el-button"),S=d("el-card"),r=d("el-col"),T=d("el-row"),D=d("el-input"),u=d("el-option"),z=d("el-select"),v=d("el-table-column"),U=d("el-tag"),ie=d("el-table"),de=d("el-pagination"),b=d("el-form-item"),ue=d("el-input-number"),E=d("el-date-picker"),re=d("el-form"),K=d("el-dialog"),y=d("el-descriptions-item"),ce=d("el-descriptions"),pe=ve("loading");return A(),H("div",De,[o("div",Se,[a[19]||(a[19]=o("h2",null,"交通管理系统",-1)),o("div",ze,[e(g,{type:"success",onClick:se},{default:t(()=>[e(_,null,{default:t(()=>[e(h(Ve))]),_:1}),a[17]||(a[17]=i(" 导出数据 "))]),_:1,__:[17]}),e(g,{type:"primary",onClick:Y},{default:t(()=>[e(_,null,{default:t(()=>[e(h(we))]),_:1}),a[18]||(a[18]=i(" 添加设施 "))]),_:1,__:[18]})])]),o("div",Ue,[e(T,{gutter:20},{default:t(()=>[e(r,{span:6},{default:t(()=>[e(S,{class:"overview-card"},{default:t(()=>[o("div",Pe,[o("div",Be,[e(_,null,{default:t(()=>[e(h(he))]),_:1})]),o("div",Fe,[a[20]||(a[20]=o("div",{class:"card-title"},"道路总数",-1)),o("div",Le,c(w.totalRoads),1)])])]),_:1})]),_:1}),e(r,{span:6},{default:t(()=>[e(S,{class:"overview-card"},{default:t(()=>[o("div",qe,[o("div",Ae,[e(_,null,{default:t(()=>[e(h(ke))]),_:1})]),o("div",Re,[a[21]||(a[21]=o("div",{class:"card-title"},"车辆流量",-1)),o("div",je,c(W(w.totalVehicles)),1)])])]),_:1})]),_:1}),e(r,{span:6},{default:t(()=>[e(S,{class:"overview-card"},{default:t(()=>[o("div",Ie,[o("div",Ne,[e(_,null,{default:t(()=>[e(h(Ce))]),_:1})]),o("div",$e,[a[22]||(a[22]=o("div",{class:"card-title"},"事故数量",-1)),o("div",Ee,c(w.totalAccidents),1)])])]),_:1})]),_:1}),e(r,{span:6},{default:t(()=>[e(S,{class:"overview-card"},{default:t(()=>[o("div",Ke,[o("div",Oe,[e(_,null,{default:t(()=>[e(h(Me))]),_:1})]),o("div",He,[a[23]||(a[23]=o("div",{class:"card-title"},"信号灯",-1)),o("div",Ge,c(w.totalSignals),1)])])]),_:1})]),_:1})]),_:1})]),o("div",Xe,[e(T,{gutter:20},{default:t(()=>[e(r,{span:6},{default:t(()=>[e(D,{modelValue:V.name,"onUpdate:modelValue":a[0]||(a[0]=l=>V.name=l),placeholder:"设施名称",clearable:"",onClear:M,onKeyup:be(M,["enter"])},{prefix:t(()=>[e(_,null,{default:t(()=>[e(h(G))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(r,{span:6},{default:t(()=>[e(z,{modelValue:V.type,"onUpdate:modelValue":a[1]||(a[1]=l=>V.type=l),placeholder:"设施类型",clearable:"",onChange:M},{default:t(()=>[e(u,{label:"道路",value:"road"}),e(u,{label:"桥梁",value:"bridge"}),e(u,{label:"隧道",value:"tunnel"}),e(u,{label:"信号灯",value:"signal"}),e(u,{label:"停车场",value:"parking"})]),_:1},8,["modelValue"])]),_:1}),e(r,{span:6},{default:t(()=>[e(z,{modelValue:V.status,"onUpdate:modelValue":a[2]||(a[2]=l=>V.status=l),placeholder:"设施状态",clearable:"",onChange:M},{default:t(()=>[e(u,{label:"正常",value:"normal"}),e(u,{label:"维护中",value:"maintenance"}),e(u,{label:"故障",value:"fault"}),e(u,{label:"建设中",value:"construction"})]),_:1},8,["modelValue"])]),_:1}),e(r,{span:6},{default:t(()=>[e(g,{type:"primary",onClick:M},{default:t(()=>[e(_,null,{default:t(()=>[e(h(G))]),_:1}),a[24]||(a[24]=i(" 搜索 "))]),_:1,__:[24]}),e(g,{onClick:le},{default:t(()=>a[25]||(a[25]=[i("重置")])),_:1,__:[25]})]),_:1})]),_:1})]),o("div",Je,[me((A(),ge(ie,{data:m.value,stripe:""},{default:t(()=>[e(v,{prop:"id",label:"ID",width:"80"}),e(v,{prop:"name",label:"设施名称"}),e(v,{prop:"type",label:"设施类型",width:"100"},{default:t(l=>[e(U,{type:j(l.row.type)},{default:t(()=>[i(c(R(l.row.type)),1)]),_:2},1032,["type"])]),_:1}),e(v,{prop:"location",label:"位置"}),e(v,{prop:"length",label:"长度(km)",width:"100"}),e(v,{prop:"capacity",label:"通行能力",width:"120"}),e(v,{prop:"status",label:"状态",width:"100"},{default:t(l=>[e(U,{type:N(l.row.status)},{default:t(()=>[i(c(I(l.row.status)),1)]),_:2},1032,["type"])]),_:1}),e(v,{prop:"lastMaintenance",label:"最后维护",width:"120"}),e(v,{label:"操作",width:"200",fixed:"right"},{default:t(l=>[e(g,{size:"small",onClick:O=>ee(l.row)},{default:t(()=>a[26]||(a[26]=[i("查看")])),_:2,__:[26]},1032,["onClick"]),e(g,{size:"small",type:"primary",onClick:O=>Z(l.row)},{default:t(()=>a[27]||(a[27]=[i("编辑")])),_:2,__:[27]},1032,["onClick"]),e(g,{size:"small",type:"danger",onClick:O=>te(l.row)},{default:t(()=>a[28]||(a[28]=[i("删除")])),_:2,__:[28]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[pe,X.value]]),o("div",Qe,[e(de,{"current-page":f.currentPage,"onUpdate:currentPage":a[3]||(a[3]=l=>f.currentPage=l),"page-size":f.pageSize,"onUpdate:pageSize":a[4]||(a[4]=l=>f.pageSize=l),"page-sizes":[10,20,50,100],total:f.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:ne,onCurrentChange:oe},null,8,["current-page","page-size","total"])])]),e(K,{modelValue:C.value,"onUpdate:modelValue":a[15]||(a[15]=l=>C.value=l),title:Q.value,width:"700px",onClose:$},{footer:t(()=>[o("div",We,[e(g,{onClick:a[14]||(a[14]=l=>C.value=!1)},{default:t(()=>a[29]||(a[29]=[i("取消")])),_:1,__:[29]}),e(g,{type:"primary",onClick:ae,loading:F.value},{default:t(()=>a[30]||(a[30]=[i("确定")])),_:1,__:[30]},8,["loading"])])]),default:t(()=>[e(re,{model:s,rules:J,ref_key:"trafficFormRef",ref:x,"label-width":"120px"},{default:t(()=>[e(T,{gutter:20},{default:t(()=>[e(r,{span:12},{default:t(()=>[e(b,{label:"设施名称",prop:"name"},{default:t(()=>[e(D,{modelValue:s.name,"onUpdate:modelValue":a[5]||(a[5]=l=>s.name=l),placeholder:"请输入设施名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:t(()=>[e(b,{label:"设施类型",prop:"type"},{default:t(()=>[e(z,{modelValue:s.type,"onUpdate:modelValue":a[6]||(a[6]=l=>s.type=l),placeholder:"请选择设施类型",style:{width:"100%"}},{default:t(()=>[e(u,{label:"道路",value:"road"}),e(u,{label:"桥梁",value:"bridge"}),e(u,{label:"隧道",value:"tunnel"}),e(u,{label:"信号灯",value:"signal"}),e(u,{label:"停车场",value:"parking"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(T,{gutter:20},{default:t(()=>[e(r,{span:12},{default:t(()=>[e(b,{label:"位置",prop:"location"},{default:t(()=>[e(D,{modelValue:s.location,"onUpdate:modelValue":a[7]||(a[7]=l=>s.location=l),placeholder:"请输入设施位置"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:t(()=>[e(b,{label:"长度(km)",prop:"length"},{default:t(()=>[e(ue,{modelValue:s.length,"onUpdate:modelValue":a[8]||(a[8]=l=>s.length=l),min:0,precision:2,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(T,{gutter:20},{default:t(()=>[e(r,{span:12},{default:t(()=>[e(b,{label:"通行能力",prop:"capacity"},{default:t(()=>[e(D,{modelValue:s.capacity,"onUpdate:modelValue":a[9]||(a[9]=l=>s.capacity=l),placeholder:"如：双向四车道"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:t(()=>[e(b,{label:"设施状态",prop:"status"},{default:t(()=>[e(z,{modelValue:s.status,"onUpdate:modelValue":a[10]||(a[10]=l=>s.status=l),placeholder:"请选择设施状态",style:{width:"100%"}},{default:t(()=>[e(u,{label:"正常",value:"normal"}),e(u,{label:"维护中",value:"maintenance"}),e(u,{label:"故障",value:"fault"}),e(u,{label:"建设中",value:"construction"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(T,{gutter:20},{default:t(()=>[e(r,{span:12},{default:t(()=>[e(b,{label:"建设时间",prop:"buildDate"},{default:t(()=>[e(E,{modelValue:s.buildDate,"onUpdate:modelValue":a[11]||(a[11]=l=>s.buildDate=l),type:"date",placeholder:"选择建设时间",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:t(()=>[e(b,{label:"最后维护",prop:"lastMaintenance"},{default:t(()=>[e(E,{modelValue:s.lastMaintenance,"onUpdate:modelValue":a[12]||(a[12]=l=>s.lastMaintenance=l),type:"date",placeholder:"选择最后维护时间",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(b,{label:"设施描述",prop:"description"},{default:t(()=>[e(D,{modelValue:s.description,"onUpdate:modelValue":a[13]||(a[13]=l=>s.description=l),type:"textarea",rows:3,placeholder:"请输入设施描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),e(K,{modelValue:L.value,"onUpdate:modelValue":a[16]||(a[16]=l=>L.value=l),title:"交通设施详情",width:"800px"},{default:t(()=>[p.value?(A(),H("div",Ye,[e(ce,{column:2,border:""},{default:t(()=>[e(y,{label:"设施名称"},{default:t(()=>[i(c(p.value.name),1)]),_:1}),e(y,{label:"设施类型"},{default:t(()=>[e(U,{type:j(p.value.type)},{default:t(()=>[i(c(R(p.value.type)),1)]),_:1},8,["type"])]),_:1}),e(y,{label:"位置"},{default:t(()=>[i(c(p.value.location),1)]),_:1}),e(y,{label:"长度"},{default:t(()=>[i(c(p.value.length)+" km",1)]),_:1}),e(y,{label:"通行能力"},{default:t(()=>[i(c(p.value.capacity),1)]),_:1}),e(y,{label:"设施状态"},{default:t(()=>[e(U,{type:N(p.value.status)},{default:t(()=>[i(c(I(p.value.status)),1)]),_:1},8,["type"])]),_:1}),e(y,{label:"建设时间"},{default:t(()=>[i(c(p.value.buildDate),1)]),_:1}),e(y,{label:"最后维护"},{default:t(()=>[i(c(p.value.lastMaintenance),1)]),_:1}),e(y,{label:"设施描述",span:2},{default:t(()=>[i(c(p.value.description||"暂无描述"),1)]),_:1})]),_:1})])):ye("",!0)]),_:1},8,["modelValue"])])}}},nt=xe(Ze,[["__scopeId","data-v-6fb2a1f1"]]);export{nt as default};
