import{Y as v,_ as M,R as we,K as Ve,r as u,a9 as Ce,I as U,p as q,a as _,C as e,c as l,D as $,aa as xe,e as n,F as ke,a5 as H,n as De,P as Ue,o as g,Q as j,X as Q,J as F,G as ze}from"./index-CrbR1nZg.js";import{s as Se}from"./plugin-vue_export-helper-DlAUqK2U-lGy7RumW.js";const Ie={class:"building-container"},Te={class:"page-header"},Me={class:"search-section"},qe={class:"building-list"},Be={class:"pagination-container"},Oe={class:"dialog-footer"},Pe={key:0,class:"building-detail"},Le={class:"dialog-footer"},Ze={key:0,style:{"margin-top":"16px"}},$e={key:1,style:{"margin-top":"24px"}},je={__name:"building",setup(Fe){const ee=v(!1),B=v(!1),C=v(!1),z=v(!1),k=v(),r=v(null),O=v(!1),i=M({start:"",end:""}),D=v(""),P=v([]),w=M({name:"",status:"",type:""}),y=M({currentPage:1,pageSize:10,total:0}),o=M({id:null,name:"",type:"",address:"",floors:1,area:0,status:"normal",buildDate:"",description:""}),ae={name:[{required:!0,message:"请输入建筑名称",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"}],type:[{required:!0,message:"请选择建筑类型",trigger:"change"}],address:[{required:!0,message:"请输入建筑地址",trigger:"blur"}],floors:[{required:!0,message:"请输入楼层数",trigger:"blur"}],area:[{required:!0,message:"请输入建筑面积",trigger:"blur"}],status:[{required:!0,message:"请选择建筑状态",trigger:"change"}],buildDate:[{required:!0,message:"请选择建成日期",trigger:"change"}]},V=v([{id:1,name:"益客大厦A座",type:"office",address:"北京市朝阳区建国路88号",floors:25,area:15000.5,status:"normal",buildDate:"2020-06-15",description:"现代化办公大楼，配套设施完善",createTime:"2020-01-01 10:00:00"},{id:2,name:"益客住宅小区",type:"residential",address:"北京市海淀区中关村大街100号",floors:18,area:25e3,status:"normal",buildDate:"2019-12-01",description:"高品质住宅小区，环境优美",createTime:"2019-06-01 10:00:00"},{id:3,name:"益客商业中心",type:"commercial",address:"北京市西城区西单大街200号",floors:12,area:18e3,status:"maintenance",buildDate:"2018-08-20",description:"综合性商业中心，交通便利",createTime:"2018-03-01 10:00:00"}]),le=we(()=>o.id?"编辑建筑":"添加建筑"),G=d=>({office:"办公楼",residential:"住宅楼",commercial:"商业楼",industrial:"工业建筑"})[d]||"未知",J=d=>({office:"primary",residential:"success",commercial:"warning",industrial:"info"})[d]||"",R=d=>({normal:"正常",maintenance:"维护中",disabled:"停用"})[d]||"未知",A=d=>({normal:"success",maintenance:"warning",disabled:"danger"})[d]||"",te=()=>{o.id=null,C.value=!0},de=d=>{Object.assign(o,d),C.value=!0},oe=d=>{r.value=d,z.value=!0},ne=async d=>{try{await Q.confirm(`确定要删除建筑"${d.name}"吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const a=V.value.findIndex(c=>c.id===d.id);a>-1&&(V.value.splice(a,1),F.success("删除成功"))}catch{}},ie=async()=>{if(k.value)try{if(await k.value.validate(),B.value=!0,await new Promise(d=>setTimeout(d,1e3)),o.id){const d=V.value.findIndex(a=>a.id===o.id);d>-1&&(V.value[d]={...o}),F.success("编辑成功")}else{const d={...o,id:Date.now(),createTime:new Date().toLocaleString()};V.value.unshift(d),F.success("添加成功")}C.value=!1,N()}catch(d){console.error("表单验证失败:",d)}finally{B.value=!1}},N=()=>{k.value&&k.value.resetFields(),Object.assign(o,{id:null,name:"",type:"",address:"",floors:1,area:0,status:"normal",buildDate:"",description:""})},x=()=>{y.currentPage=1,console.log("搜索条件:",w)},ue=()=>{Object.assign(w,{name:"",status:"",type:""}),x()},re=d=>{y.pageSize=d},se=d=>{y.currentPage=d};function pe(){var d;i.start="",i.end=((d=r.value)==null?void 0:d.address)||"",D.value="",O.value=!0,ze(()=>{me()}),K()}function E(){if(!i.start||!i.end){D.value="请填写起点和终点";return}const d=new window.BMap.Map("baiduMapContainer");d.centerAndZoom(i.end,14),d.enableScrollWheelZoom(!0),new window.BMap.DrivingRoute(d,{renderOptions:{map:d,autoViewport:!0}}).search(i.start,i.end),D.value=`已为您规划从【${i.start}】到【${i.end}】的路径`,fe({start:i.start,end:i.end,time:new Date().toLocaleString()}),K()}function ce(d){i.start=d.start,i.end=d.end,E()}function me(){const d=new window.BMap.Map("baiduMapContainer");d.centerAndZoom(i.end||"北京",12),d.enableScrollWheelZoom(!0),d.clearOverlays(),d.addEventListener("click",function(a){const c=a.point;new window.BMap.Geocoder().getLocation(c,function(s){const b=s.address;Q({title:"地图点选",message:`将【${b}】设为起点还是终点？`,showCancelButton:!0,confirmButtonText:"起点",cancelButtonText:"终点"}).then(()=>{i.start=b}).catch(()=>{i.end=b})})})}function fe(d){const a="building_route_history";let c=JSON.parse(localStorage.getItem(a)||"[]");c.unshift(d),c.length>10&&(c=c.slice(0,10)),localStorage.setItem(a,JSON.stringify(c))}function K(){const d="building_route_history";P.value=JSON.parse(localStorage.getItem(d)||"[]")}return Ve(()=>{y.total=V.value.length}),(d,a)=>{const c=u("el-icon"),s=u("el-button"),b=u("el-input"),S=u("el-col"),p=u("el-option"),I=u("el-select"),_e=u("el-row"),m=u("el-table-column"),T=u("el-tag"),W=u("el-table"),ge=u("el-pagination"),f=u("el-form-item"),X=u("el-input-number"),be=u("el-date-picker"),Y=u("el-form"),L=u("el-dialog"),h=u("el-descriptions-item"),ve=u("el-descriptions"),ye=u("el-alert"),he=Ce("loading");return U(),q("div",Ie,[_("div",Te,[a[21]||(a[21]=_("h2",null,"建筑管理系统",-1)),e(s,{type:"primary",onClick:te},{default:l(()=>[e(c,null,{default:l(()=>[e($(xe))]),_:1}),a[20]||(a[20]=n(" 添加建筑 "))]),_:1,__:[20]})]),_("div",Me,[e(_e,{gutter:20},{default:l(()=>[e(S,{span:6},{default:l(()=>[e(b,{modelValue:w.name,"onUpdate:modelValue":a[0]||(a[0]=t=>w.name=t),placeholder:"建筑名称",clearable:"",onClear:x,onKeyup:ke(x,["enter"])},{prefix:l(()=>[e(c,null,{default:l(()=>[e($(H))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(S,{span:6},{default:l(()=>[e(I,{modelValue:w.status,"onUpdate:modelValue":a[1]||(a[1]=t=>w.status=t),placeholder:"建筑状态",clearable:"",onChange:x},{default:l(()=>[e(p,{label:"正常",value:"normal"}),e(p,{label:"维护中",value:"maintenance"}),e(p,{label:"停用",value:"disabled"})]),_:1},8,["modelValue"])]),_:1}),e(S,{span:6},{default:l(()=>[e(I,{modelValue:w.type,"onUpdate:modelValue":a[2]||(a[2]=t=>w.type=t),placeholder:"建筑类型",clearable:"",onChange:x},{default:l(()=>[e(p,{label:"办公楼",value:"office"}),e(p,{label:"住宅楼",value:"residential"}),e(p,{label:"商业楼",value:"commercial"}),e(p,{label:"工业建筑",value:"industrial"})]),_:1},8,["modelValue"])]),_:1}),e(S,{span:6},{default:l(()=>[e(s,{type:"primary",onClick:x},{default:l(()=>[e(c,null,{default:l(()=>[e($(H))]),_:1}),a[22]||(a[22]=n(" 搜索 "))]),_:1,__:[22]}),e(s,{onClick:ue},{default:l(()=>a[23]||(a[23]=[n("重置")])),_:1,__:[23]})]),_:1})]),_:1})]),_("div",qe,[De((U(),Ue(W,{data:V.value,stripe:""},{default:l(()=>[e(m,{prop:"id",label:"ID",width:"80"}),e(m,{prop:"name",label:"建筑名称"}),e(m,{prop:"type",label:"建筑类型"},{default:l(t=>[e(T,{type:J(t.row.type)},{default:l(()=>[n(g(G(t.row.type)),1)]),_:2},1032,["type"])]),_:1}),e(m,{prop:"address",label:"地址"}),e(m,{prop:"floors",label:"楼层数",width:"100"}),e(m,{prop:"area",label:"建筑面积(m²)",width:"120"}),e(m,{prop:"status",label:"状态",width:"100"},{default:l(t=>[e(T,{type:A(t.row.status)},{default:l(()=>[n(g(R(t.row.status)),1)]),_:2},1032,["type"])]),_:1}),e(m,{prop:"buildDate",label:"建成日期",width:"120"}),e(m,{label:"操作",width:"200",fixed:"right"},{default:l(t=>[e(s,{size:"small",onClick:Z=>oe(t.row)},{default:l(()=>a[24]||(a[24]=[n("查看")])),_:2,__:[24]},1032,["onClick"]),e(s,{size:"small",type:"primary",onClick:Z=>de(t.row)},{default:l(()=>a[25]||(a[25]=[n("编辑")])),_:2,__:[25]},1032,["onClick"]),e(s,{size:"small",type:"danger",onClick:Z=>ne(t.row)},{default:l(()=>a[26]||(a[26]=[n("删除")])),_:2,__:[26]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[he,ee.value]]),_("div",Be,[e(ge,{"current-page":y.currentPage,"onUpdate:currentPage":a[3]||(a[3]=t=>y.currentPage=t),"page-size":y.pageSize,"onUpdate:pageSize":a[4]||(a[4]=t=>y.pageSize=t),"page-sizes":[10,20,50,100],total:y.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:re,onCurrentChange:se},null,8,["current-page","page-size","total"])])]),e(L,{modelValue:C.value,"onUpdate:modelValue":a[14]||(a[14]=t=>C.value=t),title:le.value,width:"600px",onClose:N},{footer:l(()=>[_("div",Oe,[e(s,{onClick:a[13]||(a[13]=t=>C.value=!1)},{default:l(()=>a[28]||(a[28]=[n("取消")])),_:1,__:[28]}),e(s,{type:"primary",onClick:ie,loading:B.value},{default:l(()=>a[29]||(a[29]=[n("确定")])),_:1,__:[29]},8,["loading"])])]),default:l(()=>[e(Y,{model:o,rules:ae,ref_key:"buildingFormRef",ref:k,"label-width":"100px"},{default:l(()=>[e(f,{label:"建筑名称",prop:"name"},{default:l(()=>[e(b,{modelValue:o.name,"onUpdate:modelValue":a[5]||(a[5]=t=>o.name=t),placeholder:"请输入建筑名称"},null,8,["modelValue"])]),_:1}),e(f,{label:"建筑类型",prop:"type"},{default:l(()=>[e(I,{modelValue:o.type,"onUpdate:modelValue":a[6]||(a[6]=t=>o.type=t),placeholder:"请选择建筑类型",style:{width:"100%"}},{default:l(()=>[e(p,{label:"办公楼",value:"office"}),e(p,{label:"住宅楼",value:"residential"}),e(p,{label:"商业楼",value:"commercial"}),e(p,{label:"工业建筑",value:"industrial"})]),_:1},8,["modelValue"])]),_:1}),e(f,{label:"地址",prop:"address"},{default:l(()=>[e(b,{modelValue:o.address,"onUpdate:modelValue":a[7]||(a[7]=t=>o.address=t),placeholder:"请输入建筑地址"},null,8,["modelValue"])]),_:1}),e(f,{label:"楼层数",prop:"floors"},{default:l(()=>[e(X,{modelValue:o.floors,"onUpdate:modelValue":a[8]||(a[8]=t=>o.floors=t),min:1,max:200,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),e(f,{label:"建筑面积",prop:"area"},{default:l(()=>[e(X,{modelValue:o.area,"onUpdate:modelValue":a[9]||(a[9]=t=>o.area=t),min:1,precision:2,style:{width:"100%"}},null,8,["modelValue"]),a[27]||(a[27]=_("span",{style:{"margin-left":"10px",color:"#666"}},"m²",-1))]),_:1,__:[27]}),e(f,{label:"建筑状态",prop:"status"},{default:l(()=>[e(I,{modelValue:o.status,"onUpdate:modelValue":a[10]||(a[10]=t=>o.status=t),placeholder:"请选择建筑状态",style:{width:"100%"}},{default:l(()=>[e(p,{label:"正常",value:"normal"}),e(p,{label:"维护中",value:"maintenance"}),e(p,{label:"停用",value:"disabled"})]),_:1},8,["modelValue"])]),_:1}),e(f,{label:"建成日期",prop:"buildDate"},{default:l(()=>[e(be,{modelValue:o.buildDate,"onUpdate:modelValue":a[11]||(a[11]=t=>o.buildDate=t),type:"date",placeholder:"选择建成日期",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),e(f,{label:"描述",prop:"description"},{default:l(()=>[e(b,{modelValue:o.description,"onUpdate:modelValue":a[12]||(a[12]=t=>o.description=t),type:"textarea",rows:3,placeholder:"请输入建筑描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),e(L,{modelValue:z.value,"onUpdate:modelValue":a[16]||(a[16]=t=>z.value=t),title:"建筑详情",width:"800px"},{footer:l(()=>[_("div",Le,[e(s,{onClick:a[15]||(a[15]=t=>z.value=!1)},{default:l(()=>a[30]||(a[30]=[n("关闭")])),_:1,__:[30]}),e(s,{type:"primary",onClick:pe},{default:l(()=>a[31]||(a[31]=[n("路径规划")])),_:1,__:[31]})])]),default:l(()=>[r.value?(U(),q("div",Pe,[e(ve,{column:2,border:""},{default:l(()=>[e(h,{label:"建筑名称"},{default:l(()=>[n(g(r.value.name),1)]),_:1}),e(h,{label:"建筑类型"},{default:l(()=>[e(T,{type:J(r.value.type)},{default:l(()=>[n(g(G(r.value.type)),1)]),_:1},8,["type"])]),_:1}),e(h,{label:"地址"},{default:l(()=>[n(g(r.value.address),1)]),_:1}),e(h,{label:"楼层数"},{default:l(()=>[n(g(r.value.floors)+"层",1)]),_:1}),e(h,{label:"建筑面积"},{default:l(()=>[n(g(r.value.area)+" m²",1)]),_:1}),e(h,{label:"建筑状态"},{default:l(()=>[e(T,{type:A(r.value.status)},{default:l(()=>[n(g(R(r.value.status)),1)]),_:1},8,["type"])]),_:1}),e(h,{label:"建成日期"},{default:l(()=>[n(g(r.value.buildDate),1)]),_:1}),e(h,{label:"创建时间"},{default:l(()=>[n(g(r.value.createTime),1)]),_:1}),e(h,{label:"描述",span:2},{default:l(()=>[n(g(r.value.description||"暂无描述"),1)]),_:1})]),_:1})])):j("",!0)]),_:1},8,["modelValue"]),e(L,{modelValue:O.value,"onUpdate:modelValue":a[19]||(a[19]=t=>O.value=t),title:"路径规划",width:"800px"},{default:l(()=>[_("div",null,[e(Y,{model:i,"label-width":"80px",inline:""},{default:l(()=>[e(f,{label:"起点"},{default:l(()=>[e(b,{modelValue:i.start,"onUpdate:modelValue":a[17]||(a[17]=t=>i.start=t),placeholder:"请输入起点",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),e(f,{label:"终点"},{default:l(()=>[e(b,{modelValue:i.end,"onUpdate:modelValue":a[18]||(a[18]=t=>i.end=t),placeholder:"请输入终点",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),e(f,null,{default:l(()=>[e(s,{type:"primary",onClick:E},{default:l(()=>a[32]||(a[32]=[n("规划路径")])),_:1,__:[32]})]),_:1})]),_:1},8,["model"]),a[35]||(a[35]=_("div",{id:"baiduMapContainer",style:{width:"100%",height:"400px","margin-top":"16px"}},null,-1)),D.value?(U(),q("div",Ze,[e(ye,{title:D.value,type:"success","show-icon":""},null,8,["title"])])):j("",!0),P.value.length?(U(),q("div",$e,[a[34]||(a[34]=_("h4",null,"历史路径规划",-1)),e(W,{data:P.value,size:"small",style:{width:"100%"}},{default:l(()=>[e(m,{prop:"start",label:"起点"}),e(m,{prop:"end",label:"终点"}),e(m,{prop:"time",label:"时间",width:"180"}),e(m,{label:"操作",width:"80"},{default:l(t=>[e(s,{size:"small",onClick:Z=>ce(t.row)},{default:l(()=>a[33]||(a[33]=[n("回显")])),_:2,__:[33]},1032,["onClick"])]),_:1})]),_:1},8,["data"])])):j("",!0)])]),_:1},8,["modelValue"])])}}},Re=Se(je,[["__scopeId","data-v-aa77908f"]]);export{Re as default};
