import{ref as e,onMounted as l,resolveComponent as a,openBlock as t,createElementBlock as u,createVNode as r,withCtx as i,createElementVNode as d,createTextVNode as s,toDisplayString as o,createBlock as n,createCommentVNode as p}from"vue";import{ElMessage as c,ElMessageBox as m}from"element-plus";import{_ as v}from"./_plugin-vue_export-helper-BCo6x5W8.js";const _={class:"notification-container"},f={class:"header"},y={class:"header-actions"},b=["onClick"],g={key:0,class:"notification-detail"},h={class:"card-header"},w={class:"detail-item"},k={class:"detail-item"},C={class:"detail-item"},V={class:"detail-item"},T={class:"detail-item"},x={class:"detail-item"},U={class:"detail-item"},q={class:"content-text"},z={class:"card-header"},A={class:"header-actions"},D={class:"dialog-footer"},P={key:0,class:"read-status-detail"},B={class:"status-summary"},R={class:"status-card"},j={class:"status-number"},F={class:"status-card"},I={class:"status-number"},M={class:"status-card"},$={class:"status-number"},E=v({__name:"notification",setup(v){const E=e([]),G=e(!1),H=e(null),J=e(!1),K=e("发布通知"),L=e(null),N=e(!1),O=e(null),Q=e([]),S=[{id:"notif001",title:"关于公司年度会议的通知",category:"公司公告",priority:"高",status:"已发布",publisher:"张经理",publishTime:"2024-01-15 09:00:00",readCount:45,content:"各位同事，公司将于本周五下午2点在大会议室召开年度总结会议，请各部门负责人准时参加。会议将讨论公司年度业绩、来年规划等重要事项。"},{id:"notif002",title:"系统维护通知",category:"系统通知",priority:"中",status:"已发布",publisher:"技术部",publishTime:"2024-01-14 18:00:00",readCount:38,content:"为了提升系统性能，我们将在今晚22:00-24:00进行系统维护，期间可能影响部分功能的使用，请提前做好准备。"},{id:"notif003",title:"员工福利活动通知",category:"活动通知",priority:"低",status:"草稿",publisher:"人事部",publishTime:"2024-01-13 10:30:00",readCount:0,content:"为增进员工之间的交流，公司将于下周三组织团建活动，活动地点和时间另行通知，请大家踊跃报名参加。"}],W=e([{id:"rs001",realname:"张三",department:"技术部",status:"已读",readTime:"2025-01-15 09:15:00",ipAddress:"192.168.1.100"},{id:"rs002",realname:"李四",department:"人事部",status:"已读",readTime:"2025-01-15 09:20:00",ipAddress:"192.168.1.101"},{id:"rs003",realname:"王五",department:"财务部",status:"已读",readTime:"2025-01-15 09:20:00",ipAddress:"192.168.1.101"}]),X=e({title:"",category:"",priority:"中",targetDepartments:[],content:"",urgent:!1,requireConfirm:!1}),Y={title:[{required:!0,message:"请输入通知标题",trigger:"blur"}],category:[{required:!0,message:"请选择通知类别",trigger:"change"}],priority:[{required:!0,message:"请选择优先级",trigger:"change"}],targetDepartments:[{required:!0,message:"请选择接收部门",trigger:"change"}],content:[{required:!0,message:"请输入通知内容",trigger:"blur"}]},Z=async()=>{try{await new Promise((e=>setTimeout(e,500))),E.value=S,c.success("通知列表加载成功")}catch(e){c.error("获取通知列表失败")}},ee=()=>{Z()},le=()=>{K.value="发布通知",X.value={title:"",category:"",priority:"中",targetDepartments:[],content:"",urgent:!1,requireConfirm:!1},Q.value=[],J.value=!0},ae=e=>{K.value="编辑通知",X.value={...e},J.value=!0},te=async()=>{try{await L.value.validate(),await new Promise((e=>setTimeout(e,1e3))),c.success("发布通知"===K.value?"通知发布成功":"通知更新成功"),J.value=!1,Z()}catch(e){c.error("表单验证失败")}},ue=async()=>{try{await L.value.validate(),await new Promise((e=>setTimeout(e,500))),c.success("草稿保存成功"),J.value=!1,Z()}catch(e){c.error("表单验证失败")}},re=e=>{W.value=[{id:"rs001",realname:"张三",department:"技术部",status:"已读",readTime:"2025-01-15 09:15:00",ipAddress:"192.168.1.100"},{id:"rs002",realname:"李四",department:"人事部",status:"已读",readTime:"2025-01-15 09:20:00",ipAddress:"192.168.1.101"},{id:"rs003",realname:"王五",department:"财务部",status:"已读",readTime:"2025-01-15 09:20:00",ipAddress:"192.168.1.101"}]},ie=()=>{H.value&&(re(H.value.id),c.success("已读状态已刷新"))},de=(e,l)=>{},se=()=>{G.value=!1,H.value=null,W.value=[]},oe=()=>{var e;J.value=!1,null==(e=L.value)||e.resetFields(),Q.value=[]},ne=()=>{N.value=!1,O.value=null};return l(Z),(e,l)=>{const v=a("el-button"),S=a("el-table-column"),Z=a("el-tag"),pe=a("el-table"),ce=a("el-card"),me=a("el-col"),ve=a("el-row"),_e=a("el-dialog"),fe=a("el-input"),ye=a("el-form-item"),be=a("el-option"),ge=a("el-select"),he=a("el-radio"),we=a("el-radio-group"),ke=a("el-upload"),Ce=a("el-checkbox"),Ve=a("el-form"),Te=a("el-descriptions-item"),xe=a("el-descriptions");return t(),u("div",_,[r(ce,null,{default:i((()=>[d("div",f,[l[14]||(l[14]=d("span",null,"通知管理",-1)),d("div",y,[r(v,{type:"primary",onClick:le,size:"small"},{default:i((()=>l[12]||(l[12]=[s("发布通知")]))),_:1,__:[12]}),r(v,{type:"success",onClick:ee,size:"small"},{default:i((()=>l[13]||(l[13]=[s("刷新")]))),_:1,__:[13]})])]),r(pe,{data:E.value,style:{width:"100%","margin-top":"20px"},fit:"true"},{default:i((()=>[r(S,{prop:"title",label:"通知标题","min-width":"200"},{default:i((e=>[d("span",{class:"clickable-title",onClick:l=>{return a=e.row,H.value=a,G.value=!0,void re(a.id);var a}},o(e.row.title),9,b)])),_:1}),r(S,{prop:"category",label:"通知类别","min-width":"120"}),r(S,{prop:"priority",label:"优先级","min-width":"100"},{default:i((e=>["高"===e.row.priority?(t(),n(Z,{key:0,type:"danger"},{default:i((()=>[s(o(e.row.priority),1)])),_:2},1024)):"中"===e.row.priority?(t(),n(Z,{key:1,type:"warning"},{default:i((()=>[s(o(e.row.priority),1)])),_:2},1024)):(t(),n(Z,{key:2,type:"info"},{default:i((()=>[s(o(e.row.priority),1)])),_:2},1024))])),_:1}),r(S,{prop:"status",label:"状态","min-width":"100"},{default:i((e=>["已发布"===e.row.status?(t(),n(Z,{key:0,type:"success"},{default:i((()=>[s(o(e.row.status),1)])),_:2},1024)):"草稿"===e.row.status?(t(),n(Z,{key:1,type:"info"},{default:i((()=>[s(o(e.row.status),1)])),_:2},1024)):(t(),n(Z,{key:2,type:"warning"},{default:i((()=>[s(o(e.row.status),1)])),_:2},1024))])),_:1}),r(S,{prop:"publisher",label:"发布人","min-width":"120"}),r(S,{prop:"publishTime",label:"发布时间","min-width":"150"}),r(S,{prop:"readCount",label:"已读人数","min-width":"100"}),r(S,{label:"操作","min-width":"200",fixed:"right"},{default:i((e=>[r(v,{size:"small",type:"primary",onClick:l=>ae(e.row)},{default:i((()=>l[15]||(l[15]=[s("编辑")]))),_:2,__:[15]},1032,["onClick"]),r(v,{size:"small",type:"success",onClick:l=>{return a=e.row,O.value={...a,totalCount:50,unreadCount:50-a.readCount,readRate:Math.round(a.readCount/50*100)},void(N.value=!0);var a}},{default:i((()=>l[16]||(l[16]=[s("查看已读")]))),_:2,__:[16]},1032,["onClick"]),r(v,{size:"small",type:"danger",onClick:l=>(async e=>{try{await m.confirm(`确定要删除通知"${e.title}"吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),E.value=E.value.filter((l=>l.id!==e.id)),c.success("删除成功")}catch{c.info("已取消删除")}})(e.row)},{default:i((()=>l[17]||(l[17]=[s("删除")]))),_:2,__:[17]},1032,["onClick"])])),_:1})])),_:1},8,["data"])])),_:1}),r(_e,{modelValue:G.value,"onUpdate:modelValue":l[1]||(l[1]=e=>G.value=e),title:"通知详情",width:"900px","before-close":se},{default:i((()=>[H.value?(t(),u("div",g,[r(ce,{class:"info-card",shadow:"never"},{header:i((()=>[d("div",h,[l[19]||(l[19]=d("span",null,"通知信息",-1)),r(v,{type:"primary",size:"small",onClick:l[0]||(l[0]=e=>ae(H.value))},{default:i((()=>l[18]||(l[18]=[s("编辑通知")]))),_:1,__:[18]})])])),default:i((()=>[r(ve,{gutter:20},{default:i((()=>[r(me,{span:12},{default:i((()=>[d("div",w,[l[20]||(l[20]=d("label",null,"通知标题：",-1)),d("span",null,o(H.value.title),1)])])),_:1}),r(me,{span:12},{default:i((()=>[d("div",k,[l[21]||(l[21]=d("label",null,"通知类别：",-1)),d("span",null,o(H.value.category),1)])])),_:1})])),_:1}),r(ve,{gutter:20},{default:i((()=>[r(me,{span:12},{default:i((()=>[d("div",C,[l[22]||(l[22]=d("label",null,"优先级：",-1)),"高"===H.value.priority?(t(),n(Z,{key:0,type:"danger"},{default:i((()=>[s(o(H.value.priority),1)])),_:1})):"中"===H.value.priority?(t(),n(Z,{key:1,type:"warning"},{default:i((()=>[s(o(H.value.priority),1)])),_:1})):(t(),n(Z,{key:2,type:"info"},{default:i((()=>[s(o(H.value.priority),1)])),_:1}))])])),_:1}),r(me,{span:12},{default:i((()=>[d("div",V,[l[23]||(l[23]=d("label",null,"状态：",-1)),"已发布"===H.value.status?(t(),n(Z,{key:0,type:"success"},{default:i((()=>[s(o(H.value.status),1)])),_:1})):"草稿"===H.value.status?(t(),n(Z,{key:1,type:"info"},{default:i((()=>[s(o(H.value.status),1)])),_:1})):(t(),n(Z,{key:2,type:"warning"},{default:i((()=>[s(o(H.value.status),1)])),_:1}))])])),_:1})])),_:1}),r(ve,{gutter:20},{default:i((()=>[r(me,{span:12},{default:i((()=>[d("div",T,[l[24]||(l[24]=d("label",null,"发布人：",-1)),d("span",null,o(H.value.publisher),1)])])),_:1}),r(me,{span:12},{default:i((()=>[d("div",x,[l[25]||(l[25]=d("label",null,"发布时间：",-1)),d("span",null,o(H.value.publishTime),1)])])),_:1})])),_:1}),r(ve,{gutter:20},{default:i((()=>[r(me,{span:24},{default:i((()=>[d("div",U,[l[26]||(l[26]=d("label",null,"通知内容：",-1)),d("div",q,o(H.value.content),1)])])),_:1})])),_:1})])),_:1}),r(ce,{class:"read-status-card",shadow:"never"},{header:i((()=>[d("div",z,[l[28]||(l[28]=d("span",null,"已读状态",-1)),d("div",A,[r(v,{type:"primary",size:"small",onClick:ie},{default:i((()=>l[27]||(l[27]=[s("刷新")]))),_:1,__:[27]})])])])),default:i((()=>[r(pe,{data:W.value,style:{width:"100%"},stripe:""},{default:i((()=>[r(S,{prop:"realname",label:"姓名",width:"120"}),r(S,{prop:"department",label:"部门",width:"120"}),r(S,{prop:"status",label:"状态",width:"100"},{default:i((e=>["已读"===e.row.status?(t(),n(Z,{key:0,type:"success"},{default:i((()=>[s(o(e.row.status),1)])),_:2},1024)):(t(),n(Z,{key:1,type:"warning"},{default:i((()=>[s(o(e.row.status),1)])),_:2},1024))])),_:1}),r(S,{prop:"readTime",label:"阅读时间","min-width":"150"}),r(S,{prop:"ipAddress",label:"IP地址",width:"120"})])),_:1},8,["data"])])),_:1})])):p("",!0)])),_:1},8,["modelValue"]),r(_e,{modelValue:J.value,"onUpdate:modelValue":l[10]||(l[10]=e=>J.value=e),title:K.value,width:"800px","before-close":oe},{footer:i((()=>[d("div",D,[r(v,{onClick:ue},{default:i((()=>l[36]||(l[36]=[s("保存草稿")]))),_:1,__:[36]}),r(v,{onClick:l[9]||(l[9]=e=>J.value=!1)},{default:i((()=>l[37]||(l[37]=[s("取消")]))),_:1,__:[37]}),r(v,{type:"primary",onClick:te},{default:i((()=>l[38]||(l[38]=[s("发布通知")]))),_:1,__:[38]})])])),default:i((()=>[r(Ve,{model:X.value,rules:Y,ref_key:"notificationFormRef",ref:L,"label-width":"120px"},{default:i((()=>[r(ye,{label:"通知标题",prop:"title"},{default:i((()=>[r(fe,{modelValue:X.value.title,"onUpdate:modelValue":l[2]||(l[2]=e=>X.value.title=e),placeholder:"请输入通知标题"},null,8,["modelValue"])])),_:1}),r(ye,{label:"通知类别",prop:"category"},{default:i((()=>[r(ge,{modelValue:X.value.category,"onUpdate:modelValue":l[3]||(l[3]=e=>X.value.category=e),placeholder:"请选择通知类别",style:{width:"100%"}},{default:i((()=>[r(be,{label:"公司公告",value:"公司公告"}),r(be,{label:"部门通知",value:"部门通知"}),r(be,{label:"系统通知",value:"系统通知"}),r(be,{label:"活动通知",value:"活动通知"}),r(be,{label:"其他",value:"其他"})])),_:1},8,["modelValue"])])),_:1}),r(ye,{label:"优先级",prop:"priority"},{default:i((()=>[r(we,{modelValue:X.value.priority,"onUpdate:modelValue":l[4]||(l[4]=e=>X.value.priority=e)},{default:i((()=>[r(he,{label:"低"},{default:i((()=>l[29]||(l[29]=[s("低")]))),_:1,__:[29]}),r(he,{label:"中"},{default:i((()=>l[30]||(l[30]=[s("中")]))),_:1,__:[30]}),r(he,{label:"高"},{default:i((()=>l[31]||(l[31]=[s("高")]))),_:1,__:[31]})])),_:1},8,["modelValue"])])),_:1}),r(ye,{label:"接收部门",prop:"targetDepartments"},{default:i((()=>[r(ge,{modelValue:X.value.targetDepartments,"onUpdate:modelValue":l[5]||(l[5]=e=>X.value.targetDepartments=e),multiple:"",placeholder:"请选择接收部门",style:{width:"100%"}},{default:i((()=>[r(be,{label:"技术部",value:"技术部"}),r(be,{label:"人事部",value:"人事部"}),r(be,{label:"财务部",value:"财务部"}),r(be,{label:"市场部",value:"市场部"}),r(be,{label:"行政部",value:"行政部"})])),_:1},8,["modelValue"])])),_:1}),r(ye,{label:"通知内容",prop:"content"},{default:i((()=>[r(fe,{modelValue:X.value.content,"onUpdate:modelValue":l[6]||(l[6]=e=>X.value.content=e),type:"textarea",rows:6,placeholder:"请输入通知内容"},null,8,["modelValue"])])),_:1}),r(ye,{label:"附件"},{default:i((()=>[r(ke,{class:"upload-demo",action:"#","auto-upload":!1,"on-change":de,"file-list":Q.value,multiple:""},{tip:i((()=>l[33]||(l[33]=[d("div",{class:"el-upload__tip"}," 支持jpg/png/pdf/doc/docx文件，且不超过10MB ",-1)]))),default:i((()=>[r(v,{type:"primary"},{default:i((()=>l[32]||(l[32]=[s("选择文件")]))),_:1,__:[32]})])),_:1},8,["file-list"])])),_:1}),r(ye,{label:"发布设置"},{default:i((()=>[r(Ce,{modelValue:X.value.urgent,"onUpdate:modelValue":l[7]||(l[7]=e=>X.value.urgent=e)},{default:i((()=>l[34]||(l[34]=[s("紧急通知")]))),_:1,__:[34]},8,["modelValue"]),r(Ce,{modelValue:X.value.requireConfirm,"onUpdate:modelValue":l[8]||(l[8]=e=>X.value.requireConfirm=e)},{default:i((()=>l[35]||(l[35]=[s("需要确认")]))),_:1,__:[35]},8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","title"]),r(_e,{modelValue:N.value,"onUpdate:modelValue":l[11]||(l[11]=e=>N.value=e),title:"已读状态详情",width:"800px","before-close":ne},{default:i((()=>[O.value?(t(),u("div",P,[r(xe,{column:2,border:""},{default:i((()=>[r(Te,{label:"通知标题"},{default:i((()=>[s(o(O.value.title),1)])),_:1}),r(Te,{label:"发布人"},{default:i((()=>[s(o(O.value.publisher),1)])),_:1}),r(Te,{label:"发布时间"},{default:i((()=>[s(o(O.value.publishTime),1)])),_:1}),r(Te,{label:"总人数"},{default:i((()=>[s(o(O.value.totalCount),1)])),_:1}),r(Te,{label:"已读人数"},{default:i((()=>[s(o(O.value.readCount),1)])),_:1}),r(Te,{label:"未读人数"},{default:i((()=>[s(o(O.value.unreadCount),1)])),_:1})])),_:1}),d("div",B,[r(ve,{gutter:20},{default:i((()=>[r(me,{span:8},{default:i((()=>[d("div",R,[d("div",j,o(O.value.readCount),1),l[39]||(l[39]=d("div",{class:"status-label"},"已读",-1))])])),_:1}),r(me,{span:8},{default:i((()=>[d("div",F,[d("div",I,o(O.value.unreadCount),1),l[40]||(l[40]=d("div",{class:"status-label"},"未读",-1))])])),_:1}),r(me,{span:8},{default:i((()=>[d("div",M,[d("div",$,o(O.value.readRate)+"%",1),l[41]||(l[41]=d("div",{class:"status-label"},"已读率",-1))])])),_:1})])),_:1})])])):p("",!0)])),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-c2935bb3"]]);export{E as default};
